!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([/*!********************************!*\
  !*** ./src/virtualkeyboard.js ***!
  \********************************/
function(e,t,n){"use strict";var r=n(/*! ./extensions/helpers */1);n(/*! ./extensions/ext/array */2),n(/*! ./extensions/ext/object */3),n(/*! ./extensions/ext/regexp */4),n(/*! ./extensions/ext/string */5);var o=n(/*! ./extensions/documentselection */6),a=n(/*! ./extensions/dom */7),i=n(/*! ./extensions/eventmanager */8),s=n(/*! ./ime */9),c=new function(){var e=this;e.$VERSION$="3.6.1.585";var t,n={layout:null,showKeyboardMaps:!0,showKeyboardLayouts:!0},s="kb_b",c=!0,l={14:"backspace",15:"tab",28:"enter",29:"caps",41:"shift_left",52:"shift_right",53:"del",54:"ctrl_left",55:"alt_left",56:"space",57:"alt_right",58:"ctrl_right"},d={SHIFT:"shift",ALT:"alt",CTRL:"ctrl",CAPS:"caps"},u={"QWERTY Standard":"À1234567890m=ÜQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾¿","QWERTY Canadian":"Þ1234567890m=ÜQWERTYUIOPÛÝASDFGHJKL;ÀZXCVBNM¼¾¿","QWERTY Dutch":"Þ1234567890Û¿ÜQWERTYUIOPÝ;ASDFGHJKL=ÀZXCVBNM¼¾m","QWERTY Estonian":"¿1234567890m=ÜQWERTYUIOPÞÛASDFGHJKL;ÀZXCVBNM¼¾Ý","QWERTY Greek (220)":"À1234567890¿ÛÜQWERTYUIOP=ÝASDFGHJKL;ÞZXCVBNM¼¾m","QWERTY Greek (319)":"À1234567890¿=ÜQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾m","QWERTY Gujarati":"À1234567890m=XQWERTYUIOPÛÝASDFGHJKL;ÜZXCVBNM¼¾¿","QWERTY Italian":"Ü1234567890ÛÝ¿QWERTYUIOP;=ASDFGHJKLÀÞZXCVBNM¼¾m","QWERTY Kannada":"À1234567890m=ZQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾¿","QWERTY Portuguese":"À1234567890ÛÝ¿QWERTYUIOP=;ASDFGHJKLÞÜZXCVBNM¼¾m","QWERTY Scandinavian":"Ü1234567890=Û¿QWERTYUIOPÝ;ASDFGHJKLÀÞZXCVBNM¼¾m","QWERTY Spanish":"Ü1234567890mÛ¿QWERTYUIOPÝ;ASDFGHJKLÀÞZXCVBNM¼¾ß","QWERTY Tamil":"À1234567890m =ZQWERTYUIOPÛÝASDFGHJKL;ÞCVBNM¼¾ ¿","QWERTY Turkish":"À1234567890ßm¼QWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¿Ü¾","QWERTY UK":"ß1234567890m=ÞQWERTYUIOPÛÝASDFGHJKL;ÀZXCVBNM¼¾¿","QWERTZ Albanian":"À1234567890m=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾¿","QWERTZ Bosnian":"À1234567890¿=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m","QWERTZ Czech":"À1234567890=¿ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m","QWERTZ German":"Ü1234567890ÛÝ¿QWERTZUIOP;=ASDFGHJKLÀÞYXCVBNM¼¾m","QWERTZ Hungarian":"0123456789À¿=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m","QWERTZ Slovak":"À1234567890¿ßÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m","QWERTZ Swiss":"Ü1234567890ÛÝßQWERTZUIOP;ÞASDFGHJKLÀ¿YXCVBNM¼¾m","AZERTY Belgian":"Þ1234567890ÛmÜAZERTYUIOPÝ;QSDFGHJKLMÀWXCVBN¼¾¿=","AZERTY French":"Þ1234567890Û=ÜAZERTYUIOPÝ;QSDFGHJKLMÀWXCVBN¼¾¿ß",",WERTY Bulgarian":"À1234567890m¾Ü¼WERTYUIOPÛÝASDFGHJKL;ÞZXCVBNMßQ¿","QGJRMV Latvian":"À1234567890mFÜQGJRMVNZWXYH;USILDATECÞÛBÝKPOß¼¾¿","/,.PYF UK-Dvorak":"m1234567890ÛÝÜÀ¼¾PYFGCRL¿=AOEUIDHTNSÞ;QJKXBMWVZ","FG;IOD Turkish F":"À1234567890=mXFG;IODRNHPQWUÛEAÝTKMLYÞJÜVC¿ZSB¾¼",";QBYUR US-Dvorak":"7ÛÝ¿PFMLJ4321Ü;QBYURSO¾65=mKCDTHEAZ8ÞÀXGVWNI¼09","56Q.OR US-Dvorak":"m1234JLMFP¿ÛÝÜ56Q¾ORSUYB;=78ZAEHTDCKÞ90X¼INWVGÀ"},f=0,h=0,p=1,g=2,m=4,v=8,y=m|v,E=m|p,C=g|v,w=g|m,b=g|m|v,S=g|p,L=p|g|m,M=p|v,T=p|g|m|v,O={buttonUp:"kbButton",buttonDown:"kbButtonDown",buttonHover:"kbButtonHover",hoverShift:"hoverShift",hoverAlt:"hoverAlt",modeAlt:"modeAlt",modeAltCaps:"modeAltCaps",modeCaps:"modeCaps",modeNormal:"modeNormal",modeShift:"modeShift",modeShiftAlt:"modeShiftAlt",modeShiftAltCaps:"modeShiftAltCaps",modeShiftCaps:"modeShiftCaps",charNormal:"charNormal",charShift:"charShift",charAlt:"charAlt",charShiftAlt:"charShiftAlt",charCaps:"charCaps",charShiftCaps:"charShiftCaps",hiddenAlt:"hiddenAlt",hiddenCaps:"hiddenCaps",hiddenShift:"hiddenShift",hiddenShiftCaps:"hiddenShiftCaps",deadkey:"deadKey",noanim:"VK_no_animate"},N=null,A=[];A.hash={},A.codes={},A.codeFilter=null,A.options=null;var R={keyboard:null,desk:null,langbox:null,attachedInput:null},k=null;e.addLayoutList=function(){for(var t=0,n=arguments.length;t<n;t++)e.addLayout(arguments[t])},e.addLayout=function(e){var t=e.code.entityDecode().split("-"),n=e.name.entityDecode(),o=B(e.normal);if(!(0,r.isArray)(o)||47!=o.length)throw new Error("VirtualKeyboard requires 'keys' property to be an array with 47 items, "+o.length+" detected. Layout code: "+t+", layout name: "+n);e.code=t[1]||t[0],e.name=n,e.normal=o,e.domain=t[0],A.hash.hasOwnProperty(e.code+" "+e.name)||(A.codes.hasOwnProperty(e.code)||(A.codes[e.code]=e.code),e.toString=function(){return this.code+" "+this.name},A.push(e),A.options=null)},e.switchLayout=function(t){return U(),!!A.options.hasOwnProperty(t)&&(e.IME.hide(),R.langbox.options[A.options[t]].selected=!0,N=A[A.hash[t]],(0,r.isArray)(N)||(N=A[A.hash[t]]=F(N)),(0,r.isArray)(N)||(N=A[A.hash[t]]=F(N)),N.html||(N.html=X(N)),R.desk.innerHTML=N.html,R.keyboard.className=N.domain,e.IME.css=N.domain,f=h,Q(),(0,r.isFunction)(N.activate)&&N.activate(),K(),!0)},e.getLayouts=function(){for(var e=[],t=0,n=A.length;t<n;t++)e[e.length]=[A[t].code,A[t].name];return e.sort()},e.setVisibleLayoutCodes=function(){for(var t,n=(0,r.isArray)(arguments[0])?arguments[0]:arguments,o=null,a=0,i=n.length;a<i;a++)t=n[a].toUpperCase(),A.codes.hasOwnProperty(t)&&(o||(o={}),o[t]=t);A.codeFilter=o,A.options=null,e.switchLayout(R.langbox.value)||e.switchLayout(R.langbox.value)},e.getLayoutCodes=function(){var e=[];for(var t in A.codes)A.codes.hasOwnProperty(t)&&e.push(t);return e.heapSort()};var x=function(t,n){var a="",i=!1;switch(t=t.replace(s,"")){case d.CAPS:case d.SHIFT:case"shift_left":case"shift_right":case d.ALT:case"alt_left":case"alt_right":return!0;case"backspace":if((0,r.isFunction)(N.charProcessor)&&o.DocumentSelection.getSelection(R.attachedInput).length)a="\b";else{if(n)return e.IME.hide(!0),!0;o.DocumentSelection.deleteAtCursor(R.attachedInput,!1),e.IME.hide(!0)}break;case"del":if(e.IME.hide(!0),n)return!0;o.DocumentSelection.deleteAtCursor(R.attachedInput,!0);break;case"space":a=" ";break;case"tab":a="\t";break;case"enter":a="\n";break;default:document.getElementById(s+t);a=N[t][f]}if(a){if(!(a=Z(a,o.DocumentSelection.getSelection(R.attachedInput))))return i;try{if(a[1]||a[0].length>1||a.charCodeAt(0)>32767||R.attachedInput.contentDocument||"\t"==a[0])throw new Error;var c=a[0].charCodeAt(0);if((0,r.isFunction)(document.createEvent)){var n=null;try{n=document.createEvent("KeyEvents"),n.initKeyEvent("keypress",!1,!0,R.attachedInput.contentWindow,!1,!1,!1,!1,0,c)}catch(e){n=document.createEvent("KeyboardEvents"),n.initKeyEvent("keypress",!1,!0,R.attachedInput.contentWindow,!1,!1,!1,!1,c,0)}n.VK_bypass=!0,R.attachedInput.dispatchEvent(n)}else n.keyCode=10==c?13:c,i=!0}catch(e){o.DocumentSelection.insertAtCursor(R.attachedInput,a[0]),a[1]&&o.DocumentSelection.setRange(R.attachedInput,-a[1],0,!0)}}return i},I=function(n){if(e.isOpen()){var r=f,i=n.getKeyCode();switch(n.type){case"keydown":switch(i){case 37:if(e.IME.isOpen())return void e.IME.prevPage(n);break;case 39:if(e.IME.isOpen())return void e.IME.nextPage(n);break;case 8:case 9:case 46:var s=R.desk.childNodes[t[i]];c&&!n.getRepeat()&&a.DOM.CSS(s).addClass(O.buttonDown),x(s.id,n)||n.preventDefault();break;case 20:n.getRepeat()||(r^=v);break;case 27:if(e.IME.isOpen())e.IME.hide();else{var l=o.DocumentSelection.getStart(R.attachedInput);o.DocumentSelection.setRange(R.attachedInput,l,l)}return!1;default:if(n.getRepeat()||(r=r|n.shiftKey|n.ctrlKey<<2|n.altKey<<1),t.hasOwnProperty(i)){if(!(n.altKey^n.ctrlKey)){var s=R.desk.childNodes[t[i]];c&&a.DOM.CSS(s).addClass(O.buttonDown),k=s.id}n.altKey&&n.ctrlKey&&(n.preventDefault(),n.srcElement&&(x(R.desk.childNodes[t[i]].id,n),k=""))}else e.IME.hide()}break;case"keyup":switch(i){case 20:break;default:n.getRepeat()||(r=f&(T^(!n.shiftKey|!n.ctrlKey<<2|!n.altKey<<1))),c&&t.hasOwnProperty(i)&&a.DOM.CSS(R.desk.childNodes[t[i]]).removeClass(O.buttonDown)}break;case"keypress":k&&!n.VK_bypass&&(x(k,n)||(n.stopPropagation(),n.preventDefault()),k=null),!f^w&&(n.altKey||n.ctrlKey)&&e.IME.hide(),0!=i||k||n.VK_bypass||n.ctrlKey||n.altKey||n.shiftKey||n.preventDefault()}r!=f&&(V(r),Q())}},P=function(e){var t=a.DOM.getParent(e.srcElement||e.target,"a");if(t&&!(t.parentNode.id.indexOf(s)<0)){switch(t=t.parentNode,t.id.substring(s.length)){case"caps":case"shift_left":case"shift_right":case"alt_left":case"alt_right":case"ctrl_left":case"ctrl_right":return}!a.DOM.CSS(t).hasClass(O.buttonDown)&&c||x(t.id),c&&a.DOM.CSS(t).removeClass(O.buttonDown);var n=f&(v|e.shiftKey|e.altKey<<1|e.ctrlKey<<2);f!=n&&(V(n),Q())}},D=function(e){var t=a.DOM.getParent(e.srcElement||e.target,"a");if(t&&!(t.parentNode.id.indexOf(s)<0)){t=t.parentNode;var n=f,r=t.id.substring(s.length);switch(r){case"caps":n^=v;break;case"shift_left":case"shift_right":if(e.shiftKey)break;n^=p;break;case"alt_left":case"alt_right":case"ctrl_left":case"ctrl_right":n=n^(e.altKey<<1^g)^(e.ctrlKey<<2^m);break;default:c&&a.DOM.CSS(t).addClass(O.buttonDown)}f!=n&&(V(n),Q()),e.preventDefault(),e.stopPropagation()}},H=function(e){var t=a.DOM.getParent(e.srcElement||e.target,"a"),n={mouseover:2,mouseout:3};!t||t.parentNode.id.indexOf(s)<0||(t=t.parentNode,t.id.indexOf("shift")>-1?_(n[e.type],d.SHIFT):t.id.indexOf("alt")>-1||t.id.indexOf("ctrl")>-1?(_(n[e.type],d.CTRL),_(n[e.type],d.ALT)):t.id.indexOf("caps")>-1?Y(n[e.type],null,t.id):c&&(Y(n[e.type],null,t.id),"mouseout"==e.type.toLowerCase()&&Y(0,null,t.id)),e.preventDefault(),e.stopPropagation())},W=function(e){t=u[e.target.value]};e.attachInput=function(t){if(!t)return R.attachedInput;if((0,r.isString)(t)&&(t=document.getElementById(t)),t==R.attachedInput)return R.attachedInput;if(!e.switchLayout(n.layout)&&!e.switchLayout(R.langbox.value))throw new Error("No layouts available");return e.detachInput(),t&&t.tagName?(c=!a.DOM.CSS(t).hasClass(O.noanim),R.attachedInput=t,K(),t.contentWindow&&(t=t.contentWindow.document.body.parentNode),i.EM.addEventListener(t,"keydown",I),i.EM.addEventListener(t,"keyup",I),i.EM.addEventListener(t,"keypress",I),i.EM.addEventListener(t,"mousedown",e.IME.blurHandler)):R.attachedInput=null,R.attachedInput},e.detachInput=function(){if(!R.attachedInput)return!1;if(K(!0),e.IME.hide(),R.attachedInput){var t=R.attachedInput;t.contentWindow&&(t=t.contentWindow.document.body.parentNode),i.EM.removeEventListener(t,"keydown",I),i.EM.removeEventListener(t,"keypress",I),i.EM.removeEventListener(t,"keyup",I),i.EM.removeEventListener(t,"mousedown",e.IME.blurHandler)}return R.attachedInput=null,!0},e.getAttachedInput=function(e){return R.attachedInput},e.open=e.show=function(t,n,o){if(!(t=e.attachInput(R.attachedInput||t))||!R.keyboard||!document.body)return!1;if(!R.keyboard.parentNode||11==R.keyboard.parentNode.nodeType){if((0,r.isString)(n)&&(n=document.getElementById(n)),!n.appendChild)return!1;n.appendChild(R.keyboard),!(0,r.isUndefined)(o)&&t!=o&&o.appendChild&&(i.EM.addEventListener(o,"keydown",I),i.EM.addEventListener(o,"keyup",I),i.EM.addEventListener(o,"keypress",I))}return!0},e.close=e.hide=function(){return!(!R.keyboard||!e.isOpen())&&(e.detachInput(),R.keyboard.parentNode.removeChild(R.keyboard),!0)},e.toggle=function(t,n,r){e.isOpen()?e.close():e.show(t,n,r)},e.isOpen=function(){return!!R.keyboard.parentNode&&1==R.keyboard.parentNode.nodeType};var K=function(e){if(R.attachedInput){var t=e?"":N.rtl?"rtl":"ltr";R.attachedInput.contentWindow?R.attachedInput.contentWindow.document.body.dir=t:R.attachedInput.dir=t}},U=function(){if(null==A.options){var e,t,n,r=A.heapSort(),o={};A.options={},R.langbox.innerHTML="";for(var a=0,i=r.length,s=0;a<i;a++)e=A[a],n=e.code+" "+e.name,A.hash[n]=a,A.codeFilter&&!A.codeFilter.hasOwnProperty(e.code)||(o.label!=e.code&&(o=document.createElement("optgroup"),o.label=e.code,R.langbox.appendChild(o)),t=document.createElement("option"),t.value=n,t.appendChild(document.createTextNode(e.name)),t.label=e.name,o.appendChild(t),A.options[n]=s++)}},B=function(e){return(0,r.isString)(e)?e.match(/\x01.+?\x01|[\ud800-\udbff][\udc00-\udfff]|./g).map(function(e){return e.replace(/[\x01\x02]/g,"")}):e.map(function(e){return(0,r.isArray)(e)?e.map(function(e){String.fromCharCodeExt(e)}).join(""):String.fromCharCodeExt(e).replace(/[\x01\x02]/g,"")})},F=function(e){var t,n,o,a,i,s,c,l,d=e.normal,u=e.shift||{},f=e.alt||{},h=e.shift_alt||{},g=e.caps||{},m=e.shift_caps||{},y=e.dk,E=e.cbk,C=null,b=-1,S=[];S.name=e.name,S.code=e.code,S.toString=e.toString;for(var T=0,O=d.length;T<O;T++){var N=d[T],A=null,R=null,k=null,x=[N];u.hasOwnProperty(T)&&(t=B(u[T]),i=T),i>-1&&t[T-i]?(k=t[T-i],x[p]=k):N&&N!=(N=N.toUpperCase())&&(x[p]=N,k=N),f.hasOwnProperty(T)&&(n=B(f[T]),s=T),s>-1&&n[T-s]&&(A=n[T-s],x[w]=A),h.hasOwnProperty(T)&&(o=B(h[T]),c=T),c>-1&&o[T-c]?x[L]=o[T-c]:A&&A!=(A=A.toUpperCase())&&(x[L]=A),g.hasOwnProperty(T)&&(a=B(g[T]),l=T),l>-1&&a[T-l]&&(R=a[T-l]),R?x[v]=R:k&&k.toUpperCase()!=k.toLowerCase()?x[v]=k:N&&(x[v]=N.toUpperCase()),m.hasOwnProperty(T)&&(C=B(m[T]),b=T),b>-1&&C[T-b]?x[M]=C[T-b]:k?x[M]=k.toLowerCase():N&&(x[M]=N),S[T]=x}if(y){S.dk={};for(var T in y)if(y.hasOwnProperty(T)){var I=T;parseInt(T)&&T>9&&(I=String.fromCharCode(T)),S.dk[I]=B(y[T]).join("").replace(I,I+I)}}return S.rtl=!!S.join("").match(/[\u05b0-\u06ff]/),S.domain=e.domain,(0,r.isFunction)(E)?S.charProcessor=E:E&&(S.activate=E.activate,S.charProcessor=E.charProcessor),S},Q=function(){var e=[];e[h]=O.modeNormal,e[p]=O.modeShift,e[w]=O.modeAlt,e[L]=O.modeShiftAlt,e[v]=O.modeCaps,e[M]=O.modeShiftCaps,e[g]=O.modeNormal,e[m]=O.modeNormal,e[S]=O.modeShift,e[E]=O.modeShift,e[C]=O.modeCaps,e[y]=O.modeCaps,e[b]=O.modeShiftAltCaps,e[T]=O.modeShiftAltCaps,a.DOM.CSS(R.desk).removeClass(e).addClass(e[f])},V=function(e){var t=f^e;t&p&&_(!!(e&p),d.SHIFT),t&g&&_(!!(e&g),d.ALT),t&m&&_(!!(e&m),d.CTRL),t&v&&Y(!!(e&v),d.CAPS),f=e},_=function(e,t){var n=document.getElementById(s+t+"_left"),r=document.getElementById(s+t+"_right");switch(0+e){case 0:n.className=a.DOM.CSS(r).removeClass(O.buttonDown).getClass();break;case 1:a.DOM.CSS(R.desk).removeClass([O.hoverShift,O.hoverAlt]),n.className=a.DOM.CSS(r).addClass(O.buttonDown).getClass();break;case 2:d.SHIFT==t&&f&p^p?a.DOM.CSS(R.desk).addClass(O.hoverShift):d.ALT==t&&f^w&&a.DOM.CSS(R.desk).addClass(O.hoverAlt),n.className=a.DOM.CSS(r).addClass(O.buttonHover).getClass();break;case 3:d.SHIFT==t?a.DOM.CSS(R.desk).removeClass(O.hoverShift):d.ALT==t&&a.DOM.CSS(R.desk).removeClass(O.hoverAlt),n.className=a.DOM.CSS(r).removeClass(O.buttonHover).getClass()}},Y=function(e,t,n){var r=document.getElementById(t?s+t:n);if(r)switch(0+e){case 0:a.DOM.CSS(r).removeClass(O.buttonDown);break;case 1:a.DOM.CSS(r).addClass(O.buttonDown);break;case 2:a.DOM.CSS(r).addClass(O.buttonHover);break;case 3:a.DOM.CSS(r).removeClass(O.buttonHover)}},Z=function(e,t){var n=[e,0];if((0,r.isFunction)(N.charProcessor))n=N.charProcessor(e,t);else if("\b"==e)n=["",0];else if(N.dk&&t.length<=1)if(N.dk.hasOwnProperty(t)){n[1]=0;var o=N.dk[t],a=o.indexOf(e)+1;n[0]=a?o.charAt(a):e}else N.dk.hasOwnProperty(e)&&(n[1]=1,n[0]=e);return n},X=function(e){var t=document.createElement("span");document.body.appendChild(t),t.style.position="absolute",t.style.left="-1000px";for(var n,r,o=0,a=e.length,i=[];o<a;o++)n=e[o],i.push(["<div id='",s,o,"' class='",O.buttonUp,"'><a>",G(e,n,h,O.charNormal,t),G(e,n,p,O.charShift,t),G(e,n,w,O.charAlt,t),G(e,n,L,O.charShiftAlt,t),G(e,n,v,O.charCaps,t),G(e,n,M,O.charShiftCaps,t),"</a></div>"].join(""));for(var o in l)l.hasOwnProperty(o)&&(n=l[o],r=n.replace(/_.+/,""),i.splice(o,0,["<div id='",s,n,"' class='",O.buttonUp,"'><a title='",r,"'","><span class='title'>",r,"</span>","</a></div>"].join("")));return document.body.removeChild(t),i.join("").replace(/(<\w+)/g,"$1 unselectable='on' ")},G=function(e,t,n,r,o){var a=[],i=e.dk&&e.dk.hasOwnProperty(t[n]),s=t[n]||"";return i&&(r+=" "+O.deadkey),(n==M&&t[v]&&s.toLowerCase()==t[v].toLowerCase()||n==v&&t[M]&&s.toLowerCase()==t[M].toLowerCase())&&(r+=" "+O.hiddenCaps),(n==p&&t[h]&&s.toLowerCase()==t[h].toLowerCase()||n==h&&t[p]&&s.toLowerCase()==t[p].toLowerCase())&&(r+=" "+O.hiddenShift),(n==p&&t[M]&&s.toLowerCase()==t[M].toLowerCase()||n==M&&t[p]&&s.toLowerCase()==t[p].toLowerCase())&&(r+=" "+O.hiddenShiftCaps),(n==v&&t[h]&&s.toLowerCase()==t[h].toLowerCase()||n==h&&t[v]&&s.toLowerCase()==t[v].toLowerCase())&&(r+=" "+O.hiddenCaps),(n==L&&t[w]&&s.toLowerCase()==t[w].toLowerCase()||n==w&&t[p]&&s.toLowerCase()==t[p].toLowerCase())&&(r+=" "+O.hiddenAlt),a.push("<span"),r&&a.push(' class="'+r+'"'),a.push(" > "+s+" </span>"),a.join("")};e.init=function(o){var a=(0,r.mergeObject)(n,o);console.log(a),R.keyboard=document.createElement("div"),R.keyboard.unselectable="on",R.keyboard.id="virtualKeyboard",R.keyboard.innerHTML=('<div id="kbDesk"><!-- --></div><select id="kb_langselector" '+(a.showKeyboardLayouts?"":'style="display: none;"')+'></select><select id="kb_mappingselector" '+(a.showKeyboardMaps?"":'style="display: none;"')+"></select>").replace(/(<\w+)/g,"$1 unselectable='on' "),R.desk=R.keyboard.firstChild;var s=R.keyboard.childNodes.item(1);i.EM.addEventListener(s,"change",function(t){e.switchLayout(this.value)}),R.langbox=s;var s=s.nextSibling,c="";u.hasOwnProperty(t)||(t="QWERTY Standard");for(var l in u){var d=u[l].split("").map(function(e){return e.charCodeAt(0)});d.splice(14,0,8,9),d.splice(28,0,13,20),d.splice(41,0,16),d.splice(52,0,16,46,17,18,32,18,17);var f=d;d=[];for(var h=0,p=f.length;h<p;h++)d[f[h]]=h;u[l]=d,f=l.split(" ",2),0!=c.indexOf(c=f[0])&&(s.appendChild(document.createElement("optgroup")),s.lastChild.label=c),d=document.createElement("option"),s.lastChild.appendChild(d),d.value=l,d.innerHTML=f[1],d.selected=l==t}t=u[t],i.EM.addEventListener(s,"change",W),i.EM.addEventListener(R.desk,"mousedown",D),i.EM.addEventListener(R.desk,"mouseup",P),i.EM.addEventListener(R.desk,"mouseover",H),i.EM.addEventListener(R.desk,"mouseout",H),i.EM.addEventListener(R.desk,"click",i.EM.preventDefaultAction),R.keyboard.onmousedown=function(e){if(!e||!e.target.tagName||"select"!=e.target.tagName.toLowerCase())return!1},n.layout=a.layout}};c.Langs={},c.IME=s.IME,function(e){e.fn.virtkeys=function(t){function n(t){c.open(t instanceof e?t.get(0):t,this.get(0))}function r(){c.close()}function o(t){c.toggle(t instanceof e?t.get(0):t,this.get(0))}function a(){return c.getLayoutCodes()}function i(e){return c.switchLayout(e)}function s(e){for(var t=0,n=e.length;t<n;t++)c.addLayout(e[t])}function l(){return e.fn.virtkeys._layouts}function d(t){if(void 0===t&&void 0===(t=e.fn.virtkeys._langs))throw"Object containing IME languages cannot be found.";c.Langs=t}var u=this;return function(){c.init(t||{}),u.VirtualKeyboard=c,u.open=n,u.close=r,u.toggle=o,u.getLayoutCodes=a,u.switchLayout=i,u.addLayouts=s,u.getLoadedLayouts=l,u.addIMELanguages=d}(),u},e.fn.virtkeys._layouts={}}(jQuery)},/*!***********************************!*\
  !*** ./src/extensions/helpers.js ***!
  \***********************************/
function(e,t){"use strict";function n(e){return"undefined"==typeof e}function r(e){return"function"==typeof e}function o(e){return"string"==typeof e}function a(e){return"number"==typeof e}function i(e){return(a(e)||o(e))&&!isNaN(parseInt(e))&&isFinite(parseInt(e))}function s(e){return e instanceof Array}function c(e){return e instanceof RegExp}function l(e){return"boolean"==typeof e}function d(e){return i(e)||o(e)||l(e)}function u(e){if(l(e))return!1;if(c(e)&&new RegExp("").toString()==e.toString())return!0;if(o(e)||a(e))return!e;if(Boolean(e)&&0!=e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function f(){throw"Commented out because of UglifyJsPlugin and RemoveCommentsLoader"}function h(e){var t=document.getElementsByTagName("html")[0].innerHTML,n=new RegExp("<script[^>]+?srcs*=s*[\"']?([^>]+?/)"+e+"[^>]*>.?</script>","i"),r=t.match(n);return r?r[1].match(/^((https?|file)\:\/{2,}|\w:[\\])/)?r[1]:0==r[1].indexOf("/")?r[1]:(b=document.getElementsByTagName("base"),b[0]&&b[0].href?b[0].href+r[1]:(document.location.href.match(/(.*[\/\\])/)[0]+r[1]).replace(/^\/+/,"")):null}function p(e){var t=document.getElementsByTagName("html")[0].innerHTML,n=new RegExp("<script[^>]+?srcs*[^>]+?/"+e+"([^#\"']*).+?</script>","i"),r=t.match(n);return r?g(r[1].replace(/^[^?]*\?([^#]+)/,"$1")):{}}function g(e){if("string"!=typeof e||e.length<2)return{};e=e.split(/&amp;|&/g);for(var t,n,r=0,o=e.length,a={};r<o;r++)t=e[r].split("="),t[0]=t[0].replace(/[{}\[\]]*$/,""),n=a[t[0]],t[1]=unescape(t[1]?t[1].replace("+"," "):""),n?"array"==typeof n?a[t[0]][a[t[0]].length]=t[1]:a[t[0]]=[a[t[0]],t[1]]:a[t[0]]=t[1];return a}function m(e,t,r,i){if(o(e)&&(e=document.getElementById(e)),!e||!DOM.hasTagName(e,["table","tbody,","thead","tfoot"]))return null;if(!(u(r)||o(r)&&(e=e.getElementsByTagName(r))))return null;if(!u(i)&&(!a(i)||i<0||!(e=e[i])))return null;if(n(e.rows))return null;for(var c=[],l=document.createElement("span"),d=null,f=0,h=e.rows.length;f<h;f++){var p=[];if(s(t))for(var g=0,m=t.length;g<m;g++)d=e.rows[f].cells[t[g]],d?(l.innerHTML=d.innerText?d.innerText:d.innerHTML.replace(/<script\s+(.|\r?\n)*?<\/script>|<[^>]*>/g,""),l.normalize(),p[p.length]=l.firstChild?l.firstChild.nodeValue.trim("  "):""):p[p.length]="";else for(var g=0,v=e.rows[f].cells.length;g<v;g++)cd=e.rows[f].cells[g],l.innerHTML=d.innerText?d.innerText:d.innerHTML.replace(/<script\s+(.|\r?\n)*?<\/script>|<[^>]*>/g,""),l.normalize(),p[p.length]=l.firstChild?l.firstChild.nodeValue.trim("  "):"";u(p)||(c[c.length]=p)}return c}function v(e,t,n){return setInterval(function(){n instanceof Array?e.apply(this,n):e.call(this,n)},t)}function y(e,t,n){return setTimeout(function(){n instanceof Array?e.apply(this,n):e.call(this,n)},t)}function E(e){if(d(e)||r(e)||null==e)return e;try{var t=new e.constructor}catch(e){return null}if(s(t))for(var n=0,o=e.length;n<o;n++)t[n]=E(e[n]);else for(var n in e)e.hasOwnProperty(n)&&(t[n]=E(e[n]));return t}function C(){for(var e,t,n={},o=0,a=arguments.length;o<a;o++){t=arguments[o];for(var i in t)t.hasOwnProperty(i)&&(e=t[i],null==e?n.hasOwnProperty(i)||(n[i]=e):s(e)?s(n[i])?n[i]=n[i].concat(e).unique():n[i]=e.slice(0):d(e)||r(e)?n[i]=e:n.hasOwnProperty(i)?n[i]=C(n[i],e):n[i]=E(e))}return n}function w(e){if(!S(e)){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=e,t.appendChild(n)}}function S(e){var t=document.getElementsByTagName("html")[0].innerHTML,n=new RegExp("<link[^>]+?srcs*=s*[\"']?([^>]+?/)"+sn+"[^>]*>","i");return n.test(t)}Object.defineProperty(t,"__esModule",{value:!0}),document.createElementExt=function(e,t){var n,r,o,a=document.createElement(e);if(!a)return null;for(r in t)if(t.hasOwnProperty(r))switch(r){case"class":a.setAttribute("className",t[r]),a.setAttribute("class",t[r]);break;case"style":for(o in t[r])t[r].hasOwnProperty(o)&&(a.style[o]=t[r][o]);break;case"event":for(o in t[r])t[r].hasOwnProperty(o)&&a.attachEvent(o,t[r][o]);break;case"child":for(n=t[r].length,o=0;o<n;o++)a.appendChild(t[r][o]);break;case"param":for(o in t[r])if(t[r].hasOwnProperty(o))try{a[o]=t[r][o]}catch(e){}}return a},t.isUndefined=n,t.isFunction=r,t.isString=o,t.isNumber=a,t.isNumeric=i,t.isArray=s,t.isRegExp=c,t.isBoolean=l,t.isScalar=d,t.isEmpty=u,t.gluePath=f,t.findPath=h,t.getScriptQuery=p,t.parseQuery=g,t.table2array=m,t.playInterval=v,t.playTimeout=y,t.cloneObject=E,t.mergeObject=C,t.loadStyleSheet=w,t.hasStyleSheet=S},/*!*************************************!*\
  !*** ./src/extensions/ext/array.js ***!
  \*************************************/
function(e,t,n){"use strict";var r=n(/*! ./../helpers */1);(0,r.isUndefined)(Array.prototype.copy)&&(Array.prototype.copy=function(){for(var e=new Array,t=0,n=this.length;t<n;t++)e[t]=this[t];return e}),(0,r.isUndefined)(Array.prototype.unique)&&(Array.prototype.unique=function(){for(var e=[],t=0,n=this.length;t<n;t++)e.indexOf(this[t])<0&&(e[e.length]=this[t]);return e}),(0,r.isUndefined)(Array.prototype.flatten)&&(Array.prototype.flatten=function(e,t){if(this.length<1)return[];isNumeric(e)&&(e=[e]);var n=!1;if(isArray(e)){n={};for(var o=0,a=e.length;o<a;o++)n[e[o]]=!0}for(var i=[],o=0,s=this.length;o<s;o++)if(!(0,r.isUndefined)(this[o]))if(isArray(this[o]))for(var c=0,a=this[o].length;c<a;c++)(!1===n||n.hasOwnProperty(c))&&(i[i.length]=this[o][c]);else!1===n&&(i[i.length]=this[o]);return i}),(0,r.isUndefined)(Array.prototype.binSearch)&&(Array.prototype.binSearch=function(e,t){var n=0,r=this.length,o=(Math.max(r-1,0),Math.ceil(r/2));if(null!=t)for(;(!this[o]||e!=this[o][t])&&r>=n;)this[o]&&e>this[o][t]?n=o+1:r=o-1,o=Math.max(0,Math.ceil((r+n)/2));else for(;e!=this[o]&&r>=n;)e>this[o]?n=o+1:r=o-1,o=Math.max(0,Math.ceil((r+n)/2));return o}),Array.prototype.heapSort=function(){for(var e,t=function(e,t,n){for(var r,o=e[t];;){if(r=(t<<1)+1,r>n)break;if(r<n&&e[r+1]>e[r]&&r++,o>=e[r])break;e[t]=e[r],t=r}e[t]=o},n=this.length-1,r=n>>1;r>=0;)t(this,r--,n);for(r=n;r>0;)e=this[0],this[0]=this[r],this[r]=e,t(this,0,--r);return this},(0,r.isUndefined)(Array.range)&&(Array.range=function(e,t,n){if(!isNumber(e))return null;isNumber(n)||(n=1),isNumber(t)||(t=0);var r=[],o=Math.min(t,e),a=Math.max(t,e),i=Math.abs(n),s=-1;do s++,r[s]=o,o+=i;while(o<=a);return n>0?r:r.reverse()})},/*!**************************************!*\
  !*** ./src/extensions/ext/object.js ***!
  \**************************************/
function(e,t){"use strict";"undefined"==typeof Object.hasOwnProperty&&(Object.prototype.hasOwnProperty=function(e){return!("undefined"==typeof this[e]||this.constructor&&this.constructor.prototype[e]&&this[e]===this.constructor.prototype[e])})},/*!**************************************!*\
  !*** ./src/extensions/ext/regexp.js ***!
  \**************************************/
function(e,t){"use strict";RegExp.escape=function e(t){if(!e.sRE){var n=["/",".","*","+","?","|","(",")","[","]","{","}","$","^","\\"];e.sRE=new RegExp("(\\"+n.join("|\\")+")","g")}return isString(t)?t.replace(e.sRE,"\\$1"):isArray(t)?t.map(RegExp.escape).join("|"):""}},/*!**************************************!*\
  !*** ./src/extensions/ext/string.js ***!
  \**************************************/
function(e,t){"use strict";String.fromCharCodeExt=function(e){return e<65536?String.fromCharCode(e):(e-=65536,String.fromCharCode(e>>10|55296)+String.fromCharCode(1023&e|56320))},String.prototype.entityDecode=function e(){e.span||(e.span=document.createElement("span"));var t=e.span;return t.innerHTML=this,t.firstChild?t.firstChild.nodeValue:""},String.prototype.ltrim=function(e){return isString(e)&&(e=e.split("")),isArray(e)||isUndefined(e)?(e=isEmpty(e)?"\\s":RegExp.escape(e),e=new RegExp("^(?:"+e+")+","g"),this.replace(e,"")):this},String.prototype.rtrim=function(e){return isString(e)&&(e=e.split("")),isArray(e)||isUndefined(e)?(e=isEmpty(e)?"\\s":RegExp.escape(e),e=new RegExp("(?:"+e+")+$","g"),this.replace(e,"")):this},String.prototype.dup=function(){var e=this.valueOf();return[e,e].join("")},String.prototype.repeat=function(e){return isNaN(e=parseInt(e))||e<0?"":Array(e+1).join(this.valueOf())},String.prototype.padding=function(e,t){var n=this.valueOf();if(e=parseInt(e),!e)return n;isUndefined(t)&&(t=" ");var r=String(t).charAt(0).repeat(Math.abs(e)-this.length);return e<0?r+n:n+r},String.prototype.padLeft=function(e,t){return this.padding(-Math.abs(e),t)},String.prototype.padRight=function(e,t){return this.padding(Math.abs(e),t)},String.prototype.sprintf=function(){var e=isArray(arguments[0])?arguments[0]:arguments,t=0,n=this.replace(/%%/g,"\0\0"),r=/%((?:\d+\$)?)((?:[-0+# ])?)((?:\d+|\*(?:\d+\$)?)?)((?:.(?:\d+|\*(?:\d+\$)?))?)([bcdeEfosuxX])/g;return n=n.replace(r,function(){var n,r=arguments,o=!1;isUndefined(r[3])||0!=r[3].indexOf("*")||(r[3]=parseInt(r[3].replace(/\D/g,"")),isNaN(r[3])?(r[3]=e[t],t++):r[3]=e[r[3]]),""!=r[4]&&(1==r[4].indexOf("*")?(r[4]=parseInt(r[4].replace(/\D/g,"")),isNaN(r[4])?(r[4]=e[t],t++):r[4]=e[r[4]]):r[4]=r[4].replace(/\D/,""),r[4]=Math.abs(r[4])),r[1]=parseInt(r[1]);var n;switch(isNumeric(r[1])?n=e[r[1]]:(n=e[t],t++),r[5]){case"b":n<0&&(n=0x10000000000000000+parseInt(n)),n=Number(n).bin(r[4]),r[4]&&(n=n.substr(0,r[4])),"#"==r[2]&&(n="0b"+n);break;case"c":n=String.fromCharCode(n);break;case"u":n=Math.abs(n);case"d":n=Math.round(n),n<0?n="-"+Math.abs(n).dec(r[4]):(n=Number(n).dec(r[4]),o=" "==r[2]||"+"==r[2]);break;case"e":case"E":n>0&&(o=" "==r[2]||"+"==r[2]),n=Number(n).toExponential(r[4]?r[4]:6),"E"==r[5]&&(n=n.toUpperCase());break;case"f":n>0&&(o=" "==r[2]||"+"==r[2]),n=Number(n).toFixed(isNumeric(r[4])?r[4]:6);break;case"o":n<0&&(n=0x10000000000000000+parseInt(n)),n=Number(n).toString(8),r[4]&&(n=n.substr(0,r[4])),"#"==r[2]&&0!=n&&(n="0"+n);break;case"s":n=String(n),r[4]&&(n=n.substr(0,r[4]));break;case"x":case"X":n<0&&(n=0x10000000000000000+parseInt(n)),n=Number(n).hex(-r[4]),r[4]&&(n=n.substr(0,r[4])),"#"==r[2]&&(n="0x"+n),"X"==r[5]&&(n=n.toUpperCase())}return o&&(n=r[2]+n),r[3]&&(n="-"==r[2]||r[3]<0?n.padRight(r[3]):n.padLeft(r[3],"0"==r[2]?0:" ")),n}),n.replace(/\0\0/g,"%")}},/*!*********************************************!*\
  !*** ./src/extensions/documentselection.js ***!
  \*********************************************/
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentSelection=void 0;var r=n(/*! ./dom */7),o=new function(){var e=this,t={prevCalcNode:"__prevCalcNode"},n=function(n,r){var o=r[0],a="";if(!o||!o.tagName)return!1;switch(r[0].tagName.toLowerCase()){case"input":if(o.type&&"text"!=o.type&&"password"!=o.type)return!1;case"textarea":a="input";break;case"iframe":a="frame",r[0]=o.contentWindow;break;default:return!1}if("function"==typeof e.module[a]&&(e.module[a]=new e.module[a](t)),!e.module[a]||!e.module[a][n])throw new Error("Method '"+n+"' is not implemented for DocumentSelection '"+a+"' module.");return e.module[a][n].apply(e,r)},r=function(t,n,r){if(window.getSelection&&"iframe"!=t.tagName.toLowerCase()){var o=e.getSelectionOffset(t);t.contentWindow&&(t=t.contentWindow.document.body),n>o.y?t.scrollTop=o.y:n+t.clientHeight>o.y?t.scrollTop=n:t.scrollTop=o.y-t.clientHeight/2,r>o.x?t.scrollLeft=o.x:r+t.clientWidth>o.x?t.scrollLeft=r:t.scrollLeft=o.x-t.clientWidth/2}};e.setRange=function(t,o,a,i){var s=t.scrollTop,c=t.scrollLeft;if(i){var l=e.getStart(t);a=l+a,o=l+o}o<0&&(o=0),a<o&&(a=o),n("setRange",[t,o,a]),r(t,s,c)},e.getSelection=function(e){return n("getSelection",[e])},e.getStart=function(e){return n("getPos",[e])[0]},e.getEnd=function(e){return n("getPos",[e])[0]},e.getCursorPosition=function(t){return e.getStart(t)},e.insertAtCursor=function(e,t,o){var a=e.scrollTop,i=e.scrollLeft;o||n("del",[e]);var s=n("ins",[e,t]);return r(e,a,i),s},e.wrapSelection=function(t,n,r){var o=e.getCursorPosition(t),a=e.getEnd(t);o==a?e.insertAtCursor(t,n+r):(e.insertAtCursor(t,n,!0),e.setRange(t,a+n.length,a+n.length),e.insertAtCursor(t,r,!0))},e.deleteAtCursor=function(t,n){return e.getSelection(t)||(n?e.setRange(t,0,1,!0):e.setRange(t,-1,0,!0)),e.deleteSelection(t)},e.deleteSelection=function(e){var t=e.scrollLeft,o=e.scrollTop,a=n("del",[e]);return r(e,o,t),a},e.getSelectionOffset=function(e){return n("getSelectionOffset",[e],!0)},e.getContext=function(e){return n("getContext",[e])}};o.module={input:function(e){var t=this,n=null;t.getContext=function(e){var n=t.getPos(e),r=e.value,o=r.match(new RegExp("(?:.|[\\r\\n]){0,"+(n[0]-1)+"}(?:^|\\s)","m"))||"",a=r.match(new RegExp("(?:.|[\\r\\n]){"+n[0]+"}","m"))[0],i=r.replace(a,""),s=i.substring(0,n[1]-n[0]),c=i.replace(s,"").match(/(?:\S|$)*/);return[a.replace(o,""),s,c]},t.getPos=function(e){var t=[0,0];if("function"==typeof window.getSelection)try{t=[e.selectionStart,e.selectionEnd]}catch(e){}else if(e.setActive(),t=[Math.abs(e.document.selection.createRange().moveStart("character",-1e8)),Math.abs(e.document.selection.createRange().moveEnd("character",-1e8))],"input"!=e.tagName.toLowerCase()){var n=e.document.body.createTextRange();n.moveToElementText(e);var r=Math.abs(n.moveStart("character",-1e8));t[0]-=r,t[1]-=r}return t},t.del=function(e){var n="",r=t.getPos(e),o=r[0],a=r[1];if(o!=a){var i=document.selection&&!window.opera?e.value.replace(/\r/g,""):e.value;n=i.substring(o,a),e.value=i.substring(0,o)+i.substring(a,i.length),t.setRange(e,o,o)}return n},t.ins=function(e,n){var r=t.getPos(e)[0],o=document.selection&&!window.opera?e.value.replace(/\r/g,""):e.value;return e.value=o.substring(0,r)+n+o.substring(r,o.length),r+=n.length,t.setRange(e,r,r),r},t.getSelection=function(e){var n=t.getPos(e),r=n[0],o=n[1];o<r&&(o=r);var a=document.selection&&!window.opera?e.value.replace(/\r/g,""):e.value;return a.substring(r,o)},t.setRange=function(e,t,n){if("function"==typeof e.setSelectionRange)try{e.setSelectionRange(t,n)}catch(e){}else{var r;try{r=e.createTextRange()}catch(t){try{r=e.document.body.createTextRange(),r.moveToElementText(e)}catch(e){return!1}}e.setActive(),r.collapse(!0),r.moveStart("character",t),r.moveEnd("character",n-t),r.select()}},t.getSelectionOffset=function(t){var o,a=r.DOM.getWindow(t).document;if("function"==typeof t.setSelectionRange){if(n||(n=a.createElement("td"),a.body.appendChild(n)),n[e.prevCalcNode]!=t){n[e.prevCalcNode]=t;var i=a.defaultView.getComputedStyle(t,null);for(var s in i)try{i[s]&&(n.style[s]=i[s])}catch(e){}n.style.overflow="auto",n.style.position="absolute",n.style.visibility="hidden",n.style.zIndex="-10",n.style.left="-10000px",n.style.top="-10000px",n.style.backgroundColor="yellow"}var o=a.createRange(),c=t.value||" ";"input"==t.tagName.toLowerCase()?(n.style.width="auto",n.style.whiteSpace="nowrap"):n.style.whiteSpace="off"==t.getAttribute("wrap")?"pre":"",c=c.replace(/\x20\x20/g,"  ").replace(/</g,"&lt;").replace(/>/g,"&gt"),n.innerHTML=(c.substring(0,t.selectionStart-1)+"<span>"+c.substring(t.selectionStart-1,t.selectionStart)+"</span>"+c.substring(t.selectionStart)).replace(/\n/g,"<br />").replace(/\t/g,'<em style="white-space:pre">\t</em>');var l=n.getElementsByTagName("span")[0];l.style.border="1px solid red",o.offsetLeft=l.offsetLeft,o.offsetTop=l.offsetTop,o.offsetHeight=l.offsetHeight,"\n"==c.charAt(t.selectionStart-1)&&(o.offsetTop+=2*o.offsetHeight),l=null}else if(a.selection&&a.selection.createRange&&(o=a.selection.createRange(),o.offsetHeight=Math.round(o.boundingHeight/(o.text.replace(/[^\n]/g,"").length+1)),t.tagName&&"textarea"==t.tagName.toLowerCase())){var d=r.DOM.getOffset(t);o={offsetTop:o.offsetTop-d.y+r.DOM.getBodyScrollTop(t),offsetLeft:o.offsetLeft-d.x+r.DOM.getBodyScrollLeft(t),offsetHeight:o.offsetHeight}}return o?{x:o.offsetLeft,y:o.offsetTop,h:o.offsetHeight}:{x:0,y:0,h:0}}},frame:function(){var e=this;e.getContext=function(t){if("function"==typeof t.getSelection){var n=e.getPos(t),r=t.document.body.innerText||t.document.body.innerHTML.replace(/<\/?[a-z:]+[^>]*>/gi,"").replace("&nbsp;"," "),o=r.match(new RegExp("(?:.|[\\r\\n]){0,"+(n[0]-1)+"}(?:^|\\s)","m"))||"",a=r.match(new RegExp("(?:.|[\\r\\n]){"+n[0]+"}","m"))||"",i=r.replace(a,""),s=i.substring(0,n[1]-n[0]),c=i.replace(s,"").match(/(?:\S|$)*/);return[a.toString().replace(o,""),s,c]}var l=t.document.selection.createRange(),d=t.document.selection.createRange(),u=t.document.selection.createRange();return l.moveStart("word",-1),u.moveEnd("word",1),[l.text.replace(new RegExp(RegExp.escape(d.text)+"$"),""),d.text,u.text.replace(new RegExp("^"+RegExp.escape(d.text)),"")]},e.getPos=function(e){var t=[0,0];if("function"==typeof e.getSelection){for(var n,r=e.getSelection(),o=r.anchorNode,a=r.anchorOffset,i=r.focusNode,s=r.focusOffset,c=!1,l=!1,d=0,u=0,f=e.document.createTreeWalker(e.document.body,NodeFilter.SHOW_TEXT,null,!1);o&&3!=o.nodeType;)o=o.childNodes[a],a=0;for(;i&&3!=i.nodeType;)i=i.childNodes[s],s=0;for(;(n=f.nextNode())&&(n==i&&(u+=s,l=!0),n==o&&(d+=a,c=!0),l||(u+=n.nodeValue.length),c||(d+=n.nodeValue.length),!l||!c););t=[Math.min(u,d),Math.max(u,d)]}else e.document.body.setActive(),t=[Math.abs(e.document.selection.createRange().moveStart("character",-1e8)),Math.abs(e.document.selection.createRange().moveEnd("character",-1e8))];return t},e.del=function(e){if("function"==typeof e.getSelection){for(var t=e.getSelection(),n=t.rangeCount;--n>-1;)t.getRangeAt(n).deleteContents();var r=t.getRangeAt(t.rangeCount-1);r.insertNode(e.document.createTextNode("")),t.addRange(r)}else e.document&&e.document.selection&&(e.document.selection.createRange().text="",e.document.selection.createRange().select())},e.ins=function(t,n){if("function"==typeof t.getSelection){n=n.replace(/&/,"&amp;").replace(/</,"&lt;").replace(/>/,"&gt;").replace(/\x20/,"&nbsp;").replace(/[\r\n]/,"<br />");var r,o=t.document.createElement("span"),a=t.getSelection(),i=a.getRangeAt(0);o.innerHTML=n,i.insertNode(o),i.selectNodeContents(o);var s=o.parentNode,r=o.nextSibling;o.parentNode.replaceChild(i.extractContents(),o),r||(r=s.lastChild);var c=t.document.createRange();r.nodeValue?c.setStart(r,0):c.setStartAfter(r),a.removeAllRanges(),a.addRange(c)}else if(t.document&&t.document.selection){t.document.body.setActive();var i=t.document.selection.createRange();i.text=n,i.moveStart("character",1)&&(i.moveStart("character",-1),i.moveEnd("character",-1),i.select())}return e.getPos(t)[0]},e.getSelection=function(e,t,n){if("function"==typeof e.getSelection){var t=e.getSelection();return t?t.toString():""}if(e.document&&e.document.selection)return e.document.selection.createRange().text},e.setRange=function(e,t,n){if("function"==typeof e.getSelection){var r=e.getSelection();r.removeAllRanges();for(var o,a,i=e.document.createRange(),s=0,c=e.document.createTreeWalker(e.document.body,NodeFilter.SHOW_TEXT,null,!1);(o=c.nextNode())&&(!o.nodeValue.length||s+o.nodeValue.length<=t);)a=o,s+=o.nodeValue.length;if((o||(o=a))&&(i.setStart(o,t-s),i.setEnd(o,t-s)),o)do if(3==o.nodeType){if(!(s+o.nodeValue.length<n)){i.setEnd(o,n-s);break}s+=o.nodeValue.length}while(o=c.nextNode());r.addRange(i)}else if(e.document&&e.document.selection){e.document.body.setActive();var i=e.document.selection.createRange();i.moveToElementText(e.document.body),i.move("character",t),i.moveEnd("character",n-t),i.select()}},e.getSelectionOffset=function(e){var t={x:0,y:0,h:0};if("function"==typeof e.getSelection){var n=e.getSelection().getRangeAt(0),r=e.document.createElement("span"),o=n.cloneContents(),a=(n.endOffset,r);for(r.style.borderLeft="1px solid red",n.surroundContents(r),t.h=a.offsetHeight;a.offsetParent;)t.x+=a.offsetLeft,t.y+=a.offsetTop,a=a.offsetParent;r.parentNode.removeChild(r);var i=e.document.createRange();if(o.childNodes.length>0){for(var s=0;s<o.childNodes.length;s++){var a=o.childNodes[s];n.insertNode(a),i.selectNode(a)}e.getSelection().addRange(i)}}else if(e.document&&e.document.selection){var n=e.document.selection.createRange();t.h=n.boundingHeight,t.x=n.offsetLeft,t.y=n.offsetTop}return t}}},t.DocumentSelection=o},/*!*******************************!*\
  !*** ./src/extensions/dom.js ***!
  \*******************************/
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DOM=void 0;var r=n(/*! ./helpers */1),o={};o.getParent=function e(t,n,a){return null==t?null:1==t.nodeType&&(!(0,r.isUndefined)(a)&&t[n]==a||"string"==typeof n&&o.hasTagName(t,n)||t==n)?t:e(t.parentNode,n,a)},o.getOffset=function(e){var t=!0,n=e,r=0,o=0,a=0,i=0,s=null;if(null==n)return null;s=n.offsetParent;for(var c=n,e=n;null!=e.parentNode;){if(e=e.parentNode,null!==e.offsetParent){var l=!0;t&&window.opera&&(e!=c.parentNode&&"TR"!=e.nodeName||(l=!1)),l&&(e.scrollTop&&e.scrollTop>0&&(o-=e.scrollTop),e.scrollLeft&&e.scrollLeft>0&&(r-=e.scrollLeft))}e==s&&(r+=n.offsetLeft,e.clientLeft&&"TABLE"!=e.nodeName&&(r+=e.clientLeft),o+=n.offsetTop,e.clientTop&&"TABLE"!=e.nodeName&&(o+=e.clientTop),n=e,null==n.offsetParent&&(n.offsetLeft&&(r+=n.offsetLeft),n.offsetTop&&(o+=n.offsetTop)),s=n.offsetParent)}return c.offsetWidth&&(a=c.offsetWidth),c.offsetHeight&&(i=c.offsetHeight),{x:r,y:o,width:a,height:i}},o.getClientWidth=function(e){var t=this.getWindow(e),n=t.document,r=0;return t.innerWidth?r=t.innerWidth:n.documentElement&&n.documentElement.clientWidth?r=n.documentElement.clientWidth:n.body&&(r=n.body.clientWidth),r},o.getOffsetWidth=function(e){var t=this.getWindow(e),n=t.document,r=0;return t.outerWidth?r=t.outerWidth:n.documentElement&&n.documentElement.clientWidth?r=n.documentElement.clientWidth:n.body&&(r=n.body.clientWidth),r},o.getClientHeight=function(e){var t=this.getWindow(e),n=t.document,r=0;return t.innerHeight?r=t.innerHeight:n.documentElement&&n.documentElement.clientHeight?r=n.documentElement.clientHeight:n.body&&(r=n.body.clientHeight),r},o.getOffsetHeight=function(e){var t=this.getWindow(e),n=t.document,r=0;return t.outerHeight?r=t.outerHeight:n.documentElement&&n.documentElement.clientHeight?r=n.documentElement.clientHeight:n.body&&(r=n.body.clientHeight),r},o.getBodyScrollTop=function(e){var t=this.getWindow(e),n=t.document;return t.pageYOffset||n.documentElement&&n.documentElement.scrollTop||n.body&&n.body.scrollTop},o.getBodyScrollLeft=function(e){var t=this.getWindow(e),n=t.document;return t.pageXOffset||n.documentElement&&n.documentElement.scrollLeft||n.body&&n.body.scrollLeft},o.getWindow=function(e){var t=window;if(e){var n=e.ownerDocument;t=n.defaultView||n.parentWindow||n.window||window}return t},o.getCursorPosition=function(e){if(e.pageX||e.pageY)return{x:e.pageX,y:e.pageY};var t=document.documentElement||document.body;return{x:e.clientX+t.scrollLeft-(t.clientLeft||0),y:e.clientY+t.scrollTop-(t.clientTop||0)}},o.hasTagName=function(e,t){if((0,r.isString)(t)&&(t=[t]),!(0,r.isArray)(t)||(0,r.isEmpty)(t)||(0,r.isUndefined)(e)||(0,r.isEmpty)(e.tagName))return!1;for(var n=e.tagName.toLowerCase(),o=0,a=t.length;o<a;o++)if(t[o].toLowerCase()==n)return!0;return!1},o.color2rgb=function(e){var t;if(/^([a-z]+)($|\s[a-z]+)/i.test(e)){var n=document.body,r=n.vLink;n.vLink=e.split(" ")[0],e=n.vLink,n.vLink=r}try{return(t=e.match(/^#([\da-f]{6})$/i))?(t=parseInt(t[1],16),[(16711680&t)>>16,(65280&t)>>8,255&t]):(t=e.match(/^#([\da-f]{3})$/i))?(t=parseInt(t[1],16),[17*((3840&t)>>8),17*((240&t)>>4),17*(15&t)]):e.match(/([\d%]+)/g).splice(0,3).map(function(e){return/%/.test(e)?(2.55*parseInt(e)).toFixed(0):parseInt(e)})}catch(e){return}},o.setOpacity=function(e,t){e.style.opacity!=t&&(e.style.opacity=e.style.KhtmOpacity=e.style.MozOpacity=t,e.style.filter="alpha(opacity="+100*t+")")},o.CSS=function(e){var t=this;return t.addClass=function(){var n=(0,r.isArray)(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return t.removeClass(n),e.className=e.className+" "+Array.prototype.join.call(n," "),t},t.removeClass=function n(){var o=(0,r.isArray)(arguments[0])?arguments[0]:arguments;n.cache||(n.cache={});for(var a=n.cache,i=0,s=o.length;i<s;i++)a.hasOwnProperty(o[i])||(a[o[i]]=new RegExp("(^|\\s+)"+o[i]+"(\\s+|$)")),e.className=e.className.replace(a[o[i]]," ");return e.className=e.className.replace(/\s{2,}/," "),t},t.hasClass=function(t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return e.className.match(n," "+t+" ")},t.getClass=function(){return e.className},t.getClassValue=function(t){var n=e.className.match(new RegExp("(^|\\s)"+t+":([^\\s]+)"));return n?n[2].indexOf(":")+1?n[2].split(":"):n[2]:null},t.getComputedStyle=function(t){var n;return e.currentStyle?n=t?e.currentStyle[t]:e.currentStyle:window.getComputedStyle?(n=document.defaultView.getComputedStyle(e,null),t&&(n=n[t])):n=null,n},this},t.DOM=o},/*!****************************************!*\
  !*** ./src/extensions/eventmanager.js ***!
  \****************************************/
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EM=void 0;var r=n(/*! ./helpers */1),o=(n(/*! ./dom */7),new function(){var e=this,t=[],n=0,a={UEID:"__eventManagerUniqueElementId"},i=function(e){c(e);var n=null,o=null,i=(e.target,!0);if(e.currentTarget&&(n=e.currentTarget[a.UEID])&&(o=t[n].handler[e.type])){try{for(var s=0,l=o.length;s<l;s++)(0,r.isFunction)(o[s])&&(i=i&&!(!1===o[s].call(e.currentTarget,e)))}catch(t){setTimeout(function(){throw new Error("Event handler for ["+e.type+'] has failed with exception: "'+t.message+'"')},10)}return i}},s=function e(n){for(var r=t.length-1,o=null,a=null;r>=0;r--){if(t[r]&&(a=(o=t[r]).node))for(var s in o.handler)if(o.handler.hasOwnProperty(s)){try{a.removeEventListener?a.removeEventListener(s,o.rootEHCaller?o.rootEHCaller:i,!1):a.detachEvent&&a.detachEvent("on"+s,o.rootEHCaller?o.rootEHCaller:i)}catch(e){}o.handler[s].length=0}a=o.node=null}window.removeEventListener?window.removeEventListener(s,e,!1):window.detachEvent("on"+s,e)},c=function(t){for(var n,r,o,a,i=e.EU.length;i--;)if(n=e.EU[i],n[0].test(t.type)){for(o=n[1].length,a=null;o--;)r=n[1][o],"init"==r[0]?a=r[1]:t[r[0]]||(t[r[0]]=r[1]);a&&a.call(t)}return t.target||"unload"==t.type||(t.target=t.srcElement),t},l=function(e,t){return e[a.UEID]||t&&(e[a.UEID]=++n)};e.addEventListener=function(e,n,o){if(!e||!(0,r.isFunction)(o))return!1;var a=l(e,!0),s=null,c=null;return t[a]||(t[a]={node:e,handler:{}}),s=t[a],s.handler.hasOwnProperty(n)||(s.handler[n]=[],e.addEventListener?e.addEventListener(n,i,!1):e.attachEvent&&(s.rootEHCaller=function(e){e.currentTarget=s.node;var t=i(e);return e.currentTarget=null,t},e.attachEvent("on"+n,s.rootEHCaller))),c=s.handler[n],c.indexOf(o)==-1&&(c[c.length]=o,!0)},e.removeEventListener=function(e,n,o){if(!e||!(0,r.isFunction)(o))return!1;var a=l(e),s=t[a],c=null;return!(!s||!(c=s.handler[n]))&&(c.splice(c.indexOf(o),1),0==c.length&&(delete s.handler[n],e.removeEventListener?e.removeEventListener(n,s.rootEHCaller?s.rootEHCaller:i,!1):e.detachEvent&&e.detachEvent("on"+n,s.rootEHCaller?s.rootEHCaller:i)),!0)},e.dispatchEvent=function(e){var t=i(e);return t},e.registerEvent=function(e,n,r,a){var i=l(e,!0);return t[i]?t[i].node=e:t[i]={node:e,handler:[]},new o.EventTarget(e,n,r,a)};var d=function(){window.attachEvent&&!window.addEventListener&&window.attachEvent("onunload",s)};d()});o.preventDefaultAction=function(e){e.preventDefault()},o.stopPropagationAction=function(e){e.stopPropagation()},o.EventTarget=function(e,t,n,a){var i=this,s=!!n,c=(0,r.isFunction)(a)?a:null;i.trigger=function(i,u){arguments.length-1||i==e||(u=i,i=null),i||(i=e);var f={},h=!0,p=!0,g=null;for(var m in u)u.hasOwnProperty(m)&&(f[m]=u[m]);s=!!n,c=a;do f.preventDefault=l,f.stopPropagation=d,f.target=i,f.currentTarget=i,f.type=t,g=o.dispatchEvent(f),p&=(0,r.isUndefined)(g),h&=!(!1===g);while((i=i.parentNode)&&s);return(0,r.isFunction)(c)&&h&&!p&&c(f),c&&h&&!p};var l=function(){c=null},d=function(){s=!1}},o.EU=[[/./,[["preventDefault",function(){this.returnValue=!1}],["stopPropagation",function(){this.cancelBubble=!0}]]],[/^mouse(over|out|down|up)/,[["getButton",function(){return 2==this.button?2:1}],["EM_MB_LEFT","1"],["EM_MB_RIGHT","2"]]],[/^key(down|up|press)/,[["getKeyCode",function(){switch(this.keyCode){case 189:return 109;case 187:return 61;case 107:return 61;case 186:return 59;default:return this.keyCode}}],["getRepeat",function e(){return e.repeat}],["init",function(){var e=this.getRepeat;"keyup"==this.type?(e.repeat=0,e.keyCode=0):"keydown"==this.type&&(e.repeat=e.keyCode==this.keyCode,e.keyCode=this.keyCode)}]]]],function(){var e=o.registerEvent(window,"domload"),t=!1,n=function(){o.removeEventListener(document,"propertychange",r.ie),o.removeEventListener(document,"DOMContentLoaded",r.mz),o.removeEventListener(window,"load",r.mz)},r={ie:function(r){"activeElement"!=window.event.propertyName||t||(e.trigger(window),n(),t=!0)},mz:function(n){t||e.trigger(window),t=!0}};o.addEventListener(document,"propertychange",r.ie),o.addEventListener(document,"DOMContentLoaded",r.mz),(/WebKit|Khtml/i.test(navigator.userAgent)||window.opera&&parseInt(window.opera.version())<9)&&function n(){t||(/loaded|complete/.test(document.readyState)?(e.trigger(window),t=!0):setTimeout(n,100))}(),o.addEventListener(window,"load",r.mz)}(),t.EM=o},/*!********************!*\
  !*** ./src/ime.js ***!
  \********************/
function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=new function(){var e=this,t='<div id="VirtualKeyboardIME"><table><tr><td class="IMEControl"><div class="left"><!-- --></div></td><td class="IMEControl IMEContent"></td><td class="IMEControl"><div class="right"><!-- --></div></td></tr><tr><td class="IMEControl IMEInfo" colspan="3"><div class="showAll"><div class="IMEPageCounter"></div><div class="arrow"></div></div></td></tr></div>',n=null,r=0,o=!1,a=[],i=null,s=null;e.show=function(t){i=VirtualKeyboard.getAttachedInput();var r=DOM.getWindow(i);s!=r&&(n&&n.parentNode&&n.parentNode.removeChild(n),s=r,d(),s.document.body.appendChild(n)),n.className=e.css,t&&e.setSuggestions(t),i&&n&&a.length>0?(EM.addEventListener(i,"blur",e.blurHandler),n.style.display="block",e.updatePosition(i)):"none"!=n.style.display&&e.hide()},e.hide=function(t){n&&"none"!=n.style.display&&(n.style.display="none",EM.removeEventListener(i,"blur",e.blurHandler),i&&DocumentSelection.getSelection(i)&&!t&&DocumentSelection.deleteSelection(i),i=null,a=[])},e.updatePosition=function(){var e=DOM.getOffset(i);n.style.left=e.x+"px";var t=DocumentSelection.getSelectionOffset(i);n.style.top=e.y+t.y+t.h+"px"},e.setSuggestions=function(t){return!!isArray(t)&&(a=t,r=0,c(),void e.updatePosition(i))},e.getSuggestions=function(e){return isNumber(e)?a[e]:a},e.nextPage=function(e){r=Math.max(Math.min(r+1,Math.ceil(a.length/10)-1),0),c()},e.prevPage=function(e){r=Math.max(r-1,0),c()},e.getPage=function(){return r},e.getChar=function(t){return t=--t<0?9:t,a[10*e.getPage()+t]},e.isOpen=function(){return n&&"block"==n.style.display},e.blurHandler=function(t){e.hide()},e.toggleShowAll=function(e){var t=n.firstChild.rows[1].cells[0].lastChild;(o=!o)?(r=0,t.className="showPage"):t.className="showAll",c()};var c=function(){for(var e=["<table>"],t=0,i=Math.ceil(a.length/10);t<i;t++)if(o||t==r){e.push("<tr>");for(var s=0,c=10*t;s<10&&!isUndefined(a[c+s]);s++)e.push("<td><a href=''>"),t==r?e.push("<b>&nbsp;"+(s+1)%10+": </b>"):e.push("<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>"),e.push(a[c+s]+"</a></td>");e.push("</tr>")}e.push("</table>"),n.firstChild.rows[0].cells[1].innerHTML=e.join(""),n.firstChild.rows[1].cells[0].firstChild.firstChild.innerHTML=r+1+"/"+(0+o||Math.ceil(a.length/10));for(var l=n.getElementsByTagName("*"),s=0,d=l.length;s<d;s++)l[s].unselectable="on"},l=function(t){var n=DOM.getParent(t.target,"a");n&&(DocumentSelection.insertAtCursor(i,n.lastChild.nodeValue),e.hide()),t.preventDefault()},d=function(){var r=s.document.createElement("div");r.innerHTML=t,n=r.firstChild,n.style.display="none";var o=n.firstChild.rows[0].cells[0],a=n.firstChild.rows[0].cells[2],i=n.firstChild.rows[1].cells[0].lastChild;EM.addEventListener(o,"mousedown",e.prevPage),EM.addEventListener(o,"mousedown",EM.preventDefaultAction),EM.addEventListener(o,"mousedown",EM.stopPropagationAction),EM.addEventListener(a,"mousedown",e.nextPage),EM.addEventListener(a,"mousedown",EM.preventDefaultAction),EM.addEventListener(a,"mousedown",EM.stopPropagationAction),EM.addEventListener(i,"mousedown",e.toggleShowAll),EM.addEventListener(i,"mousedown",EM.preventDefaultAction),EM.addEventListener(i,"mousedown",EM.stopPropagationAction),n.unselectable="on";for(var c=n.getElementsByTagName("*"),d=0,u=c.length;d<u;d++)c[d].unselectable="on";EM.addEventListener(n,"mousedown",l)}};t.IME=n}]);