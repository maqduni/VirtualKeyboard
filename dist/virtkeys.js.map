{"version":3,"sources":["webpack:///webpack/bootstrap ab2cdeffe77157388a78","webpack:///./src/virtualkeyboard.js","webpack:///./src/extensions/helpers.js","webpack:///./src/extensions/ext/array.js","webpack:///./src/extensions/ext/object.js","webpack:///./src/extensions/ext/regexp.js","webpack:///./src/extensions/ext/string.js","webpack:///./src/extensions/documentselection.js","webpack:///./src/extensions/dom.js","webpack:///./src/extensions/eventmanager.js","webpack:///./src/ime.js"],"names":["VirtualKeyboard","self","$VERSION$","options","idPrefix","animate","controlKeys","KEY","keymap","keymaps","mode","VK_NORMAL","VK_SHIFT","VK_ALT","VK_CTRL","VK_CAPS","VK_CTRL_CAPS","VK_CTRL_SHIFT","VK_ALT_CAPS","VK_ALT_CTRL","VK_ALT_CTRL_CAPS","VK_ALT_SHIFT","VK_SHIFT_ALT_CTRL","VK_SHIFT_CAPS","VK_ALL","cssClasses","lang","layout","hash","codes","codeFilter","nodes","keyboard","desk","langbox","attachedInput","newKeyCode","addLayoutList","i","aL","arguments","length","addLayout","l","code","entityDecode","split","name","alpha","__doParse","normal","Error","domain","hasOwnProperty","toString","push","switchLayout","__buildOptionsList","IME","hide","selected","__prepareLayout","html","__getKeyboardHtml","innerHTML","className","css","__updateLayout","activate","__toggleInputDir","getLayouts","lts","lL","sort","setVisibleLayoutCodes","filter","cL","toUpperCase","value","getLayoutCodes","heapSort","_keyClicker_","key","evt","chr","ret","replace","CAPS","SHIFT","ALT","charProcessor","getSelection","deleteAtCursor","el","document","getElementById","__charProcessor","charCodeAt","contentDocument","ck","createEvent","initKeyEvent","contentWindow","ex","VK_bypass","dispatchEvent","keyCode","e","insertAtCursor","setRange","_keydownHandler_","isOpen","newMode","getKeyCode","type","prevPage","nextPage","childNodes","getRepeat","CSS","addClass","buttonDown","id","preventDefault","start","getStart","shiftKey","ctrlKey","altKey","srcElement","removeClass","stopPropagation","__updateControlKeys","_btnClick_","getParent","target","parentNode","indexOf","substring","hasClass","_btnMousedown_","_btnMouseInOut_","mtd","__toggleControlKeysState","CTRL","__toggleKeyState","toLowerCase","switchMapping","attachInput","detachInput","tagName","noanim","body","addEventListener","blurHandler","oe","removeEventListener","getAttachedInput","open","show","input","holder","kpTarget","nodeType","appendChild","close","removeChild","toggle","reset","rtl","dir","s","o","n","cc","sL","z","label","createElement","createTextNode","match","map","a","String","fromCharCodeExt","join","shift","alt","shift_alt","caps","shift_caps","dk","cbk","cs","ca","csa","csc","ics","ica","icsa","icc","icsc","lt","char_normal","char_alt","char_caps","char_shift","char","parseInt","fromCharCode","modeNormal","modeShift","modeAlt","modeShiftAlt","modeCaps","modeShiftCaps","modeShiftAltCaps","changes","state","prefix","s1","s2","getClass","hoverShift","hoverAlt","buttonHover","suffix","tchr","buf","res","dks","idx","charAt","inp","style","position","left","btns","title","buttonUp","__getCharHtmlForKey","charNormal","charShift","charAlt","charShiftAlt","charCaps","charShiftCaps","splice","lyt","deadkey","hiddenCaps","hiddenShift","hiddenShiftCaps","hiddenAlt","init","opts","_opts","console","log","unselectable","showKeyboardLayouts","showKeyboardMaps","firstChild","item","nextSibling","mapGroup","c","tk","kL","lastChild","preventDefaultAction","onmousedown","Langs","$","fn","virtkeys","jqObj","_open","_close","_toggle","_getLayoutCodes","_switchLayout","addLayouts","_addLayouts","getLoadedLayouts","_getLoadedLayouts","addIMELanguages","_addIMELanguages","get","layouts","_layouts","langs","undefined","_langs","jQuery","isUndefined","prop","isFunction","isString","isNumber","isNumeric","isNaN","isFinite","isArray","Array","isRegExp","RegExp","isBoolean","isScalar","isEmpty","Boolean","gluePath","findPath","sname","h","getElementsByTagName","sr","m","b","href","location","getScriptQuery","parseQuery","q","qL","rs","kv","rkv","unescape","table2array","ci","section","subsection","DOM","hasTagName","rows","span","ts","ce","rL","tr","cells","innerText","normalize","nodeValue","trim","tL","cd","createElementExt","tag","p","L","k","setAttribute","attachEvent","playInterval","f","setInterval","apply","call","playTimeout","setTimeout","cloneObject","obj","newObject","constructor","oL","mergeObject","oi","concat","unique","slice","loadStyleSheet","sn","hasStyleSheet","head","link","rel","path","test","prototype","copy","tmp","flatten","cols","binSearch","r","len","Math","max","ceil","cnt","sift","arr","low","up","maximal","range","end","inc","mn","min","mx","abs","reverse","Object","escape","text","sRE","specials","ltrim","rtrim","dup","val","valueOf","repeat","padding","pad","padLeft","padRight","sprintf","args","index","frmt","re","x","sign","ins","Number","bin","substr","round","dec","toExponential","toFixed","hex","DocumentSelection","keys","callMethod","arg","module","keepScroll","ot","ol","window","getSelectionOffset","y","scrollTop","clientHeight","scrollLeft","clientWidth","related","st","getEnd","getCursorPosition","keep","pos","wrapSelection","after","deleteSelection","getContext","offsetCalculator","getPos","r1","r2","r3","r4","r5","selectionStart","selectionEnd","setActive","selection","createRange","moveStart","moveEnd","createTextRange","moveToElementText","sTest","del","opera","setSelectionRange","collapse","select","doc","getWindow","prevCalcNode","defaultView","getComputedStyle","overflow","visibility","zIndex","top","backgroundColor","width","whiteSpace","getAttribute","border","offsetLeft","offsetTop","offsetHeight","boundingHeight","xy","getOffset","getBodyScrollTop","getBodyScrollLeft","s3","sel","anchorNode","so","anchorOffset","en","focusNode","eo","focusOffset","ss","es","sc","ec","cn","tw","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","rangeCount","getRangeAt","deleteContents","insertNode","addRange","ln","selectNodeContents","pn","replaceChild","extractContents","setStart","setStartAfter","removeAllRanges","cl","setEnd","move","off","contents","cloneContents","endOffset","borderLeft","surroundContents","offsetParent","selectNode","cp","vl","fixBrowserQuirks","height","originalObject","considerScroll","nodeName","clientLeft","clientTop","offsetWidth","getClientWidth","win","w","innerWidth","documentElement","getOffsetWidth","outerWidth","getClientHeight","innerHeight","getOffsetHeight","outerHeight","pageYOffset","pageXOffset","ownerDocument","parentWindow","pageX","pageY","de","clientX","clientY","tags","t","color2rgb","d","ov","vLink","err","setOpacity","opacity","KhtmOpacity","MozOpacity","cache","getClassValue","vals","currentStyle","EM","pool","UID","rootEventHandler","unifyEvent","hid","fe","currentTarget","UEID","handler","hL","message","unloadEventHandler","pid","node","rootEHCaller","detachEvent","EU","cur","cur1","getUEID","et","eid","registerEvent","EventTarget","__construct","stopPropagationAction","bubble","def","canBubble","defaultAction","trigger","data","undef","returnValue","cancelBubble","button","ac","executed","clearEvents","handlers","ie","mz","event","propertyName","navigator","userAgent","version","argumentsCalleeFixFn","readyState","ime","chars","page","showAll","sg","targetWindow","__createImeToolbar","setSuggestions","display","updatePosition","co","showPage","getSuggestions","getPage","getChar","toggleShowAll","sa","pL","els","eL","pasteSuggestion","arrl","arrr","arrd"],"mappings":"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","file":"virtkeys.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ab2cdeffe77157388a78","import { isUndefined, isFunction, isString, isNumber, isNumeric, isArray, isRegExp, isBoolean, isScalar, \r\n    isEmpty, mergeObject } from './extensions/helpers';\r\nimport './extensions/ext/array';\r\nimport './extensions/ext/object';\r\nimport './extensions/ext/regexp';\r\nimport './extensions/ext/string';\r\n\r\n\r\nimport { DocumentSelection } from './extensions/documentselection';\r\nimport { DOM } from './extensions/dom';\r\nimport { EM } from './extensions/eventmanager';\r\n\r\nimport { IME } from './ime';\r\n\r\n\r\nconst VirtualKeyboard = new function () {\r\n    var self = this;\r\n    self.$VERSION$ = \"3.6.1.585\";\r\n\r\n    \r\n    var options = {\r\n        'layout': null,\r\n        'showKeyboardMaps': true,\r\n        'showKeyboardLayouts': true\r\n    }\r\n    \r\n    var idPrefix = 'kb_b';\r\n    \r\n    var animate = true;\r\n    \r\n    var controlKeys = {\r\n        14: 'backspace'\r\n        , 15: 'tab'\r\n        , 28: 'enter'\r\n        , 29: 'caps'\r\n        , 41: 'shift_left'\r\n        , 52: 'shift_right'\r\n        , 53: 'del'\r\n        , 54: 'ctrl_left'\r\n        , 55: 'alt_left'\r\n        , 56: 'space'\r\n        , 57: 'alt_right'\r\n        , 58: 'ctrl_right'\r\n    };\r\n    \r\n    var KEY = {\r\n        'SHIFT': 'shift'\r\n        , 'ALT': 'alt'\r\n        , 'CTRL': 'ctrl'\r\n        , 'CAPS': 'caps'\r\n    }\r\n    \r\n    var keymap;\r\n\r\n    \r\n    var keymaps = {\r\n        'QWERTY Standard': \"À1234567890m=ÜQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾¿\"\r\n        , 'QWERTY Canadian': \"Þ1234567890m=ÜQWERTYUIOPÛÝASDFGHJKL;ÀZXCVBNM¼¾¿\"\r\n        , 'QWERTY Dutch': \"Þ1234567890Û¿ÜQWERTYUIOPÝ;ASDFGHJKL=ÀZXCVBNM¼¾m\"\r\n        , 'QWERTY Estonian': \"¿1234567890m=ÜQWERTYUIOPÞÛASDFGHJKL;ÀZXCVBNM¼¾Ý\"\r\n        , 'QWERTY Greek (220)': \"À1234567890¿ÛÜQWERTYUIOP=ÝASDFGHJKL;ÞZXCVBNM¼¾m\"\r\n        , 'QWERTY Greek (319)': \"À1234567890¿=ÜQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾m\"\r\n        , 'QWERTY Gujarati': \"À1234567890m=XQWERTYUIOPÛÝASDFGHJKL;ÜZXCVBNM¼¾¿\"\r\n        , 'QWERTY Italian': \"Ü1234567890ÛÝ¿QWERTYUIOP;=ASDFGHJKLÀÞZXCVBNM¼¾m\"\r\n        , 'QWERTY Kannada': \"À1234567890m=ZQWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¼¾¿\"\r\n        , 'QWERTY Portuguese': \"À1234567890ÛÝ¿QWERTYUIOP=;ASDFGHJKLÞÜZXCVBNM¼¾m\"\r\n        , 'QWERTY Scandinavian': \"Ü1234567890=Û¿QWERTYUIOPÝ;ASDFGHJKLÀÞZXCVBNM¼¾m\"\r\n        , 'QWERTY Spanish': \"Ü1234567890mÛ¿QWERTYUIOPÝ;ASDFGHJKLÀÞZXCVBNM¼¾ß\"\r\n        , 'QWERTY Tamil': \"À1234567890m =ZQWERTYUIOPÛÝASDFGHJKL;ÞCVBNM¼¾ ¿\"\r\n        , 'QWERTY Turkish': \"À1234567890ßm¼QWERTYUIOPÛÝASDFGHJKL;ÞZXCVBNM¿Ü¾\"\r\n        , 'QWERTY UK': \"ß1234567890m=ÞQWERTYUIOPÛÝASDFGHJKL;ÀZXCVBNM¼¾¿\"\r\n        , 'QWERTZ Albanian': \"À1234567890m=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾¿\"\r\n        , 'QWERTZ Bosnian': \"À1234567890¿=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m\"\r\n        , 'QWERTZ Czech': \"À1234567890=¿ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m\"\r\n        , 'QWERTZ German': \"Ü1234567890ÛÝ¿QWERTZUIOP;=ASDFGHJKLÀÞYXCVBNM¼¾m\"\r\n        , 'QWERTZ Hungarian': \"0123456789À¿=ÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m\"\r\n        , 'QWERTZ Slovak': \"À1234567890¿ßÜQWERTZUIOPÛÝASDFGHJKL;ÞYXCVBNM¼¾m\"\r\n        , 'QWERTZ Swiss': \"Ü1234567890ÛÝßQWERTZUIOP;ÞASDFGHJKLÀ¿YXCVBNM¼¾m\"\r\n        , 'AZERTY Belgian': \"Þ1234567890ÛmÜAZERTYUIOPÝ;QSDFGHJKLMÀWXCVBN¼¾¿=\"\r\n        , 'AZERTY French': \"Þ1234567890Û=ÜAZERTYUIOPÝ;QSDFGHJKLMÀWXCVBN¼¾¿ß\"\r\n        , ',WERTY Bulgarian': \"À1234567890m¾Ü¼WERTYUIOPÛÝASDFGHJKL;ÞZXCVBNMßQ¿\"\r\n        , 'QGJRMV Latvian': \"À1234567890mFÜQGJRMVNZWXYH;USILDATECÞÛBÝKPOß¼¾¿\"\r\n        , '/,.PYF UK-Dvorak': \"m1234567890ÛÝÜÀ¼¾PYFGCRL¿=AOEUIDHTNSÞ;QJKXBMWVZ\"\r\n        , 'FG;IOD Turkish F': \"À1234567890=mXFG;IODRNHPQWUÛEAÝTKMLYÞJÜVC¿ZSB¾¼\"\r\n        , ';QBYUR US-Dvorak': \"7ÛÝ¿PFMLJ4321Ü;QBYURSO¾65=mKCDTHEAZ8ÞÀXGVWNI¼09\"\r\n        , '56Q.OR US-Dvorak': \"m1234JLMFP¿ÛÝÜ56Q¾ORSUYB;=78ZAEHTDCKÞ90X¼INWVGÀ\"\r\n    }\r\n    \r\n    var mode = 0\r\n        , VK_NORMAL = 0\r\n        , VK_SHIFT = 1\r\n        , VK_ALT = 2\r\n        , VK_CTRL = 4\r\n        , VK_CAPS = 8\r\n        , VK_CTRL_CAPS = VK_CTRL | VK_CAPS\r\n        , VK_CTRL_SHIFT = VK_CTRL | VK_SHIFT\r\n        , VK_ALT_CAPS = VK_ALT | VK_CAPS\r\n        , VK_ALT_CTRL = VK_ALT | VK_CTRL\r\n        , VK_ALT_CTRL_CAPS = VK_ALT | VK_CTRL | VK_CAPS\r\n        , VK_ALT_SHIFT = VK_ALT | VK_SHIFT\r\n        , VK_SHIFT_ALT_CTRL = VK_SHIFT | VK_ALT | VK_CTRL\r\n        , VK_SHIFT_CAPS = VK_SHIFT | VK_CAPS\r\n        , VK_ALL = VK_SHIFT | VK_ALT | VK_CTRL | VK_CAPS;\r\n    \r\n    var cssClasses = {\r\n        'buttonUp': 'kbButton'\r\n        , 'buttonDown': 'kbButtonDown'\r\n        , 'buttonHover': 'kbButtonHover'\r\n        , 'hoverShift': 'hoverShift'\r\n        , 'hoverAlt': 'hoverAlt'\r\n        , 'modeAlt': 'modeAlt'\r\n        , 'modeAltCaps': 'modeAltCaps'\r\n        , 'modeCaps': 'modeCaps'\r\n        , 'modeNormal': 'modeNormal'\r\n        , 'modeShift': 'modeShift'\r\n        , 'modeShiftAlt': 'modeShiftAlt'\r\n        , 'modeShiftAltCaps': 'modeShiftAltCaps'\r\n        , 'modeShiftCaps': 'modeShiftCaps'\r\n        , 'charNormal': 'charNormal'\r\n        , 'charShift': 'charShift'\r\n        , 'charAlt': 'charAlt'\r\n        , 'charShiftAlt': 'charShiftAlt'\r\n        , 'charCaps': 'charCaps'\r\n        , 'charShiftCaps': 'charShiftCaps'\r\n        , 'hiddenAlt': 'hiddenAlt'\r\n        , 'hiddenCaps': 'hiddenCaps'\r\n        , 'hiddenShift': 'hiddenShift'\r\n        , 'hiddenShiftCaps': 'hiddenShiftCaps'\r\n        , 'deadkey': 'deadKey'\r\n        , 'noanim': 'VK_no_animate'\r\n\r\n    }\r\n    \r\n    var lang = null;\r\n    \r\n    var layout = []\r\n    \r\n    layout.hash = {};\r\n    \r\n    layout.codes = {};\r\n    \r\n    layout.codeFilter = null;\r\n    \r\n    layout.options = null;\r\n\r\n    \r\n    var nodes = {\r\n        keyboard: null    \r\n        , desk: null        \r\n        , langbox: null     \r\n        , attachedInput: null// Field, keyboard attached to\r\n    }\r\n    \r\n    var newKeyCode = null;\r\n\r\n    \r\n    \r\n    self.addLayoutList = function () {\r\n        for (var i = 0, aL = arguments.length; i < aL; i++) {\r\n            self.addLayout(arguments[i]);\r\n        }\r\n    }\r\n\r\n    \r\n    self.addLayout = function (l) {\r\n\r\n        var code = l.code.entityDecode().split(\"-\")\r\n            , name = l.name.entityDecode()\r\n            , alpha = __doParse(l.normal)\r\n\r\n        if (!isArray(alpha) || 47 != alpha.length) throw new Error('VirtualKeyboard requires \\'keys\\' property to be an array with 47 items, ' + alpha.length + ' detected. Layout code: ' + code + ', layout name: ' + name);\r\n\r\n        \r\n        l.code = (code[1] || code[0]);\r\n        l.name = name;\r\n        l.normal = alpha;\r\n        l.domain = code[0];\r\n\r\n        \r\n        if (layout.hash.hasOwnProperty(l.code + \" \" + l.name))\r\n            return;\r\n\r\n        \r\n        if (!layout.codes.hasOwnProperty(l.code))\r\n            layout.codes[l.code] = l.code;\r\n\r\n        \r\n        l.toString = function () { return this.code + \" \" + this.name };\r\n\r\n        layout.push(l);\r\n\r\n        \r\n        layout.options = null;\r\n    }\r\n    \r\n    self.switchLayout = function (code) {\r\n        \r\n        __buildOptionsList();\r\n\r\n        if (!layout.options.hasOwnProperty(code)) return false;\r\n\r\n        \r\n        self.IME.hide();\r\n\r\n        \r\n        nodes.langbox.options[layout.options[code]].selected = true;\r\n\r\n        lang = layout[layout.hash[code]];\r\n        if (!isArray(lang)) lang = layout[layout.hash[code]] = __prepareLayout(lang);\r\n\r\n        if (!isArray(lang)) {\r\n            lang = layout[layout.hash[code]] = __prepareLayout(lang);\r\n        }\r\n        if (!lang.html) {\r\n            lang.html = __getKeyboardHtml(lang);\r\n        }\r\n        \r\n        nodes.desk.innerHTML = lang.html;\r\n\r\n        \r\n        nodes.keyboard.className = lang.domain\r\n        self.IME.css = lang.domain\r\n\r\n        \r\n        mode = VK_NORMAL;\r\n        __updateLayout();\r\n        \r\n        if (isFunction(lang.activate)) {\r\n            lang.activate();\r\n        }\r\n        \r\n        __toggleInputDir();\r\n        \r\n       \r\n       \r\n        return true;\r\n    }\r\n\r\n    \r\n    self.getLayouts = function () {\r\n        var lts = [];\r\n        for (var i = 0, lL = layout.length; i < lL; i++) {\r\n            lts[lts.length] = [layout[i].code, layout[i].name];\r\n        }\r\n        return lts.sort();\r\n    }\r\n    \r\n    self.setVisibleLayoutCodes = function () {\r\n        var codes = isArray(arguments[0]) ? arguments[0] : arguments\r\n            , filter = null\r\n            , code\r\n\r\n        for (var i = 0, cL = codes.length; i < cL; i++) {\r\n            code = codes[i].toUpperCase();\r\n            if (!layout.codes.hasOwnProperty(code))\r\n                continue;\r\n            if (!filter)\r\n                filter = {}\r\n            filter[code] = code;\r\n        }\r\n        layout.codeFilter = filter;\r\n\r\n        \r\n        layout.options = null;\r\n\r\n        if (!self.switchLayout(nodes.langbox.value)) {\r\n            \r\n            self.switchLayout(nodes.langbox.value);\r\n        }\r\n    }\r\n    \r\n    self.getLayoutCodes = function () {\r\n        var codes = [];\r\n        for (var i in layout.codes) {\r\n            if (!layout.codes.hasOwnProperty(i))\r\n                continue;\r\n            codes.push(i);\r\n        }\r\n        return codes.heapSort();\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    var _keyClicker_ = function (key, evt) {\r\n        var chr = \"\"\r\n            , ret = false;\r\n        key = key.replace(idPrefix, \"\");\r\n        switch (key) {\r\n            case KEY.CAPS:\r\n            case KEY.SHIFT:\r\n            case \"shift_left\":\r\n            case \"shift_right\":\r\n            case KEY.ALT:\r\n            case \"alt_left\":\r\n            case \"alt_right\":\r\n                return true;\r\n            case 'backspace':\r\n                \r\n                if (isFunction(lang.charProcessor) && DocumentSelection.getSelection(nodes.attachedInput).length) {\r\n                    chr = \"\\x08\";\r\n                } else if (evt) {\r\n                    self.IME.hide(true);\r\n                    return true;\r\n                } else {\r\n                    DocumentSelection.deleteAtCursor(nodes.attachedInput, false);\r\n                    self.IME.hide(true);\r\n                }\r\n                break;\r\n            case 'del':\r\n                self.IME.hide(true);\r\n                if (evt)\r\n                    return true;\r\n                DocumentSelection.deleteAtCursor(nodes.attachedInput, true);\r\n                break;\r\n            case 'space':\r\n                chr = \" \";\r\n                break;\r\n            case 'tab':\r\n                chr = \"\\t\";\r\n                break;\r\n            case 'enter':\r\n                chr = \"\\n\";\r\n                break;\r\n            default:\r\n                var el = document.getElementById(idPrefix + key);\r\n                chr = lang[key][mode];\r\n                break;\r\n        }\r\n        if (chr) {\r\n            \r\n            if (!(chr = __charProcessor(chr, DocumentSelection.getSelection(nodes.attachedInput)))) return ret;\r\n            \r\n            try {\r\n                \r\n                if (chr[1] || chr[0].length > 1 || chr.charCodeAt(0) > 0x7fff || nodes.attachedInput.contentDocument || '\\t' == chr[0]) {\r\n                    throw new Error;\r\n                }\r\n                var ck = chr[0].charCodeAt(0);\r\n                \r\n                if (isFunction(document.createEvent)) {\r\n                    var evt = null;\r\n                    try {\r\n                        evt = document.createEvent(\"KeyEvents\");\r\n                        evt.initKeyEvent('keypress', false, true, nodes.attachedInput.contentWindow, false, false, false, false, 0, ck);\r\n                    } catch (ex) {\r\n                        \r\n                        evt = document.createEvent(\"KeyboardEvents\");\r\n                        evt.initKeyEvent('keypress', false, true, nodes.attachedInput.contentWindow, false, false, false, false, ck, 0);\r\n                    }\r\n                    evt.VK_bypass = true;\r\n                    nodes.attachedInput.dispatchEvent(evt);\r\n                } else {\r\n                    evt.keyCode = 10 == ck ? 13 : ck;\r\n                    ret = true;\r\n                }\r\n            } catch (e) {\r\n                DocumentSelection.insertAtCursor(nodes.attachedInput, chr[0]);\r\n                \r\n                if (chr[1]) {\r\n                    DocumentSelection.setRange(nodes.attachedInput, -chr[1], 0, true);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    \r\n    var _keydownHandler_ = function (e) {\r\n        \r\n        if (!self.isOpen()) return;\r\n        \r\n        var newMode = mode;\r\n        \r\n        var keyCode = e.getKeyCode();\r\n        switch (e.type) {\r\n            case 'keydown':\r\n                switch (keyCode) {\r\n                    case 37:\r\n                        if (self.IME.isOpen()) {\r\n                            self.IME.prevPage(e);\r\n                            return;\r\n                        }\r\n                        break;\r\n                    case 39:\r\n                        if (self.IME.isOpen()) {\r\n                            self.IME.nextPage(e);\r\n                            return;\r\n                        }\r\n                        break;\r\n                    case 8:\r\n                    case 9:\r\n                    case 46:\r\n                        var el = nodes.desk.childNodes[keymap[keyCode]];\r\n                        \r\n                        if (animate && !e.getRepeat()) DOM.CSS(el).addClass(cssClasses.buttonDown);\r\n                        if (!_keyClicker_(el.id, e)) e.preventDefault();\r\n\r\n                        break;\r\n                    case 20:\r\n                        if (!e.getRepeat()) {\r\n                            newMode = newMode ^ VK_CAPS;\r\n                        }\r\n                        break;\r\n                    case 27:\r\n                        if (self.IME.isOpen()) {\r\n                            self.IME.hide();\r\n                        } else {\r\n                            var start = DocumentSelection.getStart(nodes.attachedInput);\r\n                            DocumentSelection.setRange(nodes.attachedInput, start, start);\r\n                        }\r\n                        return false;\r\n                    default:\r\n                        if (!e.getRepeat()) {\r\n                            newMode = newMode | e.shiftKey | e.ctrlKey << 2 | e.altKey << 1;\r\n                        }\r\n                        if (keymap.hasOwnProperty(keyCode)) {\r\n                            if (!(e.altKey ^ e.ctrlKey)) {\r\n                                var el = nodes.desk.childNodes[keymap[keyCode]];\r\n                                if (animate) DOM.CSS(el).addClass(cssClasses.buttonDown);\r\n                                \r\n                                newKeyCode = el.id;\r\n                            }\r\n                            if (e.altKey && e.ctrlKey) {\r\n                                e.preventDefault();\r\n                                \r\n                                if (e.srcElement) {\r\n                                    _keyClicker_(nodes.desk.childNodes[keymap[keyCode]].id, e)\r\n                                    newKeyCode = \"\";\r\n                                }\r\n                            }\r\n                        } else {\r\n                            self.IME.hide();\r\n                        }\r\n                        break;\r\n                }\r\n                break;\r\n            case 'keyup':\r\n                switch (keyCode) {\r\n                    case 20:\r\n                        break;\r\n                    default:\r\n                        if (!e.getRepeat()) {\r\n                            newMode = mode & (VK_ALL ^ (!e.shiftKey | (!e.ctrlKey << 2) | (!e.altKey << 1)));\r\n                        }\r\n                        if (animate && keymap.hasOwnProperty(keyCode)) {\r\n                            DOM.CSS(nodes.desk.childNodes[keymap[keyCode]]).removeClass(cssClasses.buttonDown);\r\n                        }\r\n                }\r\n                break;\r\n            case 'keypress':\r\n                \r\n                if (newKeyCode && !e.VK_bypass) {\r\n                    if (!_keyClicker_(newKeyCode, e)) {\r\n                        e.stopPropagation();\r\n                        \r\n                        e.preventDefault();\r\n                    }\r\n                    \r\n                    newKeyCode = null;\r\n                }\r\n                if (!mode ^ VK_ALT_CTRL && (e.altKey || e.ctrlKey)) {\r\n                    self.IME.hide();\r\n                }\r\n                if (0 == keyCode && !newKeyCode && !e.VK_bypass \r\n                    && (!e.ctrlKey && !e.altKey && !e.shiftKey) \r\n                ) {\r\n                    e.preventDefault();\r\n                }\r\n        }\r\n        \r\n        if (newMode != mode) {\r\n            __updateControlKeys(newMode);\r\n            __updateLayout();\r\n        }\r\n    }\r\n    \r\n    var _btnClick_ = function (e) {\r\n        \r\n        var el = DOM.getParent(e.srcElement || e.target, 'a');\r\n        \r\n        if (!el || el.parentNode.id.indexOf(idPrefix) < 0) return;\r\n        el = el.parentNode;\r\n\r\n        switch (el.id.substring(idPrefix.length)) {\r\n            case \"caps\":\r\n            case \"shift_left\":\r\n            case \"shift_right\":\r\n            case \"alt_left\":\r\n            case \"alt_right\":\r\n            case \"ctrl_left\":\r\n            case \"ctrl_right\":\r\n                return;\r\n        }\r\n\r\n        if (DOM.CSS(el).hasClass(cssClasses.buttonDown) || !animate) {\r\n            _keyClicker_(el.id);\r\n        }\r\n        if (animate) {\r\n            DOM.CSS(el).removeClass(cssClasses.buttonDown)\r\n        }\r\n\r\n        var newMode = mode & (VK_CAPS | e.shiftKey | e.altKey << 1 | e.ctrlKey << 2);\r\n        if (mode != newMode) {\r\n            __updateControlKeys(newMode);\r\n            __updateLayout();\r\n        }\r\n\r\n    }\r\n    \r\n    var _btnMousedown_ = function (e) {\r\n        \r\n        var el = DOM.getParent(e.srcElement || e.target, 'a');\r\n        \r\n        if (!el || el.parentNode.id.indexOf(idPrefix) < 0) return;\r\n        el = el.parentNode;\r\n\r\n        var newMode = mode;\r\n\r\n        var key = el.id.substring(idPrefix.length);\r\n        switch (key) {\r\n            case \"caps\":\r\n                newMode = newMode ^ VK_CAPS;\r\n                break;\r\n            case \"shift_left\":\r\n            case \"shift_right\":\r\n                \r\n                if (e.shiftKey) break;\r\n                newMode = newMode ^ VK_SHIFT;\r\n                break;\r\n            case \"alt_left\":\r\n            case \"alt_right\":\r\n            case \"ctrl_left\":\r\n            case \"ctrl_right\":\r\n                newMode = newMode ^ (e.altKey << 1 ^ VK_ALT) ^ (e.ctrlKey << 2 ^ VK_CTRL);\r\n                break;\r\n            \r\n            default:\r\n                if (animate) DOM.CSS(el).addClass(cssClasses.buttonDown)\r\n                break;\r\n        }\r\n\r\n        if (mode != newMode) {\r\n            __updateControlKeys(newMode);\r\n            __updateLayout();\r\n        }\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    }\r\n    \r\n    var _btnMouseInOut_ = function (e) {\r\n        \r\n        var el = DOM.getParent(e.srcElement || e.target, 'a')\r\n            , mtd = { 'mouseover': 2, 'mouseout': 3 }\r\n        \r\n        if (!el || el.parentNode.id.indexOf(idPrefix) < 0) return;\r\n        el = el.parentNode;\r\n\r\n        \r\n        if (el.id.indexOf('shift') > -1) {\r\n            \r\n            __toggleControlKeysState(mtd[e.type], KEY.SHIFT);\r\n        } else if (el.id.indexOf('alt') > -1 || el.id.indexOf('ctrl') > -1) {\r\n            \r\n            __toggleControlKeysState(mtd[e.type], KEY.CTRL);\r\n            __toggleControlKeysState(mtd[e.type], KEY.ALT);\r\n        } else if (el.id.indexOf('caps') > -1) {\r\n            __toggleKeyState(mtd[e.type], null, el.id);\r\n        } else if (animate) {\r\n            __toggleKeyState(mtd[e.type], null, el.id);\r\n            if ('mouseout' == e.type.toLowerCase()) {\r\n                \r\n                __toggleKeyState(0, null, el.id);\r\n            }\r\n        }\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    }\r\n\r\n    \r\n    var switchMapping = function (e) {\r\n       \r\n        keymap = keymaps[e.target.value];\r\n    }\r\n    \r\n    \r\n    self.attachInput = function (el) {\r\n        \r\n        if (!el) return nodes.attachedInput;\r\n        if (isString(el)) el = document.getElementById(el);\r\n\r\n        if (el == nodes.attachedInput) return nodes.attachedInput;\r\n\r\n        \r\n        if (!self.switchLayout(options.layout) && !self.switchLayout(nodes.langbox.value)) {\r\n            \r\n            throw new Error('No layouts available');\r\n        }\r\n\r\n        \r\n        self.detachInput();\r\n\r\n        if (!el || !el.tagName) {\r\n            nodes.attachedInput = null;\r\n        } else {\r\n\r\n            \r\n            animate = !DOM.CSS(el).hasClass(cssClasses.noanim);\r\n            \r\n            nodes.attachedInput = el;\r\n            \r\n            __toggleInputDir();\r\n            if (el.contentWindow) {\r\n                el = el.contentWindow.document.body.parentNode;\r\n            }\r\n            EM.addEventListener(el, 'keydown', _keydownHandler_);\r\n            EM.addEventListener(el, 'keyup', _keydownHandler_);\r\n            EM.addEventListener(el, 'keypress', _keydownHandler_);\r\n            EM.addEventListener(el, 'mousedown', self.IME.blurHandler);\r\n        }\r\n        return nodes.attachedInput;\r\n    }\r\n\r\n    \r\n    self.detachInput = function () {\r\n        if (!nodes.attachedInput) return false;\r\n        \r\n        __toggleInputDir(true);\r\n        \r\n        self.IME.hide();\r\n        \r\n        if (nodes.attachedInput) {\r\n            var oe = nodes.attachedInput\r\n            if (oe.contentWindow) {\r\n                oe = oe.contentWindow.document.body.parentNode\r\n            }\r\n            EM.removeEventListener(oe, 'keydown', _keydownHandler_);\r\n            EM.removeEventListener(oe, 'keypress', _keydownHandler_);\r\n            EM.removeEventListener(oe, 'keyup', _keydownHandler_);\r\n            EM.removeEventListener(oe, 'mousedown', self.IME.blurHandler);\r\n        }\r\n        nodes.attachedInput = null;\r\n        return true;\r\n    }\r\n\r\n    \r\n    self.getAttachedInput = function (el) {\r\n        return nodes.attachedInput;\r\n    }\r\n    \r\n    self.open =\r\n        self.show = function (input, holder, kpTarget) {\r\n            if (!(input = self.attachInput(nodes.attachedInput || input)) || !nodes.keyboard || !document.body) return false;\r\n\r\n            \r\n            if (!nodes.keyboard.parentNode || nodes.keyboard.parentNode.nodeType == 11) {\r\n                if (isString(holder)) holder = document.getElementById(holder);\r\n                if (!holder.appendChild) return false;\r\n                holder.appendChild(nodes.keyboard);\r\n                \r\n                if (!isUndefined(kpTarget) && input != kpTarget && kpTarget.appendChild) {\r\n                    EM.addEventListener(kpTarget, 'keydown', _keydownHandler_);\r\n                    EM.addEventListener(kpTarget, 'keyup', _keydownHandler_);\r\n                    EM.addEventListener(kpTarget, 'keypress', _keydownHandler_);\r\n                }\r\n            }\r\n\r\n            return true;\r\n        }\r\n    \r\n    self.close =\r\n        self.hide = function () {\r\n            if (!nodes.keyboard || !self.isOpen()) return false;\r\n            self.detachInput();\r\n            nodes.keyboard.parentNode.removeChild(nodes.keyboard);\r\n            return true;\r\n        }\r\n    \r\n    self.toggle = function (input, holder, kpTarget) {\r\n        self.isOpen() ? self.close() : self.show(input, holder, kpTarget);\r\n    }\r\n    \r\n    self.isOpen = function ()  {\r\n        return (!!nodes.keyboard.parentNode) && nodes.keyboard.parentNode.nodeType == 1;\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    var __toggleInputDir = function (reset) {\r\n        if (nodes.attachedInput) {\r\n            var mode = reset ? \"\"\r\n                : (lang.rtl ? 'rtl'\r\n                    : 'ltr');\r\n            if (nodes.attachedInput.contentWindow)\r\n                nodes.attachedInput.contentWindow.document.body.dir = mode;\r\n            else\r\n                nodes.attachedInput.dir = mode;\r\n        }\r\n    }\r\n\r\n    \r\n    var __buildOptionsList = function () {\r\n        if (null != layout.options)\r\n            return;\r\n\r\n        var s = layout.heapSort()\r\n            , l, o, n\r\n            , cc = {};\r\n        layout.options = {};\r\n\r\n        nodes.langbox.innerHTML = \"\";\r\n        for (var i = 0, sL = s.length, z = 0; i < sL; i++) {\r\n            l = layout[i];\r\n            n = l.code + \" \" + l.name;\r\n            layout.hash[n] = i;\r\n\r\n            if (layout.codeFilter && !layout.codeFilter.hasOwnProperty(l.code))\r\n                continue;\r\n\r\n            if (cc.label != l.code) {\r\n                cc = document.createElement('optgroup');\r\n                cc.label = l.code;\r\n                nodes.langbox.appendChild(cc);\r\n            }\r\n            o = document.createElement('option');\r\n            o.value = n;\r\n            o.appendChild(document.createTextNode(l.name));\r\n            o.label = l.name;\r\n            cc.appendChild(o);\r\n            \r\n            layout.options[n] = z++;\r\n        }\r\n    }\r\n    \r\n    var __doParse = function (s) {\r\n        if (isString(s))\r\n            return s.match(/\\x01.+?\\x01|[\\ud800-\\udbff][\\udc00-\\udfff]|./g).map(function (a) { return a.replace(/[\\x01\\x02]/g, \"\") });\r\n        else\r\n            return s.map(function (a) { return isArray(a) ? a.map(function (s) { String.fromCharCodeExt(s) }).join(\"\") : String.fromCharCodeExt(a).replace(/[\\x01\\x02]/g, \"\") });\r\n    }\r\n    \r\n    var __prepareLayout = function (l) {\r\n        \r\n        var alpha = l.normal\r\n            , shift = l.shift || {}\r\n            , alt = l.alt || {}\r\n            , shift_alt = l.shift_alt || {}\r\n            , caps = l.caps || {}\r\n            , shift_caps = l.shift_caps || {}\r\n            , dk = l.dk\r\n            , cbk = l.cbk\r\n            , cs, ca, csa, cc, csc = null\r\n            , ics, ica, icsa, icc, icsc = -1\r\n            , lt = []\r\n\r\n        lt.name = l.name;\r\n        lt.code = l.code;\r\n        lt.toString = l.toString;\r\n\r\n        for (var i = 0, aL = alpha.length; i < aL; i++) {\r\n            var char_normal = alpha[i]\r\n                , char_alt = null\r\n                , char_caps = null\r\n                , char_shift = null\r\n                , char = [char_normal]\r\n\r\n            if (shift.hasOwnProperty(i)) {\r\n                cs = __doParse(shift[i]);\r\n                ics = i;\r\n            }\r\n            if (ics > -1 && cs[i - ics]) {\r\n                char_shift = cs[i - ics];\r\n                char[VK_SHIFT] = char_shift;\r\n            } else if (char_normal && char_normal != (char_normal = char_normal.toUpperCase())) {\r\n                char[VK_SHIFT] = char_normal;\r\n                char_shift = char_normal;\r\n            }\r\n\r\n            if (alt.hasOwnProperty(i)) {\r\n                ca = __doParse(alt[i]);\r\n                ica = i;\r\n            }\r\n            if (ica > -1 && ca[i - ica]) {\r\n                char_alt = ca[i - ica];\r\n                char[VK_ALT_CTRL] = char_alt;\r\n            }\r\n\r\n            if (shift_alt.hasOwnProperty(i)) {\r\n                csa = __doParse(shift_alt[i]);\r\n                icsa = i;\r\n            }\r\n            if (icsa > -1 && csa[i - icsa]) {\r\n                char[VK_SHIFT_ALT_CTRL] = csa[i - icsa];\r\n            } else if (char_alt && char_alt != (char_alt = char_alt.toUpperCase())) {\r\n                char[VK_SHIFT_ALT_CTRL] = char_alt;\r\n            }\r\n\r\n            if (caps.hasOwnProperty(i)) {\r\n                cc = __doParse(caps[i]);\r\n                icc = i;\r\n            }\r\n            if (icc > -1 && cc[i - icc]) {\r\n                char_caps = cc[i - icc];\r\n            }\r\n            if (char_caps) {\r\n                char[VK_CAPS] = char_caps;\r\n            } else if (char_shift && char_shift.toUpperCase() != char_shift.toLowerCase()) {\r\n                char[VK_CAPS] = char_shift;\r\n            } else if (char_normal) {\r\n                char[VK_CAPS] = char_normal.toUpperCase();\r\n            }\r\n\r\n            if (shift_caps.hasOwnProperty(i)) {\r\n                csc = __doParse(shift_caps[i]);\r\n                icsc = i;\r\n            }\r\n            if (icsc > -1 && csc[i - icsc]) {\r\n                char[VK_SHIFT_CAPS] = csc[i - icsc];\r\n            } else if (char_shift) {\r\n                char[VK_SHIFT_CAPS] = char_shift.toLowerCase();\r\n            } else if (char_normal) {\r\n                char[VK_SHIFT_CAPS] = char_normal;\r\n            }\r\n\r\n            lt[i] = char;\r\n        }\r\n\r\n        if (dk) {\r\n            lt.dk = {};\r\n            for (var i in dk) {\r\n                if (dk.hasOwnProperty(i)) {\r\n                    var key = i;\r\n                    if (parseInt(i) && i > 9) {\r\n                        key = String.fromCharCode(i);\r\n                    }\r\n                    \r\n                    lt.dk[key] = __doParse(dk[i]).join(\"\").replace(key, key + key);\r\n                }\r\n            }\r\n        }\r\n\r\n        \r\n        lt.rtl = !!lt.join(\"\").match(/[\\u05b0-\\u06ff]/)\r\n\r\n        \r\n        lt.domain = l.domain\r\n\r\n        \r\n        if (isFunction(cbk)) {\r\n            lt.charProcessor = cbk\r\n        } else if (cbk) {\r\n            lt.activate = cbk.activate;\r\n            lt.charProcessor = cbk.charProcessor;\r\n        }\r\n        return lt;\r\n    }\r\n    \r\n    var __updateLayout = function () {\r\n        var ca = [];\r\n        ca[VK_NORMAL] = cssClasses.modeNormal;\r\n        ca[VK_SHIFT] = cssClasses.modeShift;\r\n        ca[VK_ALT_CTRL] = cssClasses.modeAlt;\r\n        ca[VK_SHIFT_ALT_CTRL] = cssClasses.modeShiftAlt;\r\n        ca[VK_CAPS] = cssClasses.modeCaps;\r\n        ca[VK_SHIFT_CAPS] = cssClasses.modeShiftCaps;\r\n       \r\n        ca[VK_ALT] = cssClasses.modeNormal;\r\n        ca[VK_CTRL] = cssClasses.modeNormal;\r\n        ca[VK_ALT_SHIFT] = cssClasses.modeShift;\r\n        ca[VK_CTRL_SHIFT] = cssClasses.modeShift;\r\n        ca[VK_ALT_CAPS] = cssClasses.modeCaps;\r\n        ca[VK_CTRL_CAPS] = cssClasses.modeCaps;\r\n       \r\n        ca[VK_ALT_CTRL_CAPS] = cssClasses.modeShiftAltCaps;\r\n        ca[VK_ALL] = cssClasses.modeShiftAltCaps;\r\n\r\n        DOM.CSS(nodes.desk).removeClass(ca).addClass(ca[mode]);\r\n    }\r\n    \r\n    var __updateControlKeys = function (newMode) {\r\n        \r\n        var changes = mode ^ newMode;\r\n        if (changes & VK_SHIFT) {\r\n            __toggleControlKeysState(!!(newMode & VK_SHIFT), KEY.SHIFT);\r\n        }\r\n        if (changes & VK_ALT) {\r\n            __toggleControlKeysState(!!(newMode & VK_ALT), KEY.ALT);\r\n        }\r\n        if (changes & VK_CTRL) {\r\n            __toggleControlKeysState(!!(newMode & VK_CTRL), KEY.CTRL);\r\n        }\r\n        if (changes & VK_CAPS) {\r\n            __toggleKeyState(!!(newMode & VK_CAPS), KEY.CAPS);\r\n        }\r\n        mode = newMode;\r\n    }\r\n    \r\n    var __toggleControlKeysState = function (state, prefix) {\r\n        var s1 = document.getElementById(idPrefix + prefix + '_left')\r\n            , s2 = document.getElementById(idPrefix + prefix + '_right');\r\n        switch (0 + state) {\r\n            case 0:\r\n                s1.className = DOM.CSS(s2).removeClass(cssClasses.buttonDown).getClass();\r\n                break;\r\n            case 1:\r\n                DOM.CSS(nodes.desk).removeClass([cssClasses.hoverShift, cssClasses.hoverAlt]);\r\n                s1.className = DOM.CSS(s2).addClass(cssClasses.buttonDown).getClass();\r\n                break;\r\n            case 2:\r\n                if (KEY.SHIFT == prefix && mode & VK_SHIFT ^ VK_SHIFT) {\r\n                    DOM.CSS(nodes.desk).addClass(cssClasses.hoverShift);\r\n                } else if (KEY.ALT == prefix && mode ^ VK_ALT_CTRL) {\r\n                    DOM.CSS(nodes.desk).addClass(cssClasses.hoverAlt);\r\n                }\r\n                s1.className = DOM.CSS(s2).addClass(cssClasses.buttonHover).getClass();\r\n                break;\r\n            case 3:\r\n                if (KEY.SHIFT == prefix) {\r\n                    DOM.CSS(nodes.desk).removeClass(cssClasses.hoverShift);\r\n                } else if (KEY.ALT == prefix) {\r\n                    DOM.CSS(nodes.desk).removeClass(cssClasses.hoverAlt);\r\n                }\r\n                s1.className = DOM.CSS(s2).removeClass(cssClasses.buttonHover).getClass();\r\n                break;\r\n        }\r\n    }\r\n    \r\n    var __toggleKeyState = function (state, suffix, name) {\r\n        var s = document.getElementById(suffix ? idPrefix + suffix\r\n            : name);\r\n        if (s) {\r\n            switch (0 + state) {\r\n                case 0:\r\n                    DOM.CSS(s).removeClass(cssClasses.buttonDown);\r\n                    break;\r\n                case 1:\r\n                    DOM.CSS(s).addClass(cssClasses.buttonDown);\r\n                    break;\r\n                case 2:\r\n                    DOM.CSS(s).addClass(cssClasses.buttonHover);\r\n                    break;\r\n                case 3:\r\n                    DOM.CSS(s).removeClass(cssClasses.buttonHover);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    \r\n    var __charProcessor = function (tchr, buf) {\r\n        var res = [tchr, 0];\r\n        if (isFunction(lang.charProcessor)) {\r\n            \r\n            res = lang.charProcessor(tchr, buf);\r\n        } else if (tchr == \"\\x08\") {\r\n            res = ['', 0];\r\n        } else if (lang.dk && buf.length <= 1) {\r\n            \r\n            if (lang.dk.hasOwnProperty(buf)) {\r\n                \r\n                res[1] = 0;\r\n                var dks = lang.dk[buf],\r\n                idx = dks.indexOf(tchr) + 1;\r\n                res[0] = idx ? dks.charAt(idx)\r\n                    : tchr;\r\n            } else if (lang.dk.hasOwnProperty(tchr)) {\r\n                \r\n                res[1] = 1;\r\n                res[0] = tchr;\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n    \r\n    var __getKeyboardHtml = function (lang) {\r\n        var inp = document.createElement('span');\r\n        \r\n        document.body.appendChild(inp);\r\n        inp.style.position = 'absolute';\r\n        inp.style.left = '-1000px';\r\n\r\n        for (var i = 0, aL = lang.length, btns = [], chr, title; i < aL; i++) {\r\n            chr = lang[i];\r\n            btns.push([\"<div id='\", idPrefix, i\r\n                , \"' class='\", cssClasses.buttonUp\r\n                , \"'><a>\", __getCharHtmlForKey(lang, chr, VK_NORMAL, cssClasses.charNormal, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_SHIFT, cssClasses.charShift, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_ALT_CTRL, cssClasses.charAlt, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_SHIFT_ALT_CTRL, cssClasses.charShiftAlt, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_CAPS, cssClasses.charCaps, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_SHIFT_CAPS, cssClasses.charShiftCaps, inp)\r\n                , \"</a></div>\"].join(\"\"));\r\n\r\n        }\r\n        for (var i in controlKeys) {\r\n            if (controlKeys.hasOwnProperty(i)) {\r\n                chr = controlKeys[i];\r\n                title = chr.replace(/_.+/, '');\r\n                btns.splice(i, 0, [\"<div id='\", idPrefix, chr\r\n                    , \"' class='\", cssClasses.buttonUp\r\n                    , \"'><a title='\", title, \"'\"\r\n                    , \"><span class='title'>\", title, \"</span>\"\r\n                    , \"</a></div>\"].join(\"\"));\r\n            }\r\n        }\r\n        document.body.removeChild(inp);\r\n        return btns.join(\"\").replace(/(<\\w+)/g, \"$1 unselectable='on' \");\r\n    }\r\n    \r\n    var __getCharHtmlForKey = function (lyt, chr, mode, css, inp) {\r\n        var html = []\r\n            , dk = lyt.dk && lyt.dk.hasOwnProperty(chr[mode])\r\n            , char = chr[mode] || \"\"\r\n\r\n        \r\n        if (dk) css += \" \" + cssClasses.deadkey;\r\n\r\n        \r\n        if ((mode == VK_SHIFT_CAPS && chr[VK_CAPS] && char.toLowerCase() == chr[VK_CAPS].toLowerCase())\r\n            || (mode == VK_CAPS && chr[VK_SHIFT_CAPS] && char.toLowerCase() == chr[VK_SHIFT_CAPS].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenCaps;\r\n        }\r\n        if ((mode == VK_SHIFT && chr[VK_NORMAL] && char.toLowerCase() == chr[VK_NORMAL].toLowerCase())\r\n            || (mode == VK_NORMAL && chr[VK_SHIFT] && char.toLowerCase() == chr[VK_SHIFT].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenShift;\r\n        }\r\n        if ((mode == VK_SHIFT && chr[VK_SHIFT_CAPS] && char.toLowerCase() == chr[VK_SHIFT_CAPS].toLowerCase())\r\n            || (mode == VK_SHIFT_CAPS && chr[VK_SHIFT] && char.toLowerCase() == chr[VK_SHIFT].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenShiftCaps;\r\n        }\r\n        if ((mode == VK_CAPS && chr[VK_NORMAL] && char.toLowerCase() == chr[VK_NORMAL].toLowerCase())\r\n            || (mode == VK_NORMAL && chr[VK_CAPS] && char.toLowerCase() == chr[VK_CAPS].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenCaps;\r\n        }\r\n        if ((mode == VK_SHIFT_ALT_CTRL && chr[VK_ALT_CTRL] && char.toLowerCase() == chr[VK_ALT_CTRL].toLowerCase())\r\n            || (mode == VK_ALT_CTRL && chr[VK_SHIFT] && char.toLowerCase() == chr[VK_SHIFT].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenAlt;\r\n        }\r\n\r\n        html.push(\"<span\");\r\n        if (css) {\r\n            html.push(\" class=\\\"\" + css + \"\\\"\");\r\n        }\r\n        html.push(\" >\\xa0\" + char + \"\\xa0</span>\");\r\n        return html.join(\"\");\r\n    }\r\n\r\n    \r\n    self.init = function(opts) {\r\n        var _opts = mergeObject(options, opts);\r\n        console.log(_opts);\r\n\r\n        \r\n        nodes.keyboard = document.createElement('div');\r\n        nodes.keyboard.unselectable = \"on\";\r\n        nodes.keyboard.id = 'virtualKeyboard';\r\n        nodes.keyboard.innerHTML = ('<div id=\\\"kbDesk\\\"><!-- --></div>'\r\n            + '<select id=\\\"kb_langselector\\\" ' + (_opts.showKeyboardLayouts ? '' : 'style=\\\"display: none;\\\"') + '></select>'\r\n            + '<select id=\\\"kb_mappingselector\\\" ' + (_opts.showKeyboardMaps ? '' : 'style=\\\"display: none;\\\"') + '></select>'\r\n           \r\n        ).replace(/(<\\w+)/g, \"$1 unselectable='on' \");\r\n\r\n        nodes.desk = nodes.keyboard.firstChild;\r\n\r\n        var el = nodes.keyboard.childNodes.item(1);\r\n        EM.addEventListener(el, 'change', function (e) { self.switchLayout(this.value) });\r\n        nodes.langbox = el;\r\n\r\n        var el = el.nextSibling\r\n            , mapGroup = \"\";\r\n\r\n       \r\n       \r\n\r\n        if (!keymaps.hasOwnProperty(keymap))\r\n            keymap = 'QWERTY Standard';\r\n\r\n        for (var i in keymaps) {\r\n            var map = keymaps[i].split(\"\").map(function (c) { return c.charCodeAt(0) });\r\n            \r\n            map.splice(14, 0, 8, 9);\r\n            map.splice(28, 0, 13, 20);\r\n            map.splice(41, 0, 16);\r\n            map.splice(52, 0, 16, 46, 17, 18, 32, 18, 17);\r\n            \r\n            var tk = map;\r\n            map = [];\r\n            for (var z = 0, kL = tk.length; z < kL; z++) {\r\n                map[tk[z]] = z;\r\n            }\r\n            keymaps[i] = map;\r\n\r\n            \r\n            tk = i.split(\" \", 2);\r\n            if (mapGroup.indexOf(mapGroup = tk[0]) != 0) {\r\n                el.appendChild(document.createElement('optgroup'))\r\n                el.lastChild.label = mapGroup;\r\n            }\r\n            map = document.createElement('option');\r\n            el.lastChild.appendChild(map);\r\n            map.value = i;\r\n            map.innerHTML = tk[1];\r\n            map.selected = (i == keymap);\r\n        }\r\n        keymap = keymaps[keymap];\r\n        EM.addEventListener(el, 'change', switchMapping);\r\n\r\n        \r\n        EM.addEventListener(nodes.desk, 'mousedown', _btnMousedown_);\r\n        EM.addEventListener(nodes.desk, 'mouseup', _btnClick_);\r\n        EM.addEventListener(nodes.desk, 'mouseover', _btnMouseInOut_);\r\n        EM.addEventListener(nodes.desk, 'mouseout', _btnMouseInOut_);\r\n        EM.addEventListener(nodes.desk, 'click', EM.preventDefaultAction);\r\n\r\n        \r\n        nodes.keyboard.onmousedown = function (e) { if (!e || !e.target.tagName || 'select' != e.target.tagName.toLowerCase()) return false }\r\n\r\n        \r\n       \r\n       \r\n        options.layout = _opts.layout;\r\n    }\r\n}\r\n\r\nVirtualKeyboard.Langs = {};\r\n\r\nVirtualKeyboard.IME = IME;\r\n\r\n\r\n(function ($) {\r\n    $.fn.virtkeys = function (opts) {\r\n        var jqObj = this;\r\n\r\n        (function () {\r\n            VirtualKeyboard.init(opts || {});\r\n        \r\n            jqObj.VirtualKeyboard = VirtualKeyboard;\r\n            \r\n            jqObj.open = _open;\r\n            jqObj.close = _close;\r\n            jqObj.toggle = _toggle;\r\n\r\n            jqObj.getLayoutCodes = _getLayoutCodes;\r\n            jqObj.switchLayout = _switchLayout;\r\n            jqObj.addLayouts = _addLayouts;\r\n            jqObj.getLoadedLayouts = _getLoadedLayouts;\r\n\r\n            jqObj.addIMELanguages = _addIMELanguages;\r\n        })();\r\n\r\n\r\n        function _open (input) {\r\n            VirtualKeyboard.open(input instanceof $ ? input.get(0) : input, this.get(0));\r\n        }\r\n\r\n        function _close () {\r\n            VirtualKeyboard.close();\r\n        }\r\n\r\n        function _toggle (input) {\r\n            VirtualKeyboard.toggle(input instanceof $ ? input.get(0) : input, this.get(0));\r\n        }\r\n\r\n       \r\n        function _getLayoutCodes() {\r\n            return VirtualKeyboard.getLayoutCodes();\r\n        }\r\n\r\n        function _switchLayout(code) {\r\n            return VirtualKeyboard.switchLayout(code);\r\n        }\r\n\r\n        function _addLayouts(layouts) {\r\n            for (var i = 0, aL = layouts.length; i < aL; i++) {\r\n                VirtualKeyboard.addLayout(layouts[i]);\r\n            }\r\n        }\r\n\r\n        function _getLoadedLayouts() {\r\n            return $.fn.virtkeys._layouts;\r\n        }\r\n\r\n        function _addIMELanguages(langs) {\r\n            if (langs === undefined && (langs = $.fn.virtkeys._langs) === undefined)\r\n                throw 'Object containing IME languages cannot be found.';\r\n\r\n            VirtualKeyboard.Langs = langs;\r\n        }\r\n\r\n        return jqObj;\r\n    };\r\n\r\n    $.fn.virtkeys._layouts = {};\r\n} (jQuery));\n\n\n// WEBPACK FOOTER //\n// ./src/virtualkeyboard.js","\r\n\r\n\r\n\r\n\r\nfunction isUndefined(prop )  {\r\n    return (typeof prop == 'undefined');\r\n}\r\n\r\nfunction isFunction(prop )  {\r\n    return (typeof prop == 'function');\r\n}\r\n\r\nfunction isString(prop )  {\r\n    return (typeof prop == 'string');\r\n}\r\n\r\nfunction isNumber(prop )  {\r\n    return (typeof prop == 'number');\r\n}\r\n\r\nfunction isNumeric(prop )  {\r\n    return (isNumber(prop) || isString(prop)) && !isNaN(parseInt(prop)) && isFinite(parseInt(prop));\r\n}\r\n\r\nfunction isArray(prop )  {\r\n    return (prop instanceof Array);\r\n}\r\n\r\nfunction isRegExp(prop )  {\r\n    return (prop instanceof RegExp);\r\n}\r\n\r\nfunction isBoolean(prop )  {\r\n    return ('boolean' == typeof prop);\r\n}\r\n\r\nfunction isScalar(prop )  {\r\n    return isNumeric(prop) || isString(prop) || isBoolean(prop);\r\n}\r\n\r\nfunction isEmpty(prop )  {\r\n    if (isBoolean(prop)) return false;\r\n    if (isRegExp(prop) && new RegExp(\"\").toString() == prop.toString()) return true;\r\n    if (isString(prop) || isNumber(prop)) return !prop;\r\n    if (Boolean(prop) && false != prop) {\r\n        for (var i in prop) if (prop.hasOwnProperty(i)) return false\r\n    }\r\n    return true;\r\n}\r\n\r\n\r\n\r\n\r\nfunction gluePath()  {\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n    throw 'Commented out because of UglifyJsPlugin and RemoveCommentsLoader';\r\n}\r\n\r\n\r\nfunction findPath(sname )  {\r\n    var h = document.getElementsByTagName('html')[0].innerHTML\r\n        , sr = new RegExp('<scr' + 'ipt[^>]+?src\\s*=\\s*[\"\\']?([^>]+?/)' + sname + '[^>]*>.?</scr' + 'ipt>', 'i')\r\n        , m = h.match(sr);\r\n    if (m) {\r\n        \r\n        if (m[1].match(/^((https?|file)\\:\\/{2,}|\\w:[\\\\])/)) return m[1];\r\n        \r\n        if (m[1].indexOf(\"/\") == 0) return m[1];\r\n        b = document.getElementsByTagName('base');\r\n        if (b[0] && b[0].href) return b[0].href + m[1];\r\n        \r\n        return (document.location.href.match(/(.*[\\/\\\\])/)[0] + m[1]).replace(/^\\/+/, \"\");\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction getScriptQuery(sname) {\r\n    var h = document.getElementsByTagName('html')[0].innerHTML\r\n        , sr = new RegExp('<scr' + 'ipt[^>]+?src\\s*[^>]+?/' + sname + '([^#\"\\']*).+?</scr' + 'ipt>', 'i')\r\n        , m = h.match(sr);\r\n    if (m) return parseQuery(m[1].replace(/^[^?]*\\?([^#]+)/, \"$1\"));\r\n    return {};\r\n}\r\n\r\nfunction parseQuery(q) {\r\n    if ('string' != typeof q || q.length < 2) return {};\r\n    q = q.split(/&amp;|&/g);\r\n    for (var z = 0, qL = q.length, rs = {}, kv, rkv; z < qL; z++) {\r\n        kv = q[z].split(\"=\");\r\n        \r\n        kv[0] = kv[0].replace(/[{}\\[\\]]*$/, \"\");\r\n        rkv = rs[kv[0]];\r\n        \r\n        kv[1] = unescape(kv[1] ? kv[1].replace(\"+\", \" \") : \"\");\r\n        if (rkv)\r\n            if ('array' == typeof (rkv)) rs[kv[0]][rs[kv[0]].length] = kv[1];\r\n            else rs[kv[0]] = [rs[kv[0]], kv[1]];\r\n        else rs[kv[0]] = kv[1];\r\n    }\r\n    return rs\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction table2array(id, ci, section, subsection) {\r\n    if (isString(id)) id = document.getElementById(id);\r\n    if (!id || !DOM.hasTagName(id, ['table', 'tbody,', 'thead', 'tfoot'])) return null;\r\n    if (!isEmpty(section) && (!isString(section) || !(id = id.getElementsByTagName(section)))) return null;\r\n    if (!isEmpty(subsection) && (!isNumber(subsection) || subsection < 0 || !(id = id[subsection]))) return null;\r\n\r\n    if (isUndefined(id.rows)) return null;\r\n    var res = []\r\n        , span = document.createElement('span')\r\n        , ts = null\r\n        , ce = null\r\n    for (var i = 0, rL = id.rows.length; i < rL; i++) {\r\n        var tr = [];\r\n        if (isArray(ci)) {\r\n            for (var z = 0, cL = ci.length; z < cL; z++) {\r\n                ce = id.rows[i].cells[ci[z]];\r\n                if (ce) {\r\n                    span.innerHTML = ce.innerText ? ce.innerText : ce.innerHTML.replace(/<script\\s+(.|\\r?\\n)*?<\\/script>|<[^>]*>/g, \"\");\r\n                    span.normalize();\r\n                    tr[tr.length] = span.firstChild ? span.firstChild.nodeValue.trim(\" \\xA0\") : \"\";\r\n                } else {\r\n                    tr[tr.length] = \"\";\r\n                }\r\n            }\r\n        } else {\r\n            for (var z = 0, tL = id.rows[i].cells.length; z < tL; z++) {\r\n                cd = id.rows[i].cells[z];\r\n                span.innerHTML = ce.innerText ? ce.innerText : ce.innerHTML.replace(/<script\\s+(.|\\r?\\n)*?<\\/script>|<[^>]*>/g, \"\");\r\n                span.normalize();\r\n                tr[tr.length] = span.firstChild ? span.firstChild.nodeValue.trim(\" \\xA0\") : \"\";\r\n            }\r\n        }\r\n        if (!isEmpty(tr)) res[res.length] = tr;\r\n    }\r\n    return res;\r\n}\r\n\r\n\r\ndocument.createElementExt = function (tag , p )  {\r\n    var L, i, k, el = document.createElement(tag);\r\n    if (!el) return null;\r\n    for (i in p) {\r\n        if (!p.hasOwnProperty(i)) continue;\r\n        switch (i) {\r\n            case \"class\": el.setAttribute('className', p[i]); el.setAttribute('class', p[i]); break;\r\n            case \"style\": for (k in p[i]) { if (!p[i].hasOwnProperty(k)) continue; el.style[k] = p[i][k]; } break;\r\n            case \"event\": for (k in p[i]) { if (!p[i].hasOwnProperty(k)) continue; el.attachEvent(k, p[i][k]); } break;\r\n            case \"child\": L = p[i].length; for (k = 0; k < L; k++) el.appendChild(p[i][k]); break;\r\n            case \"param\": for (k in p[i]) { if (!p[i].hasOwnProperty(k)) continue; try { el[k] = p[i][k] } catch (e) { } } break;\r\n        }\r\n    }\r\n    return el;\r\n}\r\n\r\n\r\nfunction playInterval(f , i , o )  { return setInterval(function () { (o instanceof Array) ? f.apply(this, o) : f.call(this, o) }, i) }\r\nfunction playTimeout(f , i , o )  { return setTimeout(function () { (o instanceof Array) ? f.apply(this, o) : f.call(this, o) }, i) }\r\n\r\n\r\nfunction cloneObject(obj) {\r\n    if (isScalar(obj) || isFunction(obj) || null == obj) return obj;\r\n    try { var newObject = new obj.constructor(); } catch (e) { return null; }\r\n    if (isArray(newObject)) {\r\n        for (var i = 0, oL = obj.length; i < oL; i++) {\r\n            newObject[i] = cloneObject(obj[i]);\r\n        }\r\n    } else {\r\n        for (var i in obj) {\r\n            if (!obj.hasOwnProperty(i)) continue;\r\n            newObject[i] = cloneObject(obj[i]);\r\n        }\r\n    }\r\n    return newObject;\r\n}\r\n\r\n\r\nfunction mergeObject() {\r\n    var res = {}\r\n        , oi\r\n        , obj\r\n    for (var z = 0, aL = arguments.length; z < aL; z++) {\r\n        obj = arguments[z];\r\n        for (var i in obj) {\r\n            if (!obj.hasOwnProperty(i)) continue;\r\n            oi = obj[i];\r\n            if (null == oi) {\r\n                if (!res.hasOwnProperty(i)) res[i] = oi;\r\n            } else if (isArray(oi)) {\r\n                if (isArray(res[i]))\r\n                    res[i] = res[i].concat(oi).unique();\r\n                else\r\n                    res[i] = oi.slice(0);\r\n            } else if (isScalar(oi) || isFunction(oi)) {\r\n                res[i] = oi;\r\n            } else {\r\n                if (res.hasOwnProperty(i))\r\n                    res[i] = mergeObject(res[i], oi)\r\n                else\r\n                    res[i] = cloneObject(oi);\r\n            }\r\n        }\r\n    }\r\n    return res;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction loadStyleSheet(sn) {\r\n    if (!hasStyleSheet(sn)) {\r\n        var head = document.getElementsByTagName('head')[0]\r\n            , link = document.createElement('link');\r\n        link.rel = 'stylesheet';\r\n        link.type = 'text/css';\r\n        link.href = sn;\r\n        head.appendChild(link);\r\n    }\r\n}\r\n\r\n\r\nfunction hasStyleSheet(path) {\r\n    var h = document.getElementsByTagName('html')[0].innerHTML\r\n        , sr = new RegExp('<link[^>]+?src\\s*=\\s*[\"\\']?([^>]+?/)' + sn + '[^>]*>', 'i');\r\n    return sr.test(h);\r\n}\r\n\r\nexport {\r\n    isUndefined, isFunction, isString, isNumber, isNumeric, isArray, isRegExp, isBoolean, isScalar, isEmpty,\r\n    gluePath, findPath, getScriptQuery, parseQuery,\r\n    table2array, playInterval, playTimeout, cloneObject, mergeObject, loadStyleSheet, hasStyleSheet\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/helpers.js","import { isUndefined } from './../helpers';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nif (isUndefined(Array.prototype.copy)) {\r\n    Array.prototype.copy = function () {\r\n        var copy = new Array();\r\n        for (var i = 0, tL = this.length; i < tL; i++) {\r\n            copy[i] = this[i];\r\n        }\r\n        return copy;\r\n    };\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nif (isUndefined(Array.prototype.unique)) {\r\n    \r\n    Array.prototype.unique = function ()  {\r\n        var tmp = [];\r\n        for (var i = 0, tL = this.length; i < tL; i++) {\r\n            if (tmp.indexOf(this[i]) < 0) tmp[tmp.length] = this[i];\r\n        }\r\n        return tmp;\r\n    };\r\n}\r\n\r\nif (isUndefined(Array.prototype.flatten)) {\r\n    \r\n    Array.prototype.flatten = function (cols , cd)  {\r\n        if (this.length < 1) return [];\r\n        if (isNumeric(cols)) cols = [cols];\r\n        var idx = false;\r\n        if (isArray(cols)) {\r\n            idx = {};\r\n            for (var i = 0, cL = cols.length; i < cL; i++) idx[cols[i]] = true;\r\n        }\r\n        var tmp = [];\r\n        for (var i = 0, tL = this.length; i < tL; i++) {\r\n            if (isUndefined(this[i])) continue;\r\n            if (!isArray(this[i])) {\r\n                if (false === idx) tmp[tmp.length] = this[i];\r\n            } else {\r\n                for (var k = 0, cL = this[i].length; k < cL; k++) {\r\n                    if (false === idx || idx.hasOwnProperty(k)) tmp[tmp.length] = this[i][k];\r\n                }\r\n            }\r\n        }\r\n        return tmp;\r\n    };\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nif (isUndefined(Array.prototype.binSearch)) {\r\n    \r\n    Array.prototype.binSearch = function (el, key) {\r\n        var l = 0\r\n            , r = this.length\r\n            , len = Math.max(r - 1, 0)\r\n            , c = Math.ceil(r / 2)\r\n            , cnt = 0\r\n        if (null != key)\r\n            while ((!this[c] || el != this[c][key]) && r >= l) {\r\n                if (this[c] && el > this[c][key])\r\n                    l = c + 1\r\n                else\r\n                    r = c - 1\r\n                c = Math.max(0, Math.ceil((r + l) / 2))\r\n            }\r\n        else\r\n            while (el != this[c] && r >= l) {\r\n                if (el > this[c])\r\n                    l = c + 1\r\n                else\r\n                    r = c - 1\r\n                c = Math.max(0, Math.ceil((r + l) / 2));\r\n            }\r\n        return c\r\n    }\r\n}\r\n\r\nArray.prototype.heapSort = function () {\r\n\r\n   \r\n    \r\n    var sift = function (arr, low, up) {\r\n        var c, tmp = arr[low];\r\n\r\n        while (true) {\r\n            c = (low << 1) + 1;\r\n            if (c > up) break;\r\n            if (c < up && arr[c + 1] > arr[c]) c++;\r\n            if (tmp >= arr[c]) break;\r\n            arr[low] = arr[c];\r\n            low = c;\r\n        }\r\n        arr[low] = tmp;\r\n    },\r\n        tmp,\r\n        maximal = this.length - 1,\r\n        i = maximal >> 1;\r\n\r\n    while (i >= 0)\r\n        sift(this, i--, maximal);\r\n\r\n    i = maximal;\r\n    while (i > 0) {\r\n       \r\n        tmp = this[0];\r\n        this[0] = this[i];\r\n        this[i] = tmp;\r\n        sift(this, 0, --i);\r\n    }\r\n    return this;\r\n}\r\n\r\n\r\n\r\nif (isUndefined(Array.range)) {\r\n    \r\n    Array.range = function (end , start , inc )  {\r\n        if (!isNumber(end)) return null;\r\n        if (!isNumber(inc)) inc = 1;\r\n        if (!isNumber(start)) start = 0;\r\n        var tmp = []\r\n            , mn = Math.min(start, end)\r\n            , mx = Math.max(start, end)\r\n            , i = Math.abs(inc)\r\n            , cnt = -1;\r\n        do {\r\n            cnt++;\r\n            tmp[cnt] = mn;\r\n            mn += i;\r\n        } while (mn <= mx);\r\n        return inc > 0 ? tmp : tmp.reverse();\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/ext/array.js","\r\nif ('undefined' == typeof Object.hasOwnProperty) {\r\n  Object.prototype.hasOwnProperty = function (prop) {\r\n    return !('undefined' == typeof this[prop] || this.constructor && this.constructor.prototype[prop] && this[prop] === this.constructor.prototype[prop]);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/ext/object.js","\r\n\r\nRegExp.escape = function escape (text )  {\r\n  if (!escape.sRE) {\r\n    var specials = [\r\n      '/', '.', '*', '+', '?', '|',\r\n      '(', ')', '[', ']', '{', '}', '$', '^', '\\\\'\r\n    ];\r\n    escape.sRE = new RegExp(\r\n      '(\\\\' + specials.join('|\\\\') + ')', 'g'\r\n    );\r\n  }\r\n  return isString(text)?text.replace(escape.sRE, '\\\\$1')\r\n                       :(isArray(text)?text.map(RegExp.escape).join(\"|\")\r\n                                      :\"\");\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/ext/regexp.js","\r\n\r\nString.fromCharCodeExt = function(code) {\r\n    if (code<0x10000) {\r\n        return String.fromCharCode(code);\r\n    }\r\n    code -= 0x10000;\r\n    return String.fromCharCode(code >>10 | 0xD800)+String.fromCharCode(code & 0x3FF | 0xDC00)\r\n}\r\n\r\nString.prototype.entityDecode = function entityDecode() {\r\n    if (!entityDecode.span) entityDecode.span = document.createElement('span');\r\n    var s = entityDecode.span;\r\n    s.innerHTML = this;\r\n    return s.firstChild?s.firstChild.nodeValue:\"\";\r\n}\r\n\r\n\r\nString.prototype.ltrim = function(c) {\r\n    if (isString(c)) c=c.split(\"\");\r\n    if (isArray(c) || isUndefined(c)) {\r\n        c = isEmpty(c)?\"\\\\s\":RegExp.escape(c); \r\n        c = new RegExp(\"^(?:\"+c+\")+\", \"g\");\r\n        return this.replace(c, \"\");\r\n    }\r\n    return this; \r\n}\r\n\r\nString.prototype.rtrim = function(c) {\r\n    if (isString(c)) c=c.split(\"\");\r\n    if (isArray(c) || isUndefined(c)) {\r\n        c = isEmpty(c)?\"\\\\s\":RegExp.escape(c); \r\n        c = new RegExp(\"(?:\"+c+\")+$\", \"g\");\r\n        return this.replace(c, \"\");\r\n    }\r\n    return this; \r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nString.prototype.dup = function() {\r\n    var val = this.valueOf();\r\n    return [val,val].join(\"\");\r\n}\r\n\r\nString.prototype.repeat = function(n )  {\r\n    if (isNaN(n=parseInt(n)) || n<0) return \"\";\r\n    return Array(n+1).join(this.valueOf());\r\n}\r\n\r\nString.prototype.padding = function(n, c) {\r\n    var val = this.valueOf();\r\n    n = parseInt(n);\r\n    if (!n) return val;\r\n    if (isUndefined(c)) c = \" \";\r\n    var pad = String(c).charAt(0).repeat(Math.abs(n) - this.length);\r\n    return (n < 0) ? pad + val : val + pad;\r\n}\r\n\r\nString.prototype.padLeft = function(n, c) {\r\n    return this.padding(-Math.abs(n), c);\r\n}\r\n\r\nString.prototype.padRight = function(n, c) {\r\n    return this.padding(Math.abs(n), c);\r\n}\r\n\r\n\r\nString.prototype.sprintf = function() {\r\n    var args = isArray(arguments[0])?arguments[0]:arguments\r\n       ,index = 0\r\n       ,frmt = this.replace(/%%/g, \"\\0\\0\")\r\n       ,re = /%((?:\\d+\\$)?)((?:[-0+# ])?)((?:\\d+|\\*(?:\\d+\\$)?)?)((?:.(?:\\d+|\\*(?:\\d+\\$)?))?)([bcdeEfosuxX])/g;\r\n    \r\n    frmt = frmt.replace(re, function() {\r\n        var x = arguments\r\n           ,sign = false\r\n           ,ins;\r\n\r\n        \r\n        if (!isUndefined(x[3]) && x[3].indexOf(\"*\")==0) {\r\n            x[3] = parseInt(x[3].replace(/\\D/g,\"\"))\r\n            if (isNaN(x[3])) {\r\n              x[3] = args[index];\r\n              \r\n              index++;\r\n            } else {\r\n              x[3] = args[x[3]]  \r\n            }\r\n        }\r\n        \r\n        if (\"\" != x[4]) {\r\n            if (x[4].indexOf(\"*\")==1) {\r\n                x[4] = parseInt(x[4].replace(/\\D/g,\"\"))\r\n                if (isNaN(x[4])) {\r\n                  x[4] = args[index];\r\n                  \r\n                  index++;\r\n                } else {\r\n                  x[4] = args[x[4]]  \r\n                }\r\n            } else {\r\n                x[4] = x[4].replace(/\\D/,\"\")\r\n            }\r\n            x[4] = Math.abs(x[4]);\r\n        }\r\n           \r\n        x[1] = parseInt(x[1]);\r\n        var ins;\r\n        if (isNumeric(x[1])) {\r\n            ins = args[x[1]];\r\n        } else {\r\n            ins = args[index];\r\n            \r\n            index++;\r\n        }\r\n        switch (x[5]) {\r\n        case \"b\":\r\n            if (ins<0) ins = 0x10000000000000000+parseInt(ins);\r\n            ins = Number(ins).bin(x[4]);\r\n            if (x[4]) ins = ins.substr(0,x[4]);\r\n            if (x[2]=='#') ins = '0b'+ins;\r\n            break;\r\n        case \"c\":\r\n            ins = String.fromCharCode(ins);\r\n            break;\r\n        case \"u\":\r\n            ins = Math.abs(ins);  \r\n        case \"d\":\r\n            ins = Math.round(ins);       \r\n            if (ins<0) {\r\n                ins = \"-\"+Math.abs(ins).dec(x[4]);\r\n            } else {\r\n                ins = Number(ins).dec(x[4]);\r\n                sign = (x[2] == ' ' || x[2] == '+');\r\n            }\r\n            break;\r\n        case \"e\":\r\n        case \"E\":\r\n            if (ins>0) {\r\n                sign = (x[2] == ' ' || x[2] == '+');\r\n            }\r\n            ins = Number(ins).toExponential(x[4]?x[4]:6);\r\n            if (x[5]=='E') ins=ins.toUpperCase();\r\n            break;\r\n        case \"f\":\r\n            if (ins>0) {\r\n                sign = (x[2] == ' ' || x[2] == '+');\r\n            }\r\n            ins = Number(ins).toFixed(isNumeric(x[4])?x[4]:6);\r\n            break;\r\n        case \"o\":\r\n            if (ins<0) ins = 0x10000000000000000+parseInt(ins);\r\n            ins = Number(ins).toString(8);\r\n            if (x[4]) ins = ins.substr(0,x[4]);\r\n            if (x[2]=='#' && ins != 0) ins = '0'+ins;\r\n            break;\r\n        case \"s\":\r\n            ins = String(ins);\r\n            if (x[4]) ins = ins.substr(0,x[4]);\r\n            break;\r\n        case \"x\":\r\n        case \"X\":\r\n            if (ins<0) ins = 0x10000000000000000+parseInt(ins);\r\n            ins = Number(ins).hex(-x[4]);\r\n            if (x[4]) ins = ins.substr(0,x[4]);\r\n            if (x[2]=='#') ins = '0x'+ins;\r\n            if (x[5]=='X') ins = ins.toUpperCase();\r\n            break;\r\n        }\r\n        if (sign) ins = x[2]+ins;\r\n        if (x[3]) ins = (x[2]=='-' || x[3]<0)?ins.padRight(x[3]):ins.padLeft(x[3],x[2]=='0'?0:\" \");\r\n        return ins;\r\n    })\r\n    return frmt.replace(/\\0\\0/g, \"%\");\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/ext/string.js","import { DOM } from './dom';\r\n\r\n\r\n\r\nvar DocumentSelection = new function () {\r\n    var self = this;\r\n    \r\n    var keys = {\r\n        'prevCalcNode': '__prevCalcNode'\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    var callMethod = function (m, arg) {\r\n        var el = arg[0]\r\n            , id\r\n            , module = \"\"\r\n        if (!el || !el.tagName) return false;\r\n        switch (arg[0].tagName.toLowerCase()) {\r\n            case 'input':\r\n                if (el.type && el.type != 'text' && el.type != 'password') return false;\r\n            case 'textarea':\r\n                module = \"input\";\r\n                break;\r\n            case 'iframe':\r\n                module = \"frame\";\r\n                arg[0] = el.contentWindow;\r\n                break;\r\n            default:\r\n                return false;\r\n        }\r\n        \r\n        if ('function' == typeof self.module[module])\r\n            self.module[module] = new self.module[module](keys);\r\n        \r\n        if (!self.module[module] || !self.module[module][m])\r\n            throw new Error('Method \\'' + m + '\\' is not implemented for DocumentSelection \\'' + module + '\\' module.');\r\n\r\n        return self.module[module][m].apply(self, arg);\r\n    }\r\n    \r\n    var keepScroll = function (el, ot, ol) {\r\n        if (window.getSelection && 'iframe' != el.tagName.toLowerCase()) {\r\n            var q = self.getSelectionOffset(el)\r\n            if (el.contentWindow) el = el.contentWindow.document.body;\r\n\r\n            if (ot > q.y) el.scrollTop = q.y;\r\n            else if (ot + el.clientHeight > q.y) el.scrollTop = ot;\r\n            else el.scrollTop = q.y - el.clientHeight / 2;\r\n\r\n            if (ol > q.x) el.scrollLeft = q.x;\r\n            else if (ol + el.clientWidth > q.x) el.scrollLeft = ol;\r\n            else el.scrollLeft = q.x - el.clientWidth / 2;\r\n        }\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    self.setRange = function (el, start, end, related) {\r\n        var ot = el.scrollTop\r\n            , ol = el.scrollLeft\r\n        \r\n        if (related) {\r\n            var st = self.getStart(el);\r\n            end = st + end;\r\n            start = st + start;\r\n        }\r\n        if (start < 0) start = 0;\r\n        if (end < start) end = start;\r\n\r\n        callMethod('setRange', [el, start, end]);\r\n\r\n        keepScroll(el, ot, ol);\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    self.getSelection = function (el) {\r\n        return callMethod('getSelection', [el]);\r\n    }\r\n    \r\n    self.getStart = function (el) {\r\n        return callMethod('getPos', [el])[0];\r\n    }\r\n    \r\n    self.getEnd = function (el) {\r\n        return callMethod('getPos', [el])[0];\r\n    }\r\n    \r\n    self.getCursorPosition = function (el) {\r\n        return self.getStart(el);\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    self.insertAtCursor = function (el, val, keep) {\r\n        var ot = el.scrollTop\r\n            , ol = el.scrollLeft\r\n        if (!keep) {\r\n            callMethod('del', [el]);\r\n        }\r\n        var pos = callMethod('ins', [el, val]);\r\n        keepScroll(el, ot, ol);\r\n        return pos;\r\n    }\r\n    \r\n    self.wrapSelection = function (el, start, end) {\r\n        var s = self.getCursorPosition(el)\r\n            , e = self.getEnd(el)\r\n        if (s == e) {\r\n            self.insertAtCursor(el, start + end);\r\n        } else {\r\n            self.insertAtCursor(el, start, true);\r\n            self.setRange(el, e + start.length, e + start.length);\r\n            self.insertAtCursor(el, end, true);\r\n        }\r\n    }\r\n\r\n    \r\n    self.deleteAtCursor = function (el, after) {\r\n        if (!self.getSelection(el)) {\r\n            if (after)\r\n                self.setRange(el, 0, 1, true);\r\n            else\r\n                self.setRange(el, -1, 0, true);\r\n        }\r\n        return self.deleteSelection(el);\r\n    }\r\n    \r\n    self.deleteSelection = function (el) {\r\n        var ol = el.scrollLeft\r\n            , ot = el.scrollTop\r\n            , ret = callMethod('del', [el]);\r\n        keepScroll(el, ot, ol);\r\n        return ret;\r\n    }\r\n    \r\n    self.getSelectionOffset = function (el) {\r\n        return callMethod('getSelectionOffset', [el], true);\r\n    }\r\n    \r\n    self.getContext = function (el) {\r\n        return callMethod('getContext', [el]);\r\n    }\r\n};\r\nDocumentSelection.module = {\r\n    \r\n    'input': function (keys) {\r\n        var self = this;\r\n        \r\n        var offsetCalculator = null;\r\n        \r\n        self.getContext = function (el) {\r\n            var pos = self.getPos(el)\r\n                , val = el.value\r\n                , r1 = val.match(new RegExp(\"(?:.|[\\\\r\\\\n]){0,\" + (pos[0] - 1) + \"}(?:^|\\\\s)\", \"m\")) || \"\"\r\n                , r2 = val.match(new RegExp(\"(?:.|[\\\\r\\\\n]){\" + pos[0] + \"}\", \"m\"))[0]\r\n                , r3 = val.replace(r2, \"\")\r\n                , r4 = r3.substring(0, pos[1] - pos[0])\r\n                , r5 = (r3.replace(r4, \"\")).match(/(?:\\S|$)*/)\r\n            return [r2.replace(r1, \"\"), r4, r5];\r\n        }\r\n        \r\n        self.getPos = function (el) {\r\n            var pos = [0, 0];\r\n            if ('function' == typeof window.getSelection) {\r\n                try {\r\n                    pos = [el.selectionStart, el.selectionEnd];\r\n                } catch (e) {\r\n                }\r\n            } else {\r\n                el.setActive();\r\n                pos = [Math.abs(el.document.selection.createRange().moveStart(\"character\", -100000000))\r\n                    , Math.abs(el.document.selection.createRange().moveEnd(\"character\", -100000000))];\r\n                \r\n                if (el.tagName.toLowerCase() != 'input') {\r\n                    \r\n                    var r = el.document.body.createTextRange();\r\n                    r.moveToElementText(el);\r\n                    var sTest = Math.abs(r.moveStart(\"character\", -100000000));\r\n                    pos[0] -= sTest;\r\n                    pos[1] -= sTest;\r\n                }\r\n            }\r\n            return pos;\r\n        }\r\n        \r\n        self.del = function (el) {\r\n            var ret = \"\"\r\n                , p = self.getPos(el)\r\n                , s = p[0]\r\n                , e = p[1];\r\n            if (s != e) {\r\n                \r\n                var tmp = document.selection && !window.opera ? el.value.replace(/\\r/g, \"\") : el.value;\r\n                ret = tmp.substring(s, e);\r\n                el.value = tmp.substring(0, s) + tmp.substring(e, tmp.length);\r\n                self.setRange(el, s, s);\r\n            }\r\n            return ret;\r\n        }\r\n        \r\n        self.ins = function (el, val) {\r\n            var ret = \"\"\r\n                , s = self.getPos(el)[0]\r\n            \r\n            var tmp = document.selection && !window.opera ? el.value.replace(/\\r/g, \"\") : el.value;\r\n            el.value = tmp.substring(0, s) + val + tmp.substring(s, tmp.length);\r\n            s += val.length;\r\n            self.setRange(el, s, s);\r\n            return s;\r\n        }\r\n        \r\n        self.getSelection = function (el) {\r\n            var p = self.getPos(el)\r\n                , s = p[0]\r\n                , e = p[1];\r\n            \r\n            if (e < s) e = s;\r\n            \r\n            var tmp = document.selection && !window.opera ? el.value.replace(/\\r/g, \"\") : el.value;\r\n            return tmp.substring(s, e);\r\n        }\r\n        \r\n        self.setRange = function (el, start, end) {\r\n            if ('function' == typeof el.setSelectionRange) {\r\n                \r\n                try { el.setSelectionRange(start, end) } catch (e) { }\r\n            } else {\r\n                \r\n                var range;\r\n                \r\n                try {\r\n                    range = el.createTextRange();\r\n                } catch (e) {\r\n                    try {\r\n                        range = el.document.body.createTextRange();\r\n                        range.moveToElementText(el);\r\n                    } catch (e) {\r\n                        return false;\r\n                    }\r\n                }\r\n                el.setActive();\r\n                range.collapse(true);\r\n                range.moveStart(\"character\", start);\r\n                range.moveEnd(\"character\", end - start);\r\n                range.select();\r\n            }\r\n        }\r\n        \r\n        self.getSelectionOffset = function (el) {\r\n            var range\r\n                , doc = DOM.getWindow(el).document;\r\n            if ('function' == typeof el.setSelectionRange) {\r\n                \r\n                if (!offsetCalculator) {\r\n                    \r\n                    offsetCalculator = doc.createElement('td');\r\n\r\n                    doc.body.appendChild(offsetCalculator);\r\n                }\r\n                \r\n                if (offsetCalculator[keys.prevCalcNode] != el) {\r\n                    offsetCalculator[keys.prevCalcNode] = el;\r\n                    var cs = doc.defaultView.getComputedStyle(el, null);\r\n                    for (var i in cs) {\r\n                        try { if (cs[i]) offsetCalculator.style[i] = cs[i]; } catch (e) { }\r\n                    }\r\n                    offsetCalculator.style.overflow = 'auto';\r\n                    offsetCalculator.style.position = 'absolute';\r\n                    offsetCalculator.style.visibility = 'hidden';\r\n                    offsetCalculator.style.zIndex = '-10';\r\n                    offsetCalculator.style.left = \"-10000px\";\r\n                    offsetCalculator.style.top = \"-10000px\";\r\n                    offsetCalculator.style.backgroundColor = 'yellow';\r\n                }\r\n                \r\n                var range = doc.createRange()\r\n                    , val = el.value || \" \";\r\n\r\n                if ('input' == el.tagName.toLowerCase()) {\r\n                    offsetCalculator.style.width = 'auto'\r\n                    offsetCalculator.style.whiteSpace = 'nowrap';\r\n                } else {\r\n                    offsetCalculator.style.whiteSpace = 'off' == el.getAttribute('wrap') ? \"pre\" : \"\";\r\n                }\r\n\r\n                val = val.replace(/\\x20\\x20/g, \"\\x20\\xa0\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt\");\r\n                offsetCalculator.innerHTML = (val.substring(0, el.selectionStart - 1) + \"<span>\" + val.substring(el.selectionStart - 1, el.selectionStart) + \"</span>\"\r\n                    + val.substring(el.selectionStart)).replace(/\\n/g, \"<br />\")\r\n                    .replace(/\\t/g, \"<em style=\\\"white-space:pre\\\">\\t</em>\")\r\n                \r\n                var span = offsetCalculator.getElementsByTagName('span')[0];\r\n                span.style.border = '1px solid red';\r\n                range.offsetLeft = span.offsetLeft// - el.scrollLeft + span.clientWidth;\r\n                range.offsetTop = span.offsetTop// - el.scrollTop;\r\n                range.offsetHeight = span.offsetHeight;\r\n                if (\"\\n\" == val.charAt(el.selectionStart - 1)) range.offsetTop += range.offsetHeight * 2;\r\n                span = null;\r\n            } else if (doc.selection && doc.selection.createRange) {\r\n                \r\n                range = doc.selection.createRange();\r\n                \r\n                range.offsetHeight = Math.round(range.boundingHeight / (range.text.replace(/[^\\n]/g, \"\").length + 1));\r\n                if (el.tagName && 'textarea' == el.tagName.toLowerCase()) {\r\n                    var xy = DOM.getOffset(el)\r\n                    range = {\r\n                        'offsetTop': range.offsetTop - xy.y + DOM.getBodyScrollTop(el)\r\n                        , 'offsetLeft': range.offsetLeft - xy.x + DOM.getBodyScrollLeft(el)\r\n                        , 'offsetHeight': range.offsetHeight\r\n                    }\r\n                }\r\n            }\r\n            if (range) {\r\n                return { 'x': range.offsetLeft, 'y': range.offsetTop, 'h': range.offsetHeight };\r\n            }\r\n            return { 'x': 0, 'y': 0, 'h': 0 };\r\n        }\r\n    }\r\n    , 'frame': function () {\r\n        var self = this;\r\n        \r\n        self.getContext = function (el) {\r\n            if ('function' == typeof el.getSelection) {\r\n                var pos = self.getPos(el)\r\n                    , val = el.document.body.innerText || el.document.body.innerHTML.replace(/<\\/?[a-z:]+[^>]*>/ig, \"\").replace(\"&nbsp;\", \" \")\r\n                    , r1 = val.match(new RegExp(\"(?:.|[\\\\r\\\\n]){0,\" + (pos[0] - 1) + \"}(?:^|\\\\s)\", \"m\")) || \"\"\r\n                    , r2 = val.match(new RegExp(\"(?:.|[\\\\r\\\\n]){\" + pos[0] + \"}\", \"m\")) || \"\"\r\n                    , r3 = val.replace(r2, \"\")\r\n                    , r4 = r3.substring(0, pos[1] - pos[0])\r\n                    , r5 = (r3.replace(r4, \"\")).match(/(?:\\S|$)*/)\r\n                return [r2.toString().replace(r1, \"\"), r4, r5];\r\n            } else {\r\n                var s1 = el.document.selection.createRange()\r\n                    , s2 = el.document.selection.createRange()\r\n                    , s3 = el.document.selection.createRange()\r\n                s1.moveStart(\"word\", -1)\r\n                s3.moveEnd(\"word\", 1)\r\n\r\n                return [s1.text.replace(new RegExp(RegExp.escape(s2.text) + \"$\"), \"\")\r\n                    , s2.text\r\n                    , s3.text.replace(new RegExp(\"^\" + RegExp.escape(s2.text)), \"\")];\r\n            }\r\n        }\r\n        \r\n        self.getPos = function (el) {\r\n            var pos = [0, 0];\r\n            if ('function' == typeof el.getSelection) {\r\n                \r\n                var sel = el.getSelection()\r\n                    , sn = sel.anchorNode\r\n                    , so = sel.anchorOffset\r\n                    , en = sel.focusNode\r\n                    , eo = sel.focusOffset\r\n                    , ss = false\r\n                    , es = false\r\n                    , sc = 0\r\n                    , ec = 0\r\n                    , cn\r\n                    , tw = el.document.createTreeWalker(el.document.body, NodeFilter.SHOW_TEXT, null, false)\r\n                while (sn && sn.nodeType != 3) {\r\n                    sn = sn.childNodes[so]\r\n                    so = 0;\r\n                }\r\n                while (en && en.nodeType != 3) {\r\n                    en = en.childNodes[eo]\r\n                    eo = 0;\r\n                }\r\n                while (cn = tw.nextNode()) {\r\n                    if (cn == en) {\r\n                        ec += eo\r\n                        es = true\r\n                    }\r\n                    if (cn == sn) {\r\n                        sc += so\r\n                        ss = true\r\n                    }\r\n                    if (!es) ec += cn.nodeValue.length\r\n                    if (!ss) sc += cn.nodeValue.length\r\n                    if (es && ss) break;\r\n                }\r\n                pos = [Math.min(ec, sc), Math.max(ec, sc)]\r\n            } else {\r\n                el.document.body.setActive();\r\n                pos = [Math.abs(el.document.selection.createRange().moveStart(\"character\", -100000000))\r\n                    , Math.abs(el.document.selection.createRange().moveEnd(\"character\", -100000000))];\r\n            }\r\n            return pos;\r\n        }\r\n        \r\n        self.del = function (el) {\r\n            if ('function' == typeof el.getSelection) {\r\n                var s = el.getSelection()\r\n                    , i = s.rangeCount\r\n                while (--i > -1) s.getRangeAt(i).deleteContents();\r\n\r\n                \r\n                var r = s.getRangeAt(s.rangeCount - 1)\r\n                r.insertNode(el.document.createTextNode(\"\"))\r\n                s.addRange(r);\r\n            } else if (el.document && el.document.selection) {\r\n                el.document.selection.createRange().text = \"\";\r\n                el.document.selection.createRange().select();\r\n            }\r\n        }\r\n        \r\n        self.ins = function (el, val) {\r\n            if ('function' == typeof el.getSelection) {\r\n                val = val.replace(/&/, \"&amp;\").replace(/</, \"&lt;\").replace(/>/, \"&gt;\").replace(/\\x20/, \"&nbsp;\").replace(/[\\r\\n]/, \"<br />\");\r\n                var n = el.document.createElement('span')\r\n                    , s = el.getSelection()\r\n                    , r = s.getRangeAt(0)\r\n                    , ln;\r\n                n.innerHTML = val;\r\n                r.insertNode(n);\r\n                r.selectNodeContents(n);\r\n\r\n                var pn = n.parentNode\r\n                    , ln = n.nextSibling\r\n\r\n                \r\n                n.parentNode.replaceChild(r.extractContents(), n);\r\n\r\n                \r\n                if (!ln)\r\n                    ln = pn.lastChild;\r\n\r\n                var r1 = el.document.createRange();\r\n                \r\n                if (ln.nodeValue) {\r\n                    \r\n                    r1.setStart(ln, 0);\r\n                } else {\r\n                    \r\n                    r1.setStartAfter(ln);\r\n                }\r\n\r\n                \r\n                s.removeAllRanges();\r\n                s.addRange(r1);\r\n\r\n            } else if (el.document && el.document.selection) {\r\n                el.document.body.setActive();\r\n                var r = el.document.selection.createRange();\r\n                r.text = val;\r\n                \r\n                if (r.moveStart(\"character\", 1)) {\r\n                    r.moveStart(\"character\", -1);\r\n                    r.moveEnd(\"character\", -1);\r\n                    r.select();\r\n                }\r\n            }\r\n            return self.getPos(el)[0];\r\n        }\r\n        \r\n        self.getSelection = function (el, s, e) {\r\n            if ('function' == typeof el.getSelection) {\r\n                var s = el.getSelection();\r\n                return s ? s.toString() : \"\";\r\n            } else if (el.document && el.document.selection) {\r\n                return el.document.selection.createRange().text;\r\n            }\r\n        }\r\n        \r\n        self.setRange = function (el, start, end) {\r\n            if ('function' == typeof el.getSelection) {\r\n                var sel = el.getSelection();\r\n                sel.removeAllRanges();\r\n                var r = el.document.createRange()\r\n                    , cnt = 0\r\n                    , cl = 0\r\n                    , cn\r\n                    , pn\r\n                    , tw = el.document.createTreeWalker(el.document.body, NodeFilter.SHOW_TEXT, null, false);\r\n\r\n                \r\n                while ((cn = tw.nextNode()) && (!cn.nodeValue.length || (cnt + cn.nodeValue.length <= start))) {\r\n                    pn = cn;\r\n                    cnt += cn.nodeValue.length;\r\n                }\r\n                \r\n                if (cn || (cn = pn)) {\r\n                    r.setStart(cn, start - cnt);\r\n                    r.setEnd(cn, start - cnt);\r\n                }\r\n                if (cn) {\r\n                    do {\r\n                        if (cn.nodeType != 3) continue;\r\n                        if (cnt + cn.nodeValue.length < end) {\r\n                            cnt += cn.nodeValue.length;\r\n                        } else {\r\n                            r.setEnd(cn, end - cnt);\r\n                            break;\r\n                        }\r\n                    } while (cn = tw.nextNode())\r\n                }\r\n                sel.addRange(r);\r\n            } else if (el.document && el.document.selection) {\r\n                el.document.body.setActive();\r\n                var r = el.document.selection.createRange()\r\n                r.moveToElementText(el.document.body);\r\n                r.move(\"character\", start);\r\n                r.moveEnd(\"character\", end - start);\r\n                r.select();\r\n            }\r\n        }\r\n        \r\n        self.getSelectionOffset = function (el) {\r\n            var off = { 'x': 0, 'y': 0, 'h': 0 };\r\n            if ('function' == typeof el.getSelection) {\r\n                var r = el.getSelection().getRangeAt(0)\r\n                    , s = el.document.createElement('span')\r\n                    , contents = r.cloneContents()\r\n                    , e = r.endOffset\r\n                    , n = s;\r\n\r\n                s.style.borderLeft = '1px solid red';\r\n                r.surroundContents(s);\r\n                off.h = n.offsetHeight;\r\n                while (n.offsetParent) {\r\n                    off.x += n.offsetLeft;\r\n                    off.y += n.offsetTop;\r\n                    n = n.offsetParent\r\n                }\r\n                s.parentNode.removeChild(s);\r\n\r\n                var r1 = el.document.createRange()\r\n                if (contents.childNodes.length > 0) {\r\n                    for (var i = 0; i < contents.childNodes.length; i++) {\r\n                        var n = contents.childNodes[i];\r\n                        r.insertNode(n);\r\n                        r1.selectNode(n);\r\n                    }\r\n                    el.getSelection().addRange(r1);\r\n                }\r\n            } else if (el.document && el.document.selection) {\r\n                var r = el.document.selection.createRange()\r\n                off.h = r.boundingHeight\r\n                off.x = r.offsetLeft;\r\n                off.y = r.offsetTop;\r\n            }\r\n            return off;\r\n        }\r\n    }\r\n};\r\n\r\nexport { DocumentSelection };\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/documentselection.js","import { isUndefined, isFunction, isString, isNumber, isNumeric, isArray, isRegExp, isBoolean, isScalar, isEmpty,\r\n    getScriptQuery } from './helpers';\r\n\r\n\r\n\r\nconst DOM = {};\r\n\r\nDOM.getParent = function getParent(el , cp , vl )  {\r\n  if (el == null) return null;\r\n  else if (el.nodeType == 1 &&\r\n      ((!isUndefined(vl) && el[cp] == vl) ||\r\n       ('string' == typeof cp && DOM.hasTagName(el, cp)) ||\r\n       el == cp)) return el;\r\n  else return getParent(el.parentNode, cp, vl); \r\n};\r\n\r\nDOM.getOffset = function (el )  {\r\n    var fixBrowserQuirks = true\r\n       ,o = el\r\n       ,left = 0\r\n       ,top = 0\r\n       ,width = 0\r\n       ,height = 0\r\n       ,parentNode = null\r\n       ,offsetParent = null;\r\n\r\n    if (o==null) return null;\r\n    \r\n    offsetParent = o.offsetParent;\r\n    var originalObject = o\r\n       ,el = o;\r\n    while (el.parentNode!=null) {\r\n      el = el.parentNode;\r\n      if (el.offsetParent!==null) {\r\n        var considerScroll = true;\r\n        \r\n        if (fixBrowserQuirks && window.opera) {\r\n          if (el==originalObject.parentNode || el.nodeName==\"TR\") {\r\n            considerScroll = false;\r\n          }\r\n        }\r\n        if (considerScroll) {\r\n          if (el.scrollTop && el.scrollTop>0) {\r\n            top -= el.scrollTop;\r\n          }\r\n          if (el.scrollLeft && el.scrollLeft>0) {\r\n            left -= el.scrollLeft;\r\n          }\r\n        }\r\n      }\r\n     \r\n      if (el == offsetParent) {\r\n        left += o.offsetLeft;\r\n        if (el.clientLeft && el.nodeName!=\"TABLE\") { \r\n          left += el.clientLeft;\r\n        }\r\n        top += o.offsetTop;\r\n        if (el.clientTop && el.nodeName!=\"TABLE\") {\r\n          top += el.clientTop;\r\n        }\r\n        o = el;\r\n        if (o.offsetParent==null) {\r\n          if (o.offsetLeft) {\r\n            left += o.offsetLeft;\r\n          }\r\n          if (o.offsetTop) {\r\n            top += o.offsetTop;\r\n          }\r\n        }\r\n        offsetParent = o.offsetParent;\r\n      }\r\n    }\r\n    \r\n  \r\n    if (originalObject.offsetWidth) {\r\n      width = originalObject.offsetWidth;\r\n    }\r\n    if (originalObject.offsetHeight) {\r\n      height = originalObject.offsetHeight;\r\n    }\r\n    \r\n    return {'x':left, 'y':top, 'width':width, 'height':height};\r\n};\r\n  \r\n\r\n\r\n\r\nDOM.getClientWidth = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document\r\n       ,w=0;\r\n    if (win.innerWidth) w = win.innerWidth;\r\n    else if (doc.documentElement && doc.documentElement.clientWidth) w = doc.documentElement.clientWidth;\r\n    else if (doc.body) w = doc.body.clientWidth;\r\n    return w;\r\n};\r\n\r\nDOM.getOffsetWidth = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document\r\n       ,w=0;\r\n    if (win.outerWidth) w = win.outerWidth;\r\n    else if (doc.documentElement && doc.documentElement.clientWidth) w = doc.documentElement.clientWidth;\r\n    else if (doc.body) w = doc.body.clientWidth;\r\n    return w;\r\n};\r\n\r\nDOM.getClientHeight = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document\r\n       ,h=0;\r\n    if (win.innerHeight) h = win.innerHeight;\r\n    else if (doc.documentElement && doc.documentElement.clientHeight) h = doc.documentElement.clientHeight;\r\n    else if (doc.body) h = doc.body.clientHeight;\r\n    return h;\r\n};\r\n\r\nDOM.getOffsetHeight = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document\r\n       ,h=0;\r\n    if (win.outerHeight) h = win.outerHeight;\r\n    else if (doc.documentElement && doc.documentElement.clientHeight) h = doc.documentElement.clientHeight;\r\n    else if (doc.body) h = doc.body.clientHeight;\r\n    return h;\r\n};\r\n\r\nDOM.getBodyScrollTop = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document;\r\n    return win.pageYOffset || (doc.documentElement && doc.documentElement.scrollTop) || (doc.body && doc.body.scrollTop);\r\n};\r\n\r\nDOM.getBodyScrollLeft = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document;\r\n    return win.pageXOffset || (doc.documentElement && doc.documentElement.scrollLeft) || (doc.body && doc.body.scrollLeft);\r\n};\r\n\r\nDOM.getWindow = function (el) {\r\n    var win = window;\r\n    if (el) {\r\n        var doc = el.ownerDocument;\r\n        win = doc.defaultView || doc.parentWindow || doc.window || window;\r\n    }\r\n    return win;\r\n}\r\n\r\n\r\nDOM.getCursorPosition = function (e) {\r\n    if (e.pageX || e.pageY) return {'x': e.pageX, 'y': e.pageY};\r\n    \r\n    var de = document.documentElement || document.body;\r\n    return {'x': e.clientX + de.scrollLeft - (de.clientLeft || 0)\r\n           ,'y': e.clientY + de.scrollTop - (de.clientTop || 0)};\r\n};\r\n\r\nDOM.hasTagName = function (prop , tags ) {\r\n    if (isString(tags)) tags = [tags];\r\n    if (!isArray(tags) || isEmpty(tags) || isUndefined(prop) || isEmpty(prop.tagName)) return false;\r\n    var t = prop.tagName.toLowerCase();\r\n    for (var i=0, tL=tags.length; i<tL; i++) {\r\n        if (tags[i].toLowerCase() == t) return true;\r\n    }\r\n    return false;\r\n};\r\n\r\nDOM.color2rgb = function (prop) {\r\n    var e;\r\n    \r\n    if (/^([a-z]+)($|\\s[a-z]+)/i.test(prop)) {\r\n        var d = document.body, ov = d.vLink;\r\n        d.vLink = prop.split(\" \")[0];\r\n        prop = d.vLink;\r\n        d.vLink = ov;\r\n    }\r\n    try {\r\n        if (e = prop.match(/^#([\\da-f]{6})$/i)) {\r\n            return e=parseInt(e[1],16),[(e&0xff0000)>>16,(e&0xff00)>>8,(e&0xff)]\r\n        } else if (e = prop.match(/^#([\\da-f]{3})$/i)) {\r\n            return e=parseInt(e[1],16),[((e&0xf00)>>8)*0x11,((e&0xf0)>>4)*0x11,(e&0xf)*0x11];\r\n        } else\r\n            return (prop.match(/([\\d%]+)/g).splice(0,3).map(function(a){ return /%/.test(a)?(parseInt(a)*2.55).toFixed(0):parseInt(a)}))\r\n    } catch(err){\r\n        return;\r\n    }\r\n}\r\nDOM.setOpacity = function (el, opacity) {\r\n    if (el.style.opacity != opacity) {\r\n        el.style.opacity = \r\n        el.style.KhtmOpacity =\r\n        el.style.MozOpacity = opacity;\r\n        el.style.filter = \"alpha(opacity=\"+(opacity*100)+\")\";\r\n    }\r\n}\r\n\r\nDOM.CSS = function (el) {\r\n    var self = this\r\n    \r\n    self.addClass = function() {\r\n        var arg = isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);\r\n        self.removeClass(arg);\r\n        el.className = el.className+\" \"+Array.prototype.join.call(arg,\" \");\r\n        return self;\r\n    };\r\n    \r\n    self.removeClass = function removeClass() {\r\n        var arg = isArray(arguments[0])?arguments[0]:arguments;\r\n        if (!removeClass.cache) removeClass.cache = {}\r\n        var c = removeClass.cache\r\n        for (var i=0, aL=arg.length; i<aL; i++) {\r\n            if (!c.hasOwnProperty(arg[i])) c[arg[i]] = new RegExp(\"(^|\\\\s+)\"+arg[i]+\"(\\\\s+|$)\");\r\n            el.className = el.className.replace(c[arg[i]],\" \");\r\n        }\r\n        el.className=el.className.replace(/\\s{2,}/,\" \")\r\n        return self;\r\n    };\r\n    \r\n    self.hasClass = function(c) {\r\n        let re = new RegExp(\"(^|\\\\s+)\"+c+\"(\\\\s+|$)\");\r\n        return el.className.match(re,\" \"+c+\" \");\r\n    };\r\n    \r\n    self.getClass = function() {\r\n        return el.className;\r\n    }\r\n    \r\n    self.getClassValue = function(c) {\r\n        var vals = el.className.match(new RegExp(\"(^|\\\\s)\"+c+\":([^\\\\s]+)\"));\r\n    \r\n        return vals?((vals[2].indexOf(\":\")+1)?vals[2].split(\":\")\r\n                                             :vals[2])\r\n                   :null;\r\n    };\r\n    \r\n    self.getComputedStyle = function(prop) {\r\n        var y;\r\n        if (el.currentStyle)\r\n            y = prop?el.currentStyle[prop]:el.currentStyle;\r\n        else if (window.getComputedStyle) {\r\n            y = document.defaultView.getComputedStyle(el,null);\r\n            if (prop) y=y[prop];\r\n        } else {\r\n            y = null;\r\n        }\r\n        return y;\r\n    }\r\n    return this;\r\n};\r\n\r\nexport { DOM };\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/dom.js","import { isUndefined, isFunction, isString, isNumber, isNumeric, isArray, isRegExp, isBoolean, isScalar, isEmpty,\r\n    getScriptQuery } from './helpers';\r\nimport { DOM } from './dom';\r\n\r\n\r\nvar EM = new function () {\r\n    var self = this;\r\n    \r\n    var pool = [];\r\n    \r\n    var UID = 0;\r\n    \r\n    var keys = {\r\n        'UEID': '__eventManagerUniqueElementId'\r\n       \r\n    };\r\n    \r\n    \r\n    var rootEventHandler = function (e) {\r\n        unifyEvent(e);\r\n        var id = null\r\n            , hid = null\r\n            , el = e.target\r\n            , fe = true\r\n            , res = true;\r\n\r\n        if (!e.currentTarget || !(id = e.currentTarget[keys.UEID]) || !(hid = pool[id].handler[e.type])) return;\r\n\r\n        try {\r\n            for (var i = 0, hL = hid.length; i < hL; i++) if (isFunction(hid[i])) res = res && !(false === hid[i].call(e.currentTarget, e));\r\n        } catch (err) { setTimeout(function () { throw new Error(\"Event handler for [\" + e.type + \"] has failed with exception: \\\"\" + err.message + \"\\\"\"); }, 10) }\r\n\r\n        return res;\r\n    };\r\n    \r\n    var unloadEventHandler = function unloadEventHandler (e) {\r\n        for (var i = pool.length - 1, pid = null, el = null; i >= 0; i--) {\r\n            if (pool[i] && (el = (pid = pool[i]).node)) {\r\n                for (var z in pid.handler) {\r\n                    if (!pid.handler.hasOwnProperty(z)) continue;\r\n                    try {\r\n                        if (el.removeEventListener) {\r\n                            el.removeEventListener(z, pid.rootEHCaller ? pid.rootEHCaller : rootEventHandler, false);\r\n                        } else if (el.detachEvent) {\r\n                            el.detachEvent('on' + z, pid.rootEHCaller ? pid.rootEHCaller : rootEventHandler);\r\n                        }\r\n                    } catch (e) { }\r\n                    pid.handler[z].length = 0;\r\n                }\r\n            }\r\n            el = pid.node = null;\r\n        }\r\n        if (window.removeEventListener) {\r\n            window.removeEventListener(z, unloadEventHandler, false);\r\n        } else {\r\n            window.detachEvent('on' + z, unloadEventHandler);\r\n        }\r\n    };\r\n    \r\n    \r\n    var unifyEvent = function (e) {\r\n        var i = self.EU.length\r\n            , cur, cur1, k, init\r\n        while (i--) {\r\n            cur = self.EU[i];\r\n            if (cur[0].test(e.type)) {\r\n                k = cur[1].length;\r\n                init = null;\r\n                while (k--) {\r\n                    cur1 = cur[1][k];\r\n                    if ('init' == cur1[0]) init = cur1[1]\r\n                    else if (!e[cur1[0]]) e[cur1[0]] = cur1[1];\r\n                }\r\n                if (init) init.call(e);\r\n            }\r\n        }\r\n        if (!e.target && e.type != 'unload') e.target = e.srcElement;\r\n        return e;\r\n    };\r\n    \r\n    var getUEID = function (el, f) {\r\n        return el[keys.UEID] || (f && (el[keys.UEID] = ++UID));\r\n    };\r\n    \r\n    \r\n    self.addEventListener = function (el, et, h) {\r\n        if (!el || !isFunction(h)) return false;\r\n       \r\n        \r\n        var id = getUEID(el, true)\r\n            , pid = null\r\n            , hid = null;\r\n\r\n        \r\n        if (!pool[id]) {\r\n            pool[id] = {\r\n                'node': el\r\n                , 'handler': {}\r\n            }\r\n        };\r\n        pid = pool[id];\r\n        \r\n        if (!pid.handler.hasOwnProperty(et)) {\r\n            pid.handler[et] = [];\r\n            \r\n            if (el.addEventListener) {\r\n                el.addEventListener(et, rootEventHandler, false);\r\n            } else if (el.attachEvent) {\r\n                \r\n                pid.rootEHCaller = function (e) {\r\n                    e.currentTarget = pid.node;//pool[id].node;\r\n                    var res = rootEventHandler(e);\r\n                    e.currentTarget = null;\r\n                    return res;\r\n                };\r\n                el.attachEvent('on' + et, pid.rootEHCaller);\r\n            }\r\n        };\r\n        hid = pid.handler[et];\r\n        \r\n        if (hid.indexOf(h) == -1) {\r\n            hid[hid.length] = h;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    \r\n    self.removeEventListener = function (el, et, h) {\r\n        if (!el || !isFunction(h)) return false;\r\n        var id = getUEID(el)\r\n            , pid = pool[id]\r\n            , eid = null;\r\n        if (pid && (eid = pid.handler[et])) {\r\n            \r\n            eid.splice(eid.indexOf(h), 1);\r\n            if (0 == eid.length) {\r\n                delete pid.handler[et];\r\n                \r\n                if (el.removeEventListener) {\r\n                    el.removeEventListener(et, pid.rootEHCaller ? pid.rootEHCaller : rootEventHandler, false);\r\n                } else if (el.detachEvent) {\r\n                    el.detachEvent('on' + et, pid.rootEHCaller ? pid.rootEHCaller : rootEventHandler);\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    \r\n    self.dispatchEvent = function (e) {\r\n        var res = rootEventHandler(e);\r\n        return res;\r\n    };\r\n    \r\n    self.registerEvent = function (o, n, b, d) {\r\n        var id = getUEID(o, true);\r\n        if (!pool[id]) {\r\n            pool[id] = {\r\n                'node': o,\r\n                'handler': []\r\n            };\r\n        } else {\r\n            pool[id].node = o;\r\n        }\r\n        return new EM.EventTarget(o, n, b, d);\r\n    };\r\n    \r\n    var __construct = function () {\r\n        \r\n        if (window.attachEvent && !window.addEventListener) {\r\n            window.attachEvent('onunload', unloadEventHandler);\r\n        }\r\n    };\r\n    __construct();\r\n};\r\n\r\nEM.preventDefaultAction = function (e) {\r\n    e.preventDefault();\r\n}\r\nEM.stopPropagationAction = function (e) {\r\n    e.stopPropagation();\r\n}\r\n\r\n\r\n\r\nEM.EventTarget = function (obj, name, bubble, def) {\r\n    var self = this;\r\n\r\n    \r\n    var canBubble = !!bubble;\r\n    \r\n    var defaultAction = isFunction(def) ? def : null;\r\n    \r\n    \r\n    \r\n    self.trigger = function (el, data) {\r\n        if (!(arguments.length - 1) && el != obj) {\r\n            data = el;\r\n            el = null;\r\n        }\r\n        if (!el) el = obj;\r\n        var e = {}\r\n            , res = true\r\n            , undef = true\r\n            , tmp = null\r\n        for (var i in data) {\r\n            if (data.hasOwnProperty(i)) e[i] = data[i];\r\n        }\r\n\r\n        \r\n        canBubble = !!bubble;\r\n        defaultAction = def;\r\n\r\n        \r\n        do {\r\n            e.preventDefault = preventDefault;\r\n            e.stopPropagation = stopPropagation;\r\n            e.target = el;\r\n            e.currentTarget = el;\r\n            e.type = name;\r\n            tmp = EM.dispatchEvent(e);\r\n            undef &= (isUndefined(tmp))\r\n            res &= !(false === tmp);\r\n        } while ((el = el.parentNode) && canBubble);\r\n        \r\n        if (isFunction(defaultAction) && res && !undef) {\r\n            defaultAction(e);\r\n        }\r\n        return (defaultAction && res && !undef);\r\n    };\r\n    \r\n    var preventDefault = function () {\r\n        defaultAction = null;\r\n    };\r\n    \r\n    var stopPropagation = function () {\r\n        canBubble = false;\r\n    };\r\n};\r\n\r\nEM.EU = [\r\n    [/./, [\r\n        \r\n        ['preventDefault', function () {\r\n            this.returnValue = false;\r\n        }\r\n        ]\r\n        \r\n        , ['stopPropagation', function () {\r\n            this.cancelBubble = true;\r\n        }\r\n        ]\r\n    ]]\r\n    , [/^mouse(over|out|down|up)/, [\r\n        \r\n        ['getButton', function () {\r\n            return this.button == 2 ? 2 : 1\r\n        }\r\n        ]\r\n        , ['EM_MB_LEFT', '1']\r\n        , ['EM_MB_RIGHT', '2']\r\n    ]]\r\n    , [/^key(down|up|press)/, [\r\n        \r\n        ['getKeyCode', function () {\r\n            switch (this.keyCode) {\r\n                case 189: return 109;\r\n                case 187: return 61; \r\n                case 107: return 61; \r\n                case 186: return 59;\r\n                default: return this.keyCode;\r\n            }\r\n        }\r\n        ]\r\n        \r\n        , ['getRepeat', function getRepeat() {\r\n            return getRepeat.repeat\r\n        }\r\n        ]\r\n        , ['init', function () {\r\n            var ac = this.getRepeat\r\n            if ('keyup' == this.type) {\r\n                ac.repeat = 0;\r\n                ac.keyCode = 0;\r\n            } else if ('keydown' == this.type) {\r\n                ac.repeat = ac.keyCode == this.keyCode;\r\n                ac.keyCode = this.keyCode;\r\n            }\r\n        }\r\n        ]\r\n    ]]\r\n\r\n];\r\n\r\n\r\n(function () {\r\n\r\n    var evt = EM.registerEvent(window, 'domload')\r\n        , executed = false\r\n        , clearEvents = function () {\r\n           \r\n            EM.removeEventListener(document, 'propertychange', handlers.ie);\r\n           \r\n            EM.removeEventListener(document, 'DOMContentLoaded', handlers.mz);\r\n           \r\n            EM.removeEventListener(window, 'load', handlers.mz);\r\n        }\r\n        , handlers = {\r\n            'ie': function (e) {\r\n                if (window.event.propertyName == 'activeElement' && !executed) {\r\n                    evt.trigger(window);\r\n                    clearEvents();\r\n                    executed = true;\r\n                }\r\n            }\r\n            , 'mz': function (e) { if (!executed) evt.trigger(window); executed = true; }\r\n        };\r\n\r\n   \r\n    EM.addEventListener(document, 'propertychange', handlers.ie);\r\n   \r\n    EM.addEventListener(document, 'DOMContentLoaded', handlers.mz);\r\n   \r\n    if (/WebKit|Khtml/i.test(navigator.userAgent) || (window.opera && parseInt(window.opera.version()) < 9))\r\n        (function argumentsCalleeFixFn() { if (!executed) /loaded|complete/.test(document.readyState) ? (evt.trigger(window), executed = true) : setTimeout(argumentsCalleeFixFn, 100) })();\r\n   \r\n    EM.addEventListener(window, 'load', handlers.mz);\r\n})();\r\n\r\nexport { EM };\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/eventmanager.js","var IME = new function () {\n    var self = this;\n    var html = \"<div id=\\\"VirtualKeyboardIME\\\"><table><tr><td class=\\\"IMEControl\\\"><div class=\\\"left\\\"><!-- --></div></td>\"\n        + \"<td class=\\\"IMEControl IMEContent\\\"></td>\"\n        + \"<td class=\\\"IMEControl\\\"><div class=\\\"right\\\"><!-- --></div></td></tr>\"\n        + \"<tr><td class=\\\"IMEControl IMEInfo\\\" colspan=\\\"3\\\"><div class=\\\"showAll\\\"><div class=\\\"IMEPageCounter\\\"></div><div class=\\\"arrow\\\"></div></div></td></tr></div>\";\n    var ime = null;\n    var chars = \"\";\n    var page = 0;\n    var showAll = false;\n    var sg = [];\n    var target = null;\n    var targetWindow = null;\n\n        self.show = function (s) {\n        target = VirtualKeyboard.getAttachedInput();\n        var win = DOM.getWindow(target);\n                if (targetWindow != win) {\n            if (ime && ime.parentNode) {\n                ime.parentNode.removeChild(ime);\n            }\n            targetWindow = win;\n            __createImeToolbar();\n            targetWindow.document.body.appendChild(ime);\n        }\n                ime.className = self.css\n\n        if (s) self.setSuggestions(s);\n        if (target && ime && sg.length > 0) {\n            EM.addEventListener(target, 'blur', self.blurHandler);\n            ime.style.display = \"block\";\n            self.updatePosition(target);\n        } else if ('none' != ime.style.display) {\n            self.hide();\n        }\n    }\n\n        self.hide = function (keep) {\n        if (ime && 'none' != ime.style.display) {\n            ime.style.display = \"none\";\n            EM.removeEventListener(target, 'blur', self.blurHandler);\n            if (target && DocumentSelection.getSelection(target) && !keep)\n                DocumentSelection.deleteSelection(target);\n            target = null;\n            sg = [];\n        }\n    }\n        self.updatePosition = function () {\n        var xy = DOM.getOffset(target);\n        ime.style.left = xy.x + 'px';\n        var co = DocumentSelection.getSelectionOffset(target);\n        ime.style.top = xy.y + co.y + co.h + 'px';\n    }\n        self.setSuggestions = function (arr) {\n        if (!isArray(arr)) return false;\n        sg = arr;\n        page = 0;\n        showPage();\n        self.updatePosition(target);\n    }\n        self.getSuggestions = function (idx) {\n        return isNumber(idx) ? sg[idx] : sg;\n    }\n        self.nextPage = function (e) {\n        page = Math.max(Math.min(page + 1, (Math.ceil(sg.length / 10)) - 1), 0);\n        showPage();\n    }\n        self.prevPage = function (e) {\n        page = Math.max(page - 1, 0);\n        showPage();\n    }\n        self.getPage = function () {\n        return page;\n    }\n        self.getChar = function (n) {\n        n = --n < 0 ? 9 : n;\n        return sg[self.getPage() * 10 + n]\n    }\n    self.isOpen = function () {\n        return ime && 'block' == ime.style.display;\n    }\n        self.blurHandler = function (e) {\n        self.hide();\n    }\n        self.toggleShowAll = function (e) {\n        var sa = ime.firstChild.rows[1].cells[0].lastChild;\n        if (showAll = !showAll) {\n            page = 0;\n            sa.className = 'showPage';\n        } else {\n            sa.className = 'showAll';\n        }\n        showPage();\n    }\n        var showPage = function () {\n        var s = ['<table>'];\n        for (var z = 0, pL = Math.ceil(sg.length / 10); z < pL; z++) {\n            if (showAll || z == page) {\n                s.push('<tr>');\n                for (var i = 0, p = z * 10; i < 10 && !isUndefined(sg[p + i]); i++) {\n                    s.push(\"<td><a href=''>\")\n                    if (z == page) {\n                        s.push(\"<b>&nbsp;\" + ((i + 1) % 10) + \": </b>\");\n                    } else {\n                        s.push(\"<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>\");\n                    }\n                    s.push(sg[p + i] + \"</a></td>\");\n                }\n                s.push('</tr>');\n            }\n        }\n        s.push('</table>');\n        ime.firstChild.rows[0].cells[1].innerHTML = s.join(\"\");\n       \n        ime.firstChild.rows[1].cells[0].firstChild.firstChild.innerHTML = (page + 1) + \"/\" + (0 + showAll || Math.ceil(sg.length / 10));\n       \n        var els = ime.getElementsByTagName(\"*\");\n        for (var i = 0, eL = els.length; i < eL; i++) {\n            els[i].unselectable = \"on\";\n        }\n    }\n        var pasteSuggestion = function (e) {\n        var el = DOM.getParent(e.target, 'a');\n        if (el) {\n            DocumentSelection.insertAtCursor(target, el.lastChild.nodeValue);\n            self.hide();\n        }\n        e.preventDefault();\n    }\n\n        var __createImeToolbar = function () {\n        var el = targetWindow.document.createElement('div');\n        el.innerHTML = html;\n        ime = el.firstChild;\n        ime.style.display = 'none';\n        var arrl = ime.firstChild.rows[0].cells[0]\n            , arrr = ime.firstChild.rows[0].cells[2]\n            , arrd = ime.firstChild.rows[1].cells[0].lastChild\n        EM.addEventListener(arrl, 'mousedown', self.prevPage);\n        EM.addEventListener(arrl, 'mousedown', EM.preventDefaultAction);\n        EM.addEventListener(arrl, 'mousedown', EM.stopPropagationAction);\n        EM.addEventListener(arrr, 'mousedown', self.nextPage);\n        EM.addEventListener(arrr, 'mousedown', EM.preventDefaultAction);\n        EM.addEventListener(arrr, 'mousedown', EM.stopPropagationAction);\n        EM.addEventListener(arrd, 'mousedown', self.toggleShowAll);\n        EM.addEventListener(arrd, 'mousedown', EM.preventDefaultAction);\n        EM.addEventListener(arrd, 'mousedown', EM.stopPropagationAction);\n                ime.unselectable = \"on\";\n        var els = ime.getElementsByTagName(\"*\");\n        for (var i = 0, eL = els.length; i < eL; i++) {\n            els[i].unselectable = \"on\";\n        }\n\n        EM.addEventListener(ime, 'mousedown', pasteSuggestion);\n    }\n};\n\nexport { IME };\n\n\n// WEBPACK FOOTER //\n// ./src/ime.js"],"sourceRoot":""}