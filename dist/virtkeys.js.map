{"version":3,"sources":["webpack:///webpack/bootstrap f27134300cdee02fba61","webpack:///./src/virtualkeyboard.js","webpack:///./src/extensions/helpers.js","webpack:///./src/extensions/ext/array.js","webpack:///./src/extensions/ext/object.js","webpack:///./src/extensions/ext/regexp.js","webpack:///./src/extensions/ext/string.js","webpack:///./src/extensions/documentcookie.js","webpack:///./src/extensions/documentselection.js","webpack:///./src/extensions/dom.js","webpack:///./src/extensions/eventmanager.js","webpack:///./src/extensions/scriptqueue.js","webpack:///./src/ime.js"],"names":["VirtualKeyboard","self","$VERSION$","options","idPrefix","animate","controlKeys","KEY","keymap","keymaps","mode","VK_NORMAL","VK_SHIFT","VK_ALT","VK_CTRL","VK_CAPS","VK_CTRL_CAPS","VK_CTRL_SHIFT","VK_ALT_CAPS","VK_ALT_CTRL","VK_ALT_CTRL_CAPS","VK_ALT_SHIFT","VK_SHIFT_ALT_CTRL","VK_SHIFT_CAPS","VK_ALL","cssClasses","lang","layout","hash","codes","codeFilter","nodes","keyboard","desk","langbox","attachedInput","newKeyCode","addLayoutList","i","aL","arguments","length","addLayout","l","code","entityDecode","split","name","alpha","__doParse","normal","Error","domain","hasOwnProperty","toString","push","switchLayout","__buildOptionsList","IME","hide","selected","__prepareLayout","html","__getKeyboardHtml","innerHTML","className","css","__updateLayout","activate","__toggleInputDir","set","getLayouts","lts","lL","sort","setVisibleLayoutCodes","filter","cL","toUpperCase","value","getLayoutCodes","heapSort","_keyClicker_","key","evt","chr","ret","replace","CAPS","SHIFT","ALT","charProcessor","getSelection","deleteAtCursor","el","document","getElementById","__charProcessor","charCodeAt","contentDocument","ck","createEvent","initKeyEvent","contentWindow","ex","VK_bypass","dispatchEvent","keyCode","e","insertAtCursor","setRange","_keydownHandler_","isOpen","newMode","getKeyCode","type","prevPage","nextPage","childNodes","getRepeat","CSS","addClass","buttonDown","id","preventDefault","start","getStart","shiftKey","ctrlKey","altKey","srcElement","removeClass","stopPropagation","__updateControlKeys","_btnClick_","getParent","target","parentNode","indexOf","substring","hasClass","_btnMousedown_","_btnMouseInOut_","mtd","__toggleControlKeysState","CTRL","__toggleKeyState","toLowerCase","switchMapping","attachInput","detachInput","tagName","noanim","body","addEventListener","blurHandler","oe","removeEventListener","getAttachedInput","open","show","input","holder","kpTarget","nodeType","appendChild","close","removeChild","toggle","reset","rtl","dir","s","o","n","cc","sL","z","label","createElement","createTextNode","match","map","a","String","fromCharCodeExt","join","shift","alt","shift_alt","caps","shift_caps","dk","cbk","cs","ca","csa","csc","ics","ica","icsa","icc","icsc","lt","char_normal","char_alt","char_caps","char_shift","char","parseInt","fromCharCode","modeNormal","modeShift","modeAlt","modeShiftAlt","modeCaps","modeShiftCaps","modeShiftAltCaps","changes","state","prefix","s1","s2","getClass","hoverShift","hoverAlt","buttonHover","suffix","tchr","buf","res","dks","idx","charAt","inp","style","position","left","btns","title","buttonUp","__getCharHtmlForKey","charNormal","charShift","charAlt","charShiftAlt","charCaps","charShiftCaps","splice","lyt","deadkey","hiddenCaps","hiddenShift","hiddenShiftCaps","hiddenAlt","unselectable","firstChild","item","nextSibling","mapGroup","get","c","tk","kL","lastChild","preventDefaultAction","onmousedown","opts","vk_layout","Langs","$","fn","virtkeys","_open","_close","_toggle","_getLayoutCodes","_switchLayout","addLayouts","_addLayouts","getLoadedLayouts","_getLoadedLayouts","enableIME","_enableIME","addIMELanguages","_addIMELanguages","layouts","_layouts","ime","undefined","_ime","langs","_langs","jQuery","isUndefined","prop","isFunction","isString","isNumber","isNumeric","isNaN","isFinite","isArray","Array","isRegExp","RegExp","isBoolean","isScalar","isEmpty","Boolean","gluePath","findPath","sname","h","getElementsByTagName","sr","m","b","href","location","getScriptQuery","parseQuery","q","qL","rs","kv","rkv","unescape","table2array","ci","section","subsection","DOM","hasTagName","rows","span","ts","ce","rL","tr","cells","innerText","normalize","nodeValue","trim","tL","cd","createElementExt","tag","p","L","k","setAttribute","attachEvent","playInterval","f","setInterval","apply","call","playTimeout","setTimeout","cloneObject","obj","newObject","constructor","oL","mergeObject","oi","concat","unique","slice","loadStyleSheet","sn","hasStyleSheet","head","link","rel","path","test","prototype","copy","tmp","flatten","cols","binSearch","r","len","Math","max","ceil","cnt","sift","arr","low","up","maximal","range","end","inc","mn","min","mx","abs","reverse","Object","escape","text","sRE","specials","ltrim","rtrim","dup","val","valueOf","repeat","padding","pad","padLeft","padRight","sprintf","args","index","frmt","re","x","sign","ins","Number","bin","substr","round","dec","toExponential","toFixed","hex","DocumentCookie","cookie","expire","secure","Date","toGMTString","getTime","isSet","del","Cookie","delAll","pL","parts","DocumentSelection","keys","callMethod","arg","module","keepScroll","ot","ol","window","getSelectionOffset","y","scrollTop","clientHeight","scrollLeft","clientWidth","related","st","getEnd","getCursorPosition","keep","pos","wrapSelection","after","deleteSelection","getContext","offsetCalculator","getPos","r1","r2","r3","r4","r5","selectionStart","selectionEnd","setActive","selection","createRange","moveStart","moveEnd","createTextRange","moveToElementText","sTest","opera","setSelectionRange","collapse","select","doc","getWindow","prevCalcNode","defaultView","getComputedStyle","overflow","visibility","zIndex","top","backgroundColor","width","whiteSpace","getAttribute","border","offsetLeft","offsetTop","offsetHeight","boundingHeight","xy","getOffset","getBodyScrollTop","getBodyScrollLeft","s3","sel","anchorNode","so","anchorOffset","en","focusNode","eo","focusOffset","ss","es","sc","ec","cn","tw","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","rangeCount","getRangeAt","deleteContents","insertNode","addRange","ln","selectNodeContents","pn","replaceChild","extractContents","setStart","setStartAfter","removeAllRanges","cl","setEnd","move","off","contents","cloneContents","endOffset","borderLeft","surroundContents","offsetParent","selectNode","cp","vl","fixBrowserQuirks","height","originalObject","considerScroll","nodeName","clientLeft","clientTop","offsetWidth","getClientWidth","win","w","innerWidth","documentElement","getOffsetWidth","outerWidth","getClientHeight","innerHeight","getOffsetHeight","outerHeight","pageYOffset","pageXOffset","ownerDocument","parentWindow","pageX","pageY","de","clientX","clientY","tags","t","color2rgb","d","ov","vLink","err","setOpacity","opacity","KhtmOpacity","MozOpacity","cache","getClassValue","vals","currentStyle","EM","pool","UID","rootEventHandler","unifyEvent","hid","fe","currentTarget","UEID","handler","hL","message","unloadEventHandler","pid","node","rootEHCaller","detachEvent","EU","cur","cur1","init","getUEID","et","eid","registerEvent","EventTarget","__construct","stopPropagationAction","bubble","def","canBubble","defaultAction","trigger","data","undef","returnValue","cancelBubble","button","ac","executed","clearEvents","handlers","ie","mz","event","propertyName","navigator","userAgent","version","argumentsCalleeFixFn","readyState","ScriptQueue","staticFn","callee","queue","load","queuemonitor","sid","scr","scripts","ls","src","charset","rSrc","onerror","onload","onreadystatechange","loadmonitor","write","ScriptQueueIncludes","chars","page","showAll","sg","targetWindow","__createImeToolbar","setSuggestions","display","updatePosition","co","showPage","getSuggestions","getPage","getChar","toggleShowAll","sa","els","eL","pasteSuggestion","arrl","arrr","arrd"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;ACtCA;;AAEA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA,KAAMA,kBAAkB,IAAI,YAAY;AACpC,SAAIC,OAAO,IAAX;AACAA,UAAKC,SAAL,GAAiB,WAAjB;;AAGA,SAAIC,UAAU;AACV,mBAAU;AADA,MAAd;;AAIA,SAAIC,WAAW,MAAf;;AAEA,SAAIC,UAAU,IAAd;;AAEA,SAAIC,cAAc;AACd,aAAI,WADU;AAEZ,aAAI,KAFQ;AAGZ,aAAI,OAHQ;AAIZ,aAAI,MAJQ;AAKZ,aAAI,YALQ;AAMZ,aAAI,aANQ;AAOZ,aAAI,KAPQ;AAQZ,aAAI,WARQ;AASZ,aAAI,UATQ;AAUZ,aAAI,OAVQ;AAWZ,aAAI,WAXQ;AAYZ,aAAI;AAZQ,MAAlB;;AAeA,SAAIC,MAAM;AACN,kBAAS,OADH;AAEJ,gBAAO,KAFH;AAGJ,iBAAQ,MAHJ;AAIJ,iBAAQ;AAJJ,MAAV;;AAOA,SAAIC,MAAJ;;AAGA,SAAIC,UAAU;AACV,4BAAmB,iDADT;AAER,4BAAmB,iDAFX;AAGR,yBAAgB,iDAHR;AAIR,4BAAmB,iDAJX;AAKR,+BAAsB,iDALd;AAMR,+BAAsB,iDANd;AAOR,4BAAmB,iDAPX;AAQR,2BAAkB,iDARV;AASR,2BAAkB,iDATV;AAUR,8BAAqB,iDAVb;AAWR,gCAAuB,iDAXf;AAYR,2BAAkB,iDAZV;AAaR,yBAAgB,iDAbR;AAcR,2BAAkB,iDAdV;AAeR,sBAAa,iDAfL;AAgBR,4BAAmB,iDAhBX;AAiBR,2BAAkB,iDAjBV;AAkBR,yBAAgB,iDAlBR;AAmBR,0BAAiB,iDAnBT;AAoBR,6BAAoB,iDApBZ;AAqBR,0BAAiB,iDArBT;AAsBR,yBAAgB,iDAtBR;AAuBR,2BAAkB,iDAvBV;AAwBR,0BAAiB,iDAxBT;AAyBR,6BAAoB,iDAzBZ;AA0BR,2BAAkB,iDA1BV;AA2BR,6BAAoB,iDA3BZ;AA4BR,6BAAoB,iDA5BZ;AA6BR,6BAAoB,iDA7BZ;AA8BR,6BAAoB;AA9BZ,MAAd;;AAiCA,SAAIC,OAAO,CAAX;AAAA,SACMC,YAAY,CADlB;AAAA,SAEMC,WAAW,CAFjB;AAAA,SAGMC,SAAS,CAHf;AAAA,SAIMC,UAAU,CAJhB;AAAA,SAKMC,UAAU,CALhB;AAAA,SAMMC,eAAeF,UAAUC,OAN/B;AAAA,SAOME,gBAAgBH,UAAUF,QAPhC;AAAA,SAQMM,cAAcL,SAASE,OAR7B;AAAA,SASMI,cAAcN,SAASC,OAT7B;AAAA,SAUMM,mBAAmBP,SAASC,OAAT,GAAmBC,OAV5C;AAAA,SAWMM,eAAeR,SAASD,QAX9B;AAAA,SAYMU,oBAAoBV,WAAWC,MAAX,GAAoBC,OAZ9C;AAAA,SAaMS,gBAAgBX,WAAWG,OAbjC;AAAA,SAcMS,SAASZ,WAAWC,MAAX,GAAoBC,OAApB,GAA8BC,OAd7C;;AAgBA,SAAIU,aAAa;AACb,qBAAY,UADC;AAEX,uBAAc,cAFH;AAGX,wBAAe,eAHJ;AAIX,uBAAc,YAJH;AAKX,qBAAY,UALD;AAMX,oBAAW,SANA;AAOX,wBAAe,aAPJ;AAQX,qBAAY,UARD;AASX,uBAAc,YATH;AAUX,sBAAa,WAVF;AAWX,yBAAgB,cAXL;AAYX,6BAAoB,kBAZT;AAaX,0BAAiB,eAbN;AAcX,uBAAc,YAdH;AAeX,sBAAa,WAfF;AAgBX,oBAAW,SAhBA;AAiBX,yBAAgB,cAjBL;AAkBX,qBAAY,UAlBD;AAmBX,0BAAiB,eAnBN;AAoBX,sBAAa,WApBF;AAqBX,uBAAc,YArBH;AAsBX,wBAAe,aAtBJ;AAuBX,4BAAmB,iBAvBR;AAwBX,oBAAW,SAxBA;AAyBX,mBAAU;;AAzBC,MAAjB;;AA6BA,SAAIC,OAAO,IAAX;;AAEA,SAAIC,SAAS,EAAb;;AAEAA,YAAOC,IAAP,GAAc,EAAd;;AAEAD,YAAOE,KAAP,GAAe,EAAf;;AAEAF,YAAOG,UAAP,GAAoB,IAApB;;AAEAH,YAAOxB,OAAP,GAAiB,IAAjB;;AAGA,SAAI4B,QAAQ;AACRC,mBAAU,IADF;AAENC,eAAM,IAFA;AAGNC,kBAAS,IAHH;AAINC,wBAAe,IAJT,CAIa;AAJb,MAAZ;;AAOA,SAAIC,aAAa,IAAjB;;AAIAnC,UAAKoC,aAAL,GAAqB,YAAY;AAC7B,cAAK,IAAIC,IAAI,CAAR,EAAWC,KAAKC,UAAUC,MAA/B,EAAuCH,IAAIC,EAA3C,EAA+CD,GAA/C,EAAoD;AAChDrC,kBAAKyC,SAAL,CAAeF,UAAUF,CAAV,CAAf;AACH;AACJ,MAJD;;AAOArC,UAAKyC,SAAL,GAAiB,UAAUC,CAAV,EAAa;;AAE1B,aAAIC,OAAOD,EAAEC,IAAF,CAAOC,YAAP,GAAsBC,KAAtB,CAA4B,GAA5B,CAAX;AAAA,aACMC,OAAOJ,EAAEI,IAAF,CAAOF,YAAP,EADb;AAAA,aAEMG,QAAQC,UAAUN,EAAEO,MAAZ,CAFd;;AAIA,aAAI,CAAC,sBAAQF,KAAR,CAAD,IAAmB,MAAMA,MAAMP,MAAnC,EAA2C,MAAM,IAAIU,KAAJ,CAAU,8EAA8EH,MAAMP,MAApF,GAA6F,0BAA7F,GAA0HG,IAA1H,GAAiI,iBAAjI,GAAqJG,IAA/J,CAAN;;AAG3CJ,WAAEC,IAAF,GAAUA,KAAK,CAAL,KAAWA,KAAK,CAAL,CAArB;AACAD,WAAEI,IAAF,GAASA,IAAT;AACAJ,WAAEO,MAAF,GAAWF,KAAX;AACAL,WAAES,MAAF,GAAWR,KAAK,CAAL,CAAX;;AAGA,aAAIjB,OAAOC,IAAP,CAAYyB,cAAZ,CAA2BV,EAAEC,IAAF,GAAS,GAAT,GAAeD,EAAEI,IAA5C,CAAJ,EACI;;AAGJ,aAAI,CAACpB,OAAOE,KAAP,CAAawB,cAAb,CAA4BV,EAAEC,IAA9B,CAAL,EACIjB,OAAOE,KAAP,CAAac,EAAEC,IAAf,IAAuBD,EAAEC,IAAzB;;AAGJD,WAAEW,QAAF,GAAa,YAAY;AAAE,oBAAO,KAAKV,IAAL,GAAY,GAAZ,GAAkB,KAAKG,IAA9B;AAAoC,UAA/D;;AAEApB,gBAAO4B,IAAP,CAAYZ,CAAZ;;AAGAhB,gBAAOxB,OAAP,GAAiB,IAAjB;AACH,MA7BD;;AA+BAF,UAAKuD,YAAL,GAAoB,UAAUZ,IAAV,EAAgB;;AAEhCa;;AAEA,aAAI,CAAC9B,OAAOxB,OAAP,CAAekD,cAAf,CAA8BT,IAA9B,CAAL,EAA0C,OAAO,KAAP;;AAG1C3C,cAAKyD,GAAL,CAASC,IAAT;;AAGA5B,eAAMG,OAAN,CAAc/B,OAAd,CAAsBwB,OAAOxB,OAAP,CAAeyC,IAAf,CAAtB,EAA4CgB,QAA5C,GAAuD,IAAvD;;AAEAlC,gBAAOC,OAAOA,OAAOC,IAAP,CAAYgB,IAAZ,CAAP,CAAP;AACA,aAAI,CAAC,sBAAQlB,IAAR,CAAL,EAAoBA,OAAOC,OAAOA,OAAOC,IAAP,CAAYgB,IAAZ,CAAP,IAA4BiB,gBAAgBnC,IAAhB,CAAnC;;AAEpB,aAAI,CAAC,sBAAQA,IAAR,CAAL,EAAoB;AAChBA,oBAAOC,OAAOA,OAAOC,IAAP,CAAYgB,IAAZ,CAAP,IAA4BiB,gBAAgBnC,IAAhB,CAAnC;AACH;AACD,aAAI,CAACA,KAAKoC,IAAV,EAAgB;AACZpC,kBAAKoC,IAAL,GAAYC,kBAAkBrC,IAAlB,CAAZ;AACH;;AAEDK,eAAME,IAAN,CAAW+B,SAAX,GAAuBtC,KAAKoC,IAA5B;;AAGA/B,eAAMC,QAAN,CAAeiC,SAAf,GAA2BvC,KAAK0B,MAAhC;AACAnD,cAAKyD,GAAL,CAASQ,GAAT,GAAexC,KAAK0B,MAApB;;AAGA1C,gBAAOC,SAAP;AACAwD;;AAEA,aAAI,yBAAWzC,KAAK0C,QAAhB,CAAJ,EAA+B;AAC3B1C,kBAAK0C,QAAL;AACH;;AAEDC;;AAEA,wCAAeC,GAAf,CAAmB,WAAnB,EAAgC1B,IAAhC;AACA,gBAAO,IAAP;AACH,MAxCD;;AA2CA3C,UAAKsE,UAAL,GAAkB,YAAY;AAC1B,aAAIC,MAAM,EAAV;AACA,cAAK,IAAIlC,IAAI,CAAR,EAAWmC,KAAK9C,OAAOc,MAA5B,EAAoCH,IAAImC,EAAxC,EAA4CnC,GAA5C,EAAiD;AAC7CkC,iBAAIA,IAAI/B,MAAR,IAAkB,CAACd,OAAOW,CAAP,EAAUM,IAAX,EAAiBjB,OAAOW,CAAP,EAAUS,IAA3B,CAAlB;AACH;AACD,gBAAOyB,IAAIE,IAAJ,EAAP;AACH,MAND;;AAQAzE,UAAK0E,qBAAL,GAA6B,YAAY;AACrC,aAAI9C,QAAQ,sBAAQW,UAAU,CAAV,CAAR,IAAwBA,UAAU,CAAV,CAAxB,GAAuCA,SAAnD;AAAA,aACMoC,SAAS,IADf;AAAA,aAEMhC,IAFN;;AAIA,cAAK,IAAIN,IAAI,CAAR,EAAWuC,KAAKhD,MAAMY,MAA3B,EAAmCH,IAAIuC,EAAvC,EAA2CvC,GAA3C,EAAgD;AAC5CM,oBAAOf,MAAMS,CAAN,EAASwC,WAAT,EAAP;AACA,iBAAI,CAACnD,OAAOE,KAAP,CAAawB,cAAb,CAA4BT,IAA5B,CAAL,EACI;AACJ,iBAAI,CAACgC,MAAL,EACIA,SAAS,EAAT;AACJA,oBAAOhC,IAAP,IAAeA,IAAf;AACH;AACDjB,gBAAOG,UAAP,GAAoB8C,MAApB;;AAGAjD,gBAAOxB,OAAP,GAAiB,IAAjB;;AAEA,aAAI,CAACF,KAAKuD,YAAL,CAAkBzB,MAAMG,OAAN,CAAc6C,KAAhC,CAAL,EAA6C;;AAEzC9E,kBAAKuD,YAAL,CAAkBzB,MAAMG,OAAN,CAAc6C,KAAhC;AACH;AACJ,MAtBD;;AAwBA9E,UAAK+E,cAAL,GAAsB,YAAY;AAC9B,aAAInD,QAAQ,EAAZ;AACA,cAAK,IAAIS,CAAT,IAAcX,OAAOE,KAArB,EAA4B;AACxB,iBAAI,CAACF,OAAOE,KAAP,CAAawB,cAAb,CAA4Bf,CAA5B,CAAL,EACI;AACJT,mBAAM0B,IAAN,CAAWjB,CAAX;AACH;AACD,gBAAOT,MAAMoD,QAAN,EAAP;AACH,MARD;;AAaA,SAAIC,eAAe,SAAfA,YAAe,CAAUC,GAAV,EAAeC,GAAf,EAAoB;AACnC,aAAIC,MAAM,EAAV;AAAA,aACMC,MAAM,KADZ;AAEAH,eAAMA,IAAII,OAAJ,CAAYnF,QAAZ,EAAsB,EAAtB,CAAN;AACA,iBAAQ+E,GAAR;AACI,kBAAK5E,IAAIiF,IAAT;AACA,kBAAKjF,IAAIkF,KAAT;AACA,kBAAK,YAAL;AACA,kBAAK,aAAL;AACA,kBAAKlF,IAAImF,GAAT;AACA,kBAAK,UAAL;AACA,kBAAK,WAAL;AACI,wBAAO,IAAP;AACJ,kBAAK,WAAL;;AAEI,qBAAI,yBAAWhE,KAAKiE,aAAhB,KAAkC,qCAAkBC,YAAlB,CAA+B7D,MAAMI,aAArC,EAAoDM,MAA1F,EAAkG;AAC9F4C,2BAAM,MAAN;AACH,kBAFD,MAEO,IAAID,GAAJ,EAAS;AACZnF,0BAAKyD,GAAL,CAASC,IAAT,CAAc,IAAd;AACA,4BAAO,IAAP;AACH,kBAHM,MAGA;AACH,0DAAkBkC,cAAlB,CAAiC9D,MAAMI,aAAvC,EAAsD,KAAtD;AACAlC,0BAAKyD,GAAL,CAASC,IAAT,CAAc,IAAd;AACH;AACD;AACJ,kBAAK,KAAL;AACI1D,sBAAKyD,GAAL,CAASC,IAAT,CAAc,IAAd;AACA,qBAAIyB,GAAJ,EACI,OAAO,IAAP;AACJ,sDAAkBS,cAAlB,CAAiC9D,MAAMI,aAAvC,EAAsD,IAAtD;AACA;AACJ,kBAAK,OAAL;AACIkD,uBAAM,GAAN;AACA;AACJ,kBAAK,KAAL;AACIA,uBAAM,IAAN;AACA;AACJ,kBAAK,OAAL;AACIA,uBAAM,IAAN;AACA;AACJ;AACI,qBAAIS,KAAKC,SAASC,cAAT,CAAwB5F,WAAW+E,GAAnC,CAAT;AACAE,uBAAM3D,KAAKyD,GAAL,EAAUzE,IAAV,CAAN;AACA;AAvCR;AAyCA,aAAI2E,GAAJ,EAAS;;AAEL,iBAAI,EAAEA,MAAMY,gBAAgBZ,GAAhB,EAAqB,qCAAkBO,YAAlB,CAA+B7D,MAAMI,aAArC,CAArB,CAAR,CAAJ,EAAwF,OAAOmD,GAAP;;AAExF,iBAAI;;AAEA,qBAAID,IAAI,CAAJ,KAAUA,IAAI,CAAJ,EAAO5C,MAAP,GAAgB,CAA1B,IAA+B4C,IAAIa,UAAJ,CAAe,CAAf,IAAoB,MAAnD,IAA6DnE,MAAMI,aAAN,CAAoBgE,eAAjF,IAAoG,QAAQd,IAAI,CAAJ,CAAhH,EAAwH;AACpH,2BAAM,IAAIlC,KAAJ,EAAN;AACH;AACD,qBAAIiD,KAAKf,IAAI,CAAJ,EAAOa,UAAP,CAAkB,CAAlB,CAAT;;AAEA,qBAAI,yBAAWH,SAASM,WAApB,CAAJ,EAAsC;AAClC,yBAAIjB,MAAM,IAAV;AACA,yBAAI;AACAA,+BAAMW,SAASM,WAAT,CAAqB,WAArB,CAAN;AACAjB,6BAAIkB,YAAJ,CAAiB,UAAjB,EAA6B,KAA7B,EAAoC,IAApC,EAA0CvE,MAAMI,aAAN,CAAoBoE,aAA9D,EAA6E,KAA7E,EAAoF,KAApF,EAA2F,KAA3F,EAAkG,KAAlG,EAAyG,CAAzG,EAA4GH,EAA5G;AACH,sBAHD,CAGE,OAAOI,EAAP,EAAW;;AAETpB,+BAAMW,SAASM,WAAT,CAAqB,gBAArB,CAAN;AACAjB,6BAAIkB,YAAJ,CAAiB,UAAjB,EAA6B,KAA7B,EAAoC,IAApC,EAA0CvE,MAAMI,aAAN,CAAoBoE,aAA9D,EAA6E,KAA7E,EAAoF,KAApF,EAA2F,KAA3F,EAAkG,KAAlG,EAAyGH,EAAzG,EAA6G,CAA7G;AACH;AACDhB,yBAAIqB,SAAJ,GAAgB,IAAhB;AACA1E,2BAAMI,aAAN,CAAoBuE,aAApB,CAAkCtB,GAAlC;AACH,kBAZD,MAYO;AACHA,yBAAIuB,OAAJ,GAAc,MAAMP,EAAN,GAAW,EAAX,GAAgBA,EAA9B;AACAd,2BAAM,IAAN;AACH;AACJ,cAvBD,CAuBE,OAAOsB,CAAP,EAAU;AACR,sDAAkBC,cAAlB,CAAiC9E,MAAMI,aAAvC,EAAsDkD,IAAI,CAAJ,CAAtD;;AAEA,qBAAIA,IAAI,CAAJ,CAAJ,EAAY;AACR,0DAAkByB,QAAlB,CAA2B/E,MAAMI,aAAjC,EAAgD,CAACkD,IAAI,CAAJ,CAAjD,EAAyD,CAAzD,EAA4D,IAA5D;AACH;AACJ;AACJ;AACD,gBAAOC,GAAP;AACH,MAjFD;;AAmFA,SAAIyB,mBAAmB,SAAnBA,gBAAmB,CAAUH,CAAV,EAAa;;AAEhC,aAAI,CAAC3G,KAAK+G,MAAL,EAAL,EAAoB;;AAEpB,aAAIC,UAAUvG,IAAd;;AAEA,aAAIiG,UAAUC,EAAEM,UAAF,EAAd;AACA,iBAAQN,EAAEO,IAAV;AACI,kBAAK,SAAL;AACI,yBAAQR,OAAR;AACI,0BAAK,EAAL;AACI,6BAAI1G,KAAKyD,GAAL,CAASsD,MAAT,EAAJ,EAAuB;AACnB/G,kCAAKyD,GAAL,CAAS0D,QAAT,CAAkBR,CAAlB;AACA;AACH;AACD;AACJ,0BAAK,EAAL;AACI,6BAAI3G,KAAKyD,GAAL,CAASsD,MAAT,EAAJ,EAAuB;AACnB/G,kCAAKyD,GAAL,CAAS2D,QAAT,CAAkBT,CAAlB;AACA;AACH;AACD;AACJ,0BAAK,CAAL;AACA,0BAAK,CAAL;AACA,0BAAK,EAAL;AACI,6BAAId,KAAK/D,MAAME,IAAN,CAAWqF,UAAX,CAAsB9G,OAAOmG,OAAP,CAAtB,CAAT;;AAEA,6BAAItG,WAAW,CAACuG,EAAEW,SAAF,EAAhB,EAA+B,SAAIC,GAAJ,CAAQ1B,EAAR,EAAY2B,QAAZ,CAAqBhG,WAAWiG,UAAhC;AAC/B,6BAAI,CAACxC,aAAaY,GAAG6B,EAAhB,EAAoBf,CAApB,CAAL,EAA6BA,EAAEgB,cAAF;;AAE7B;AACJ,0BAAK,EAAL;AACI,6BAAI,CAAChB,EAAEW,SAAF,EAAL,EAAoB;AAChBN,uCAAUA,UAAUlG,OAApB;AACH;AACD;AACJ,0BAAK,EAAL;AACI,6BAAId,KAAKyD,GAAL,CAASsD,MAAT,EAAJ,EAAuB;AACnB/G,kCAAKyD,GAAL,CAASC,IAAT;AACH,0BAFD,MAEO;AACH,iCAAIkE,QAAQ,qCAAkBC,QAAlB,CAA2B/F,MAAMI,aAAjC,CAAZ;AACA,kEAAkB2E,QAAlB,CAA2B/E,MAAMI,aAAjC,EAAgD0F,KAAhD,EAAuDA,KAAvD;AACH;AACD,gCAAO,KAAP;AACJ;AACI,6BAAI,CAACjB,EAAEW,SAAF,EAAL,EAAoB;AAChBN,uCAAUA,UAAUL,EAAEmB,QAAZ,GAAuBnB,EAAEoB,OAAF,IAAa,CAApC,GAAwCpB,EAAEqB,MAAF,IAAY,CAA9D;AACH;AACD,6BAAIzH,OAAO6C,cAAP,CAAsBsD,OAAtB,CAAJ,EAAoC;AAChC,iCAAI,EAAEC,EAAEqB,MAAF,GAAWrB,EAAEoB,OAAf,CAAJ,EAA6B;AACzB,qCAAIlC,KAAK/D,MAAME,IAAN,CAAWqF,UAAX,CAAsB9G,OAAOmG,OAAP,CAAtB,CAAT;AACA,qCAAItG,OAAJ,EAAa,SAAImH,GAAJ,CAAQ1B,EAAR,EAAY2B,QAAZ,CAAqBhG,WAAWiG,UAAhC;;AAEbtF,8CAAa0D,GAAG6B,EAAhB;AACH;AACD,iCAAIf,EAAEqB,MAAF,IAAYrB,EAAEoB,OAAlB,EAA2B;AACvBpB,mCAAEgB,cAAF;;AAEA,qCAAIhB,EAAEsB,UAAN,EAAkB;AACdhD,kDAAanD,MAAME,IAAN,CAAWqF,UAAX,CAAsB9G,OAAOmG,OAAP,CAAtB,EAAuCgB,EAApD,EAAwDf,CAAxD;AACAxE,kDAAa,EAAb;AACH;AACJ;AACJ,0BAfD,MAeO;AACHnC,kCAAKyD,GAAL,CAASC,IAAT;AACH;AACD;AAzDR;AA2DA;AACJ,kBAAK,OAAL;AACI,yBAAQgD,OAAR;AACI,0BAAK,EAAL;AACI;AACJ;AACI,6BAAI,CAACC,EAAEW,SAAF,EAAL,EAAoB;AAChBN,uCAAUvG,QAAQc,UAAU,CAACoF,EAAEmB,QAAH,GAAe,CAACnB,EAAEoB,OAAH,IAAc,CAA7B,GAAmC,CAACpB,EAAEqB,MAAH,IAAa,CAA1D,CAAR,CAAV;AACH;AACD,6BAAI5H,WAAWG,OAAO6C,cAAP,CAAsBsD,OAAtB,CAAf,EAA+C;AAC3C,sCAAIa,GAAJ,CAAQzF,MAAME,IAAN,CAAWqF,UAAX,CAAsB9G,OAAOmG,OAAP,CAAtB,CAAR,EAAgDwB,WAAhD,CAA4D1G,WAAWiG,UAAvE;AACH;AATT;AAWA;AACJ,kBAAK,UAAL;;AAEI,qBAAItF,cAAc,CAACwE,EAAEH,SAArB,EAAgC;AAC5B,yBAAI,CAACvB,aAAa9C,UAAb,EAAyBwE,CAAzB,CAAL,EAAkC;AAC9BA,2BAAEwB,eAAF;;AAEAxB,2BAAEgB,cAAF;AACH;;AAEDxF,kCAAa,IAAb;AACH;AACD,qBAAI,CAAC1B,IAAD,GAAQS,WAAR,KAAwByF,EAAEqB,MAAF,IAAYrB,EAAEoB,OAAtC,CAAJ,EAAoD;AAChD/H,0BAAKyD,GAAL,CAASC,IAAT;AACH;AACD,qBAAI,KAAKgD,OAAL,IAAgB,CAACvE,UAAjB,IAA+B,CAACwE,EAAEH,SAAlC,IACI,CAACG,EAAEoB,OAAH,IAAc,CAACpB,EAAEqB,MAAjB,IAA2B,CAACrB,EAAEmB,QADtC,EAEE;AACEnB,uBAAEgB,cAAF;AACH;AA7FT;;AAgGA,aAAIX,WAAWvG,IAAf,EAAqB;AACjB2H,iCAAoBpB,OAApB;AACA9C;AACH;AACJ,MA3GD;;AA6GA,SAAImE,aAAa,SAAbA,UAAa,CAAU1B,CAAV,EAAa;;AAE1B,aAAId,KAAK,SAAIyC,SAAJ,CAAc3B,EAAEsB,UAAF,IAAgBtB,EAAE4B,MAAhC,EAAwC,GAAxC,CAAT;;AAEA,aAAI,CAAC1C,EAAD,IAAOA,GAAG2C,UAAH,CAAcd,EAAd,CAAiBe,OAAjB,CAAyBtI,QAAzB,IAAqC,CAAhD,EAAmD;AACnD0F,cAAKA,GAAG2C,UAAR;;AAEA,iBAAQ3C,GAAG6B,EAAH,CAAMgB,SAAN,CAAgBvI,SAASqC,MAAzB,CAAR;AACI,kBAAK,MAAL;AACA,kBAAK,YAAL;AACA,kBAAK,aAAL;AACA,kBAAK,UAAL;AACA,kBAAK,WAAL;AACA,kBAAK,WAAL;AACA,kBAAK,YAAL;AACI;AARR;;AAWA,aAAI,SAAI+E,GAAJ,CAAQ1B,EAAR,EAAY8C,QAAZ,CAAqBnH,WAAWiG,UAAhC,KAA+C,CAACrH,OAApD,EAA6D;AACzD6E,0BAAaY,GAAG6B,EAAhB;AACH;AACD,aAAItH,OAAJ,EAAa;AACT,sBAAImH,GAAJ,CAAQ1B,EAAR,EAAYqC,WAAZ,CAAwB1G,WAAWiG,UAAnC;AACH;;AAED,aAAIT,UAAUvG,QAAQK,UAAU6F,EAAEmB,QAAZ,GAAuBnB,EAAEqB,MAAF,IAAY,CAAnC,GAAuCrB,EAAEoB,OAAF,IAAa,CAA5D,CAAd;AACA,aAAItH,QAAQuG,OAAZ,EAAqB;AACjBoB,iCAAoBpB,OAApB;AACA9C;AACH;AAEJ,MA/BD;;AAiCA,SAAI0E,iBAAiB,SAAjBA,cAAiB,CAAUjC,CAAV,EAAa;;AAE9B,aAAId,KAAK,SAAIyC,SAAJ,CAAc3B,EAAEsB,UAAF,IAAgBtB,EAAE4B,MAAhC,EAAwC,GAAxC,CAAT;;AAEA,aAAI,CAAC1C,EAAD,IAAOA,GAAG2C,UAAH,CAAcd,EAAd,CAAiBe,OAAjB,CAAyBtI,QAAzB,IAAqC,CAAhD,EAAmD;AACnD0F,cAAKA,GAAG2C,UAAR;;AAEA,aAAIxB,UAAUvG,IAAd;;AAEA,aAAIyE,MAAMW,GAAG6B,EAAH,CAAMgB,SAAN,CAAgBvI,SAASqC,MAAzB,CAAV;AACA,iBAAQ0C,GAAR;AACI,kBAAK,MAAL;AACI8B,2BAAUA,UAAUlG,OAApB;AACA;AACJ,kBAAK,YAAL;AACA,kBAAK,aAAL;;AAEI,qBAAI6F,EAAEmB,QAAN,EAAgB;AAChBd,2BAAUA,UAAUrG,QAApB;AACA;AACJ,kBAAK,UAAL;AACA,kBAAK,WAAL;AACA,kBAAK,WAAL;AACA,kBAAK,YAAL;AACIqG,2BAAUA,WAAWL,EAAEqB,MAAF,IAAY,CAAZ,GAAgBpH,MAA3B,KAAsC+F,EAAEoB,OAAF,IAAa,CAAb,GAAiBlH,OAAvD,CAAV;AACA;;AAEJ;AACI,qBAAIT,OAAJ,EAAa,SAAImH,GAAJ,CAAQ1B,EAAR,EAAY2B,QAAZ,CAAqBhG,WAAWiG,UAAhC;AACb;AAnBR;;AAsBA,aAAIhH,QAAQuG,OAAZ,EAAqB;AACjBoB,iCAAoBpB,OAApB;AACA9C;AACH;;AAEDyC,WAAEgB,cAAF;AACAhB,WAAEwB,eAAF;AACH,MAvCD;;AAyCA,SAAIU,kBAAkB,SAAlBA,eAAkB,CAAUlC,CAAV,EAAa;;AAE/B,aAAId,KAAK,SAAIyC,SAAJ,CAAc3B,EAAEsB,UAAF,IAAgBtB,EAAE4B,MAAhC,EAAwC,GAAxC,CAAT;AAAA,aACMO,MAAM,EAAE,aAAa,CAAf,EAAkB,YAAY,CAA9B,EADZ;;AAGA,aAAI,CAACjD,EAAD,IAAOA,GAAG2C,UAAH,CAAcd,EAAd,CAAiBe,OAAjB,CAAyBtI,QAAzB,IAAqC,CAAhD,EAAmD;AACnD0F,cAAKA,GAAG2C,UAAR;;AAGA,aAAI3C,GAAG6B,EAAH,CAAMe,OAAN,CAAc,OAAd,IAAyB,CAAC,CAA9B,EAAiC;;AAE7BM,sCAAyBD,IAAInC,EAAEO,IAAN,CAAzB,EAAsC5G,IAAIkF,KAA1C;AACH,UAHD,MAGO,IAAIK,GAAG6B,EAAH,CAAMe,OAAN,CAAc,KAAd,IAAuB,CAAC,CAAxB,IAA6B5C,GAAG6B,EAAH,CAAMe,OAAN,CAAc,MAAd,IAAwB,CAAC,CAA1D,EAA6D;;AAEhEM,sCAAyBD,IAAInC,EAAEO,IAAN,CAAzB,EAAsC5G,IAAI0I,IAA1C;AACAD,sCAAyBD,IAAInC,EAAEO,IAAN,CAAzB,EAAsC5G,IAAImF,GAA1C;AACH,UAJM,MAIA,IAAII,GAAG6B,EAAH,CAAMe,OAAN,CAAc,MAAd,IAAwB,CAAC,CAA7B,EAAgC;AACnCQ,8BAAiBH,IAAInC,EAAEO,IAAN,CAAjB,EAA8B,IAA9B,EAAoCrB,GAAG6B,EAAvC;AACH,UAFM,MAEA,IAAItH,OAAJ,EAAa;AAChB6I,8BAAiBH,IAAInC,EAAEO,IAAN,CAAjB,EAA8B,IAA9B,EAAoCrB,GAAG6B,EAAvC;AACA,iBAAI,cAAcf,EAAEO,IAAF,CAAOgC,WAAP,EAAlB,EAAwC;;AAEpCD,kCAAiB,CAAjB,EAAoB,IAApB,EAA0BpD,GAAG6B,EAA7B;AACH;AACJ;AACDf,WAAEgB,cAAF;AACAhB,WAAEwB,eAAF;AACH,MA3BD;;AA8BA,SAAIgB,gBAAgB,SAAhBA,aAAgB,CAAUxC,CAAV,EAAa;AAC7B,wCAAetC,GAAf,CAAmB,YAAnB,EAAiCsC,EAAE4B,MAAF,CAASzD,KAA1C;AACAvE,kBAASC,QAAQmG,EAAE4B,MAAF,CAASzD,KAAjB,CAAT;AACH,MAHD;;AAMA9E,UAAKoJ,WAAL,GAAmB,UAAUvD,EAAV,EAAc;;AAE7B,aAAI,CAACA,EAAL,EAAS,OAAO/D,MAAMI,aAAb;AACT,aAAI,uBAAS2D,EAAT,CAAJ,EAAkBA,KAAKC,SAASC,cAAT,CAAwBF,EAAxB,CAAL;;AAElB,aAAIA,MAAM/D,MAAMI,aAAhB,EAA+B,OAAOJ,MAAMI,aAAb;;AAG/B,aAAI,CAAClC,KAAKuD,YAAL,CAAkBrD,QAAQwB,MAA1B,CAAD,IAAsC,CAAC1B,KAAKuD,YAAL,CAAkBzB,MAAMG,OAAN,CAAc6C,KAAhC,CAA3C,EAAmF;;AAE/E,mBAAM,IAAI5B,KAAJ,CAAU,sBAAV,CAAN;AACH;;AAGDlD,cAAKqJ,WAAL;;AAEA,aAAI,CAACxD,EAAD,IAAO,CAACA,GAAGyD,OAAf,EAAwB;AACpBxH,mBAAMI,aAAN,GAAsB,IAAtB;AACH,UAFD,MAEO;;AAGH9B,uBAAU,CAAC,SAAImH,GAAJ,CAAQ1B,EAAR,EAAY8C,QAAZ,CAAqBnH,WAAW+H,MAAhC,CAAX;;AAEAzH,mBAAMI,aAAN,GAAsB2D,EAAtB;;AAEAzB;AACA,iBAAIyB,GAAGS,aAAP,EAAsB;AAClBT,sBAAKA,GAAGS,aAAH,CAAiBR,QAAjB,CAA0B0D,IAA1B,CAA+BhB,UAApC;AACH;AACD,8BAAGiB,gBAAH,CAAoB5D,EAApB,EAAwB,SAAxB,EAAmCiB,gBAAnC;AACA,8BAAG2C,gBAAH,CAAoB5D,EAApB,EAAwB,OAAxB,EAAiCiB,gBAAjC;AACA,8BAAG2C,gBAAH,CAAoB5D,EAApB,EAAwB,UAAxB,EAAoCiB,gBAApC;AACA,8BAAG2C,gBAAH,CAAoB5D,EAApB,EAAwB,WAAxB,EAAqC7F,KAAKyD,GAAL,CAASiG,WAA9C;AACH;AACD,gBAAO5H,MAAMI,aAAb;AACH,MAnCD;;AAsCAlC,UAAKqJ,WAAL,GAAmB,YAAY;AAC3B,aAAI,CAACvH,MAAMI,aAAX,EAA0B,OAAO,KAAP;;AAE1BkC,0BAAiB,IAAjB;;AAEApE,cAAKyD,GAAL,CAASC,IAAT;;AAEA,aAAI5B,MAAMI,aAAV,EAAyB;AACrB,iBAAIyH,KAAK7H,MAAMI,aAAf;AACA,iBAAIyH,GAAGrD,aAAP,EAAsB;AAClBqD,sBAAKA,GAAGrD,aAAH,CAAiBR,QAAjB,CAA0B0D,IAA1B,CAA+BhB,UAApC;AACH;AACD,8BAAGoB,mBAAH,CAAuBD,EAAvB,EAA2B,SAA3B,EAAsC7C,gBAAtC;AACA,8BAAG8C,mBAAH,CAAuBD,EAAvB,EAA2B,UAA3B,EAAuC7C,gBAAvC;AACA,8BAAG8C,mBAAH,CAAuBD,EAAvB,EAA2B,OAA3B,EAAoC7C,gBAApC;AACA,8BAAG8C,mBAAH,CAAuBD,EAAvB,EAA2B,WAA3B,EAAwC3J,KAAKyD,GAAL,CAASiG,WAAjD;AACH;AACD5H,eAAMI,aAAN,GAAsB,IAAtB;AACA,gBAAO,IAAP;AACH,MAnBD;;AAsBAlC,UAAK6J,gBAAL,GAAwB,UAAUhE,EAAV,EAAc;AAClC,gBAAO/D,MAAMI,aAAb;AACH,MAFD;;AAIAlC,UAAK8J,IAAL,GACI9J,KAAK+J,IAAL,GAAY,UAAUC,KAAV,EAAiBC,MAAjB,EAAyBC,QAAzB,EAAmC;AAC3C,aAAI,EAAEF,QAAQhK,KAAKoJ,WAAL,CAAiBtH,MAAMI,aAAN,IAAuB8H,KAAxC,CAAV,KAA6D,CAAClI,MAAMC,QAApE,IAAgF,CAAC+D,SAAS0D,IAA9F,EAAoG,OAAO,KAAP;;AAGpG,aAAI,CAAC1H,MAAMC,QAAN,CAAeyG,UAAhB,IAA8B1G,MAAMC,QAAN,CAAeyG,UAAf,CAA0B2B,QAA1B,IAAsC,EAAxE,EAA4E;AACxE,iBAAI,uBAASF,MAAT,CAAJ,EAAsBA,SAASnE,SAASC,cAAT,CAAwBkE,MAAxB,CAAT;AACtB,iBAAI,CAACA,OAAOG,WAAZ,EAAyB,OAAO,KAAP;AACzBH,oBAAOG,WAAP,CAAmBtI,MAAMC,QAAzB;;AAEA,iBAAI,CAAC,0BAAYmI,QAAZ,CAAD,IAA0BF,SAASE,QAAnC,IAA+CA,SAASE,WAA5D,EAAyE;AACrE,kCAAGX,gBAAH,CAAoBS,QAApB,EAA8B,SAA9B,EAAyCpD,gBAAzC;AACA,kCAAG2C,gBAAH,CAAoBS,QAApB,EAA8B,OAA9B,EAAuCpD,gBAAvC;AACA,kCAAG2C,gBAAH,CAAoBS,QAApB,EAA8B,UAA9B,EAA0CpD,gBAA1C;AACH;AACJ;;AAED,gBAAO,IAAP;AACH,MAlBL;;AAoBA9G,UAAKqK,KAAL,GACIrK,KAAK0D,IAAL,GAAY,YAAY;AACpB,aAAI,CAAC5B,MAAMC,QAAP,IAAmB,CAAC/B,KAAK+G,MAAL,EAAxB,EAAuC,OAAO,KAAP;AACvC/G,cAAKqJ,WAAL;AACAvH,eAAMC,QAAN,CAAeyG,UAAf,CAA0B8B,WAA1B,CAAsCxI,MAAMC,QAA5C;AACA,gBAAO,IAAP;AACH,MANL;;AAQA/B,UAAKuK,MAAL,GAAc,UAAUP,KAAV,EAAiBC,MAAjB,EAAyBC,QAAzB,EAAmC;AAC7ClK,cAAK+G,MAAL,KAAgB/G,KAAKqK,KAAL,EAAhB,GAA+BrK,KAAK+J,IAAL,CAAUC,KAAV,EAAiBC,MAAjB,EAAyBC,QAAzB,CAA/B;AACH,MAFD;;AAIAlK,UAAK+G,MAAL,GAAc,YAAa;AACvB,gBAAQ,CAAC,CAACjF,MAAMC,QAAN,CAAeyG,UAAlB,IAAiC1G,MAAMC,QAAN,CAAeyG,UAAf,CAA0B2B,QAA1B,IAAsC,CAA9E;AACH,MAFD;;AAOA,SAAI/F,mBAAmB,SAAnBA,gBAAmB,CAAUoG,KAAV,EAAiB;AACpC,aAAI1I,MAAMI,aAAV,EAAyB;AACrB,iBAAIzB,OAAO+J,QAAQ,EAAR,GACJ/I,KAAKgJ,GAAL,GAAW,KAAX,GACG,KAFV;AAGA,iBAAI3I,MAAMI,aAAN,CAAoBoE,aAAxB,EACIxE,MAAMI,aAAN,CAAoBoE,aAApB,CAAkCR,QAAlC,CAA2C0D,IAA3C,CAAgDkB,GAAhD,GAAsDjK,IAAtD,CADJ,KAGIqB,MAAMI,aAAN,CAAoBwI,GAApB,GAA0BjK,IAA1B;AACP;AACJ,MAVD;;AAaA,SAAI+C,qBAAqB,SAArBA,kBAAqB,GAAY;AACjC,aAAI,QAAQ9B,OAAOxB,OAAnB,EACI;;AAEJ,aAAIyK,IAAIjJ,OAAOsD,QAAP,EAAR;AAAA,aACMtC,CADN;AAAA,aACSkI,CADT;AAAA,aACYC,CADZ;AAAA,aAEMC,KAAK,EAFX;AAGApJ,gBAAOxB,OAAP,GAAiB,EAAjB;;AAEA4B,eAAMG,OAAN,CAAc8B,SAAd,GAA0B,EAA1B;AACA,cAAK,IAAI1B,IAAI,CAAR,EAAW0I,KAAKJ,EAAEnI,MAAlB,EAA0BwI,IAAI,CAAnC,EAAsC3I,IAAI0I,EAA1C,EAA8C1I,GAA9C,EAAmD;AAC/CK,iBAAIhB,OAAOW,CAAP,CAAJ;AACAwI,iBAAInI,EAAEC,IAAF,GAAS,GAAT,GAAeD,EAAEI,IAArB;AACApB,oBAAOC,IAAP,CAAYkJ,CAAZ,IAAiBxI,CAAjB;;AAEA,iBAAIX,OAAOG,UAAP,IAAqB,CAACH,OAAOG,UAAP,CAAkBuB,cAAlB,CAAiCV,EAAEC,IAAnC,CAA1B,EACI;;AAEJ,iBAAImI,GAAGG,KAAH,IAAYvI,EAAEC,IAAlB,EAAwB;AACpBmI,sBAAKhF,SAASoF,aAAT,CAAuB,UAAvB,CAAL;AACAJ,oBAAGG,KAAH,GAAWvI,EAAEC,IAAb;AACAb,uBAAMG,OAAN,CAAcmI,WAAd,CAA0BU,EAA1B;AACH;AACDF,iBAAI9E,SAASoF,aAAT,CAAuB,QAAvB,CAAJ;AACAN,eAAE9F,KAAF,GAAU+F,CAAV;AACAD,eAAER,WAAF,CAActE,SAASqF,cAAT,CAAwBzI,EAAEI,IAA1B,CAAd;AACA8H,eAAEK,KAAF,GAAUvI,EAAEI,IAAZ;AACAgI,gBAAGV,WAAH,CAAeQ,CAAf;;AAEAlJ,oBAAOxB,OAAP,CAAe2K,CAAf,IAAoBG,GAApB;AACH;AACJ,MA/BD;;AAiCA,SAAIhI,YAAY,SAAZA,SAAY,CAAU2H,CAAV,EAAa;AACzB,aAAI,uBAASA,CAAT,CAAJ,EACI,OAAOA,EAAES,KAAF,CAAQ,+CAAR,EAAyDC,GAAzD,CAA6D,UAAUC,CAAV,EAAa;AAAE,oBAAOA,EAAEhG,OAAF,CAAU,aAAV,EAAyB,EAAzB,CAAP;AAAqC,UAAjH,CAAP,CADJ,KAGI,OAAOqF,EAAEU,GAAF,CAAM,UAAUC,CAAV,EAAa;AAAE,oBAAO,sBAAQA,CAAR,IAAaA,EAAED,GAAF,CAAM,UAAUV,CAAV,EAAa;AAAEY,wBAAOC,eAAP,CAAuBb,CAAvB;AAA2B,cAAhD,EAAkDc,IAAlD,CAAuD,EAAvD,CAAb,GAA0EF,OAAOC,eAAP,CAAuBF,CAAvB,EAA0BhG,OAA1B,CAAkC,aAAlC,EAAiD,EAAjD,CAAjF;AAAuI,UAA5J,CAAP;AACP,MALD;;AAOA,SAAI1B,kBAAkB,SAAlBA,eAAkB,CAAUlB,CAAV,EAAa;;AAE/B,aAAIK,QAAQL,EAAEO,MAAd;AAAA,aACMyI,QAAQhJ,EAAEgJ,KAAF,IAAW,EADzB;AAAA,aAEMC,MAAMjJ,EAAEiJ,GAAF,IAAS,EAFrB;AAAA,aAGMC,YAAYlJ,EAAEkJ,SAAF,IAAe,EAHjC;AAAA,aAIMC,OAAOnJ,EAAEmJ,IAAF,IAAU,EAJvB;AAAA,aAKMC,aAAapJ,EAAEoJ,UAAF,IAAgB,EALnC;AAAA,aAMMC,KAAKrJ,EAAEqJ,EANb;AAAA,aAOMC,MAAMtJ,EAAEsJ,GAPd;AAAA,aAQMC,EARN;AAAA,aAQUC,EARV;AAAA,aAQcC,GARd;AAAA,aAQmBrB,EARnB;AAAA,aAQuBsB,MAAM,IAR7B;AAAA,aASMC,GATN;AAAA,aASWC,GATX;AAAA,aASgBC,IAThB;AAAA,aASsBC,GATtB;AAAA,aAS2BC,OAAO,CAAC,CATnC;AAAA,aAUMC,KAAK,EAVX;;AAYAA,YAAG5J,IAAH,GAAUJ,EAAEI,IAAZ;AACA4J,YAAG/J,IAAH,GAAUD,EAAEC,IAAZ;AACA+J,YAAGrJ,QAAH,GAAcX,EAAEW,QAAhB;;AAEA,cAAK,IAAIhB,IAAI,CAAR,EAAWC,KAAKS,MAAMP,MAA3B,EAAmCH,IAAIC,EAAvC,EAA2CD,GAA3C,EAAgD;AAC5C,iBAAIsK,cAAc5J,MAAMV,CAAN,CAAlB;AAAA,iBACMuK,WAAW,IADjB;AAAA,iBAEMC,YAAY,IAFlB;AAAA,iBAGMC,aAAa,IAHnB;AAAA,iBAIMC,OAAO,CAACJ,WAAD,CAJb;;AAMA,iBAAIjB,MAAMtI,cAAN,CAAqBf,CAArB,CAAJ,EAA6B;AACzB4J,sBAAKjJ,UAAU0I,MAAMrJ,CAAN,CAAV,CAAL;AACAgK,uBAAMhK,CAAN;AACH;AACD,iBAAIgK,MAAM,CAAC,CAAP,IAAYJ,GAAG5J,IAAIgK,GAAP,CAAhB,EAA6B;AACzBS,8BAAab,GAAG5J,IAAIgK,GAAP,CAAb;AACAU,sBAAKpM,QAAL,IAAiBmM,UAAjB;AACH,cAHD,MAGO,IAAIH,eAAeA,gBAAgBA,cAAcA,YAAY9H,WAAZ,EAA9B,CAAnB,EAA6E;AAChFkI,sBAAKpM,QAAL,IAAiBgM,WAAjB;AACAG,8BAAaH,WAAb;AACH;;AAED,iBAAIhB,IAAIvI,cAAJ,CAAmBf,CAAnB,CAAJ,EAA2B;AACvB6J,sBAAKlJ,UAAU2I,IAAItJ,CAAJ,CAAV,CAAL;AACAiK,uBAAMjK,CAAN;AACH;AACD,iBAAIiK,MAAM,CAAC,CAAP,IAAYJ,GAAG7J,IAAIiK,GAAP,CAAhB,EAA6B;AACzBM,4BAAWV,GAAG7J,IAAIiK,GAAP,CAAX;AACAS,sBAAK7L,WAAL,IAAoB0L,QAApB;AACH;;AAED,iBAAIhB,UAAUxI,cAAV,CAAyBf,CAAzB,CAAJ,EAAiC;AAC7B8J,uBAAMnJ,UAAU4I,UAAUvJ,CAAV,CAAV,CAAN;AACAkK,wBAAOlK,CAAP;AACH;AACD,iBAAIkK,OAAO,CAAC,CAAR,IAAaJ,IAAI9J,IAAIkK,IAAR,CAAjB,EAAgC;AAC5BQ,sBAAK1L,iBAAL,IAA0B8K,IAAI9J,IAAIkK,IAAR,CAA1B;AACH,cAFD,MAEO,IAAIK,YAAYA,aAAaA,WAAWA,SAAS/H,WAAT,EAAxB,CAAhB,EAAiE;AACpEkI,sBAAK1L,iBAAL,IAA0BuL,QAA1B;AACH;;AAED,iBAAIf,KAAKzI,cAAL,CAAoBf,CAApB,CAAJ,EAA4B;AACxByI,sBAAK9H,UAAU6I,KAAKxJ,CAAL,CAAV,CAAL;AACAmK,uBAAMnK,CAAN;AACH;AACD,iBAAImK,MAAM,CAAC,CAAP,IAAY1B,GAAGzI,IAAImK,GAAP,CAAhB,EAA6B;AACzBK,6BAAY/B,GAAGzI,IAAImK,GAAP,CAAZ;AACH;AACD,iBAAIK,SAAJ,EAAe;AACXE,sBAAKjM,OAAL,IAAgB+L,SAAhB;AACH,cAFD,MAEO,IAAIC,cAAcA,WAAWjI,WAAX,MAA4BiI,WAAW5D,WAAX,EAA9C,EAAwE;AAC3E6D,sBAAKjM,OAAL,IAAgBgM,UAAhB;AACH,cAFM,MAEA,IAAIH,WAAJ,EAAiB;AACpBI,sBAAKjM,OAAL,IAAgB6L,YAAY9H,WAAZ,EAAhB;AACH;;AAED,iBAAIiH,WAAW1I,cAAX,CAA0Bf,CAA1B,CAAJ,EAAkC;AAC9B+J,uBAAMpJ,UAAU8I,WAAWzJ,CAAX,CAAV,CAAN;AACAoK,wBAAOpK,CAAP;AACH;AACD,iBAAIoK,OAAO,CAAC,CAAR,IAAaL,IAAI/J,IAAIoK,IAAR,CAAjB,EAAgC;AAC5BM,sBAAKzL,aAAL,IAAsB8K,IAAI/J,IAAIoK,IAAR,CAAtB;AACH,cAFD,MAEO,IAAIK,UAAJ,EAAgB;AACnBC,sBAAKzL,aAAL,IAAsBwL,WAAW5D,WAAX,EAAtB;AACH,cAFM,MAEA,IAAIyD,WAAJ,EAAiB;AACpBI,sBAAKzL,aAAL,IAAsBqL,WAAtB;AACH;;AAEDD,gBAAGrK,CAAH,IAAQ0K,IAAR;AACH;;AAED,aAAIhB,EAAJ,EAAQ;AACJW,gBAAGX,EAAH,GAAQ,EAAR;AACA,kBAAK,IAAI1J,CAAT,IAAc0J,EAAd,EAAkB;AACd,qBAAIA,GAAG3I,cAAH,CAAkBf,CAAlB,CAAJ,EAA0B;AACtB,yBAAI6C,MAAM7C,CAAV;AACA,yBAAI2K,SAAS3K,CAAT,KAAeA,IAAI,CAAvB,EAA0B;AACtB6C,+BAAMqG,OAAO0B,YAAP,CAAoB5K,CAApB,CAAN;AACH;;AAEDqK,wBAAGX,EAAH,CAAM7G,GAAN,IAAalC,UAAU+I,GAAG1J,CAAH,CAAV,EAAiBoJ,IAAjB,CAAsB,EAAtB,EAA0BnG,OAA1B,CAAkCJ,GAAlC,EAAuCA,MAAMA,GAA7C,CAAb;AACH;AACJ;AACJ;;AAGDwH,YAAGjC,GAAH,GAAS,CAAC,CAACiC,GAAGjB,IAAH,CAAQ,EAAR,EAAYL,KAAZ,CAAkB,iBAAlB,CAAX;;AAGAsB,YAAGvJ,MAAH,GAAYT,EAAES,MAAd;;AAGA,aAAI,yBAAW6I,GAAX,CAAJ,EAAqB;AACjBU,gBAAGhH,aAAH,GAAmBsG,GAAnB;AACH,UAFD,MAEO,IAAIA,GAAJ,EAAS;AACZU,gBAAGvI,QAAH,GAAc6H,IAAI7H,QAAlB;AACAuI,gBAAGhH,aAAH,GAAmBsG,IAAItG,aAAvB;AACH;AACD,gBAAOgH,EAAP;AACH,MAlHD;;AAoHA,SAAIxI,iBAAiB,SAAjBA,cAAiB,GAAY;AAC7B,aAAIgI,KAAK,EAAT;AACAA,YAAGxL,SAAH,IAAgBc,WAAW0L,UAA3B;AACAhB,YAAGvL,QAAH,IAAea,WAAW2L,SAA1B;AACAjB,YAAGhL,WAAH,IAAkBM,WAAW4L,OAA7B;AACAlB,YAAG7K,iBAAH,IAAwBG,WAAW6L,YAAnC;AACAnB,YAAGpL,OAAH,IAAcU,WAAW8L,QAAzB;AACApB,YAAG5K,aAAH,IAAoBE,WAAW+L,aAA/B;;AAEArB,YAAGtL,MAAH,IAAaY,WAAW0L,UAAxB;AACAhB,YAAGrL,OAAH,IAAcW,WAAW0L,UAAzB;AACAhB,YAAG9K,YAAH,IAAmBI,WAAW2L,SAA9B;AACAjB,YAAGlL,aAAH,IAAoBQ,WAAW2L,SAA/B;AACAjB,YAAGjL,WAAH,IAAkBO,WAAW8L,QAA7B;AACApB,YAAGnL,YAAH,IAAmBS,WAAW8L,QAA9B;;AAEApB,YAAG/K,gBAAH,IAAuBK,WAAWgM,gBAAlC;AACAtB,YAAG3K,MAAH,IAAaC,WAAWgM,gBAAxB;;AAEA,kBAAIjG,GAAJ,CAAQzF,MAAME,IAAd,EAAoBkG,WAApB,CAAgCgE,EAAhC,EAAoC1E,QAApC,CAA6C0E,GAAGzL,IAAH,CAA7C;AACH,MApBD;;AAsBA,SAAI2H,sBAAsB,SAAtBA,mBAAsB,CAAUpB,OAAV,EAAmB;;AAEzC,aAAIyG,UAAUhN,OAAOuG,OAArB;AACA,aAAIyG,UAAU9M,QAAd,EAAwB;AACpBoI,sCAAyB,CAAC,EAAE/B,UAAUrG,QAAZ,CAA1B,EAAiDL,IAAIkF,KAArD;AACH;AACD,aAAIiI,UAAU7M,MAAd,EAAsB;AAClBmI,sCAAyB,CAAC,EAAE/B,UAAUpG,MAAZ,CAA1B,EAA+CN,IAAImF,GAAnD;AACH;AACD,aAAIgI,UAAU5M,OAAd,EAAuB;AACnBkI,sCAAyB,CAAC,EAAE/B,UAAUnG,OAAZ,CAA1B,EAAgDP,IAAI0I,IAApD;AACH;AACD,aAAIyE,UAAU3M,OAAd,EAAuB;AACnBmI,8BAAiB,CAAC,EAAEjC,UAAUlG,OAAZ,CAAlB,EAAwCR,IAAIiF,IAA5C;AACH;AACD9E,gBAAOuG,OAAP;AACH,MAhBD;;AAkBA,SAAI+B,2BAA2B,SAA3BA,wBAA2B,CAAU2E,KAAV,EAAiBC,MAAjB,EAAyB;AACpD,aAAIC,KAAK9H,SAASC,cAAT,CAAwB5F,WAAWwN,MAAX,GAAoB,OAA5C,CAAT;AAAA,aACME,KAAK/H,SAASC,cAAT,CAAwB5F,WAAWwN,MAAX,GAAoB,QAA5C,CADX;AAEA,iBAAQ,IAAID,KAAZ;AACI,kBAAK,CAAL;AACIE,oBAAG5J,SAAH,GAAe,SAAIuD,GAAJ,CAAQsG,EAAR,EAAY3F,WAAZ,CAAwB1G,WAAWiG,UAAnC,EAA+CqG,QAA/C,EAAf;AACA;AACJ,kBAAK,CAAL;AACI,0BAAIvG,GAAJ,CAAQzF,MAAME,IAAd,EAAoBkG,WAApB,CAAgC,CAAC1G,WAAWuM,UAAZ,EAAwBvM,WAAWwM,QAAnC,CAAhC;AACAJ,oBAAG5J,SAAH,GAAe,SAAIuD,GAAJ,CAAQsG,EAAR,EAAYrG,QAAZ,CAAqBhG,WAAWiG,UAAhC,EAA4CqG,QAA5C,EAAf;AACA;AACJ,kBAAK,CAAL;AACI,qBAAIxN,IAAIkF,KAAJ,IAAamI,MAAb,IAAuBlN,OAAOE,QAAP,GAAkBA,QAA7C,EAAuD;AACnD,8BAAI4G,GAAJ,CAAQzF,MAAME,IAAd,EAAoBwF,QAApB,CAA6BhG,WAAWuM,UAAxC;AACH,kBAFD,MAEO,IAAIzN,IAAImF,GAAJ,IAAWkI,MAAX,IAAqBlN,OAAOS,WAAhC,EAA6C;AAChD,8BAAIqG,GAAJ,CAAQzF,MAAME,IAAd,EAAoBwF,QAApB,CAA6BhG,WAAWwM,QAAxC;AACH;AACDJ,oBAAG5J,SAAH,GAAe,SAAIuD,GAAJ,CAAQsG,EAAR,EAAYrG,QAAZ,CAAqBhG,WAAWyM,WAAhC,EAA6CH,QAA7C,EAAf;AACA;AACJ,kBAAK,CAAL;AACI,qBAAIxN,IAAIkF,KAAJ,IAAamI,MAAjB,EAAyB;AACrB,8BAAIpG,GAAJ,CAAQzF,MAAME,IAAd,EAAoBkG,WAApB,CAAgC1G,WAAWuM,UAA3C;AACH,kBAFD,MAEO,IAAIzN,IAAImF,GAAJ,IAAWkI,MAAf,EAAuB;AAC1B,8BAAIpG,GAAJ,CAAQzF,MAAME,IAAd,EAAoBkG,WAApB,CAAgC1G,WAAWwM,QAA3C;AACH;AACDJ,oBAAG5J,SAAH,GAAe,SAAIuD,GAAJ,CAAQsG,EAAR,EAAY3F,WAAZ,CAAwB1G,WAAWyM,WAAnC,EAAgDH,QAAhD,EAAf;AACA;AAvBR;AAyBH,MA5BD;;AA8BA,SAAI7E,mBAAmB,SAAnBA,gBAAmB,CAAUyE,KAAV,EAAiBQ,MAAjB,EAAyBpL,IAAzB,EAA+B;AAClD,aAAI6H,IAAI7E,SAASC,cAAT,CAAwBmI,SAAS/N,WAAW+N,MAApB,GAC1BpL,IADE,CAAR;AAEA,aAAI6H,CAAJ,EAAO;AACH,qBAAQ,IAAI+C,KAAZ;AACI,sBAAK,CAAL;AACI,8BAAInG,GAAJ,CAAQoD,CAAR,EAAWzC,WAAX,CAAuB1G,WAAWiG,UAAlC;AACA;AACJ,sBAAK,CAAL;AACI,8BAAIF,GAAJ,CAAQoD,CAAR,EAAWnD,QAAX,CAAoBhG,WAAWiG,UAA/B;AACA;AACJ,sBAAK,CAAL;AACI,8BAAIF,GAAJ,CAAQoD,CAAR,EAAWnD,QAAX,CAAoBhG,WAAWyM,WAA/B;AACA;AACJ,sBAAK,CAAL;AACI,8BAAI1G,GAAJ,CAAQoD,CAAR,EAAWzC,WAAX,CAAuB1G,WAAWyM,WAAlC;AACA;AAZR;AAcH;AACJ,MAnBD;;AAqBA,SAAIjI,kBAAkB,SAAlBA,eAAkB,CAAUmI,IAAV,EAAgBC,GAAhB,EAAqB;AACvC,aAAIC,MAAM,CAACF,IAAD,EAAO,CAAP,CAAV;AACA,aAAI,yBAAW1M,KAAKiE,aAAhB,CAAJ,EAAoC;;AAEhC2I,mBAAM5M,KAAKiE,aAAL,CAAmByI,IAAnB,EAAyBC,GAAzB,CAAN;AACH,UAHD,MAGO,IAAID,QAAQ,MAAZ,EAAoB;AACvBE,mBAAM,CAAC,EAAD,EAAK,CAAL,CAAN;AACH,UAFM,MAEA,IAAI5M,KAAKsK,EAAL,IAAWqC,IAAI5L,MAAJ,IAAc,CAA7B,EAAgC;;AAEnC,iBAAIf,KAAKsK,EAAL,CAAQ3I,cAAR,CAAuBgL,GAAvB,CAAJ,EAAiC;;AAE7BC,qBAAI,CAAJ,IAAS,CAAT;AACA,qBAAIC,MAAM7M,KAAKsK,EAAL,CAAQqC,GAAR,CAAV;AAAA,qBACAG,MAAMD,IAAI7F,OAAJ,CAAY0F,IAAZ,IAAoB,CAD1B;AAEAE,qBAAI,CAAJ,IAASE,MAAMD,IAAIE,MAAJ,CAAWD,GAAX,CAAN,GACHJ,IADN;AAEH,cAPD,MAOO,IAAI1M,KAAKsK,EAAL,CAAQ3I,cAAR,CAAuB+K,IAAvB,CAAJ,EAAkC;;AAErCE,qBAAI,CAAJ,IAAS,CAAT;AACAA,qBAAI,CAAJ,IAASF,IAAT;AACH;AACJ;AACD,gBAAOE,GAAP;AACH,MAvBD;;AAyBA,SAAIvK,oBAAoB,SAApBA,iBAAoB,CAAUrC,IAAV,EAAgB;AACpC,aAAIgN,MAAM3I,SAASoF,aAAT,CAAuB,MAAvB,CAAV;;AAEApF,kBAAS0D,IAAT,CAAcY,WAAd,CAA0BqE,GAA1B;AACAA,aAAIC,KAAJ,CAAUC,QAAV,GAAqB,UAArB;AACAF,aAAIC,KAAJ,CAAUE,IAAV,GAAiB,SAAjB;;AAEA,cAAK,IAAIvM,IAAI,CAAR,EAAWC,KAAKb,KAAKe,MAArB,EAA6BqM,OAAO,EAApC,EAAwCzJ,GAAxC,EAA6C0J,KAAlD,EAAyDzM,IAAIC,EAA7D,EAAiED,GAAjE,EAAsE;AAClE+C,mBAAM3D,KAAKY,CAAL,CAAN;AACAwM,kBAAKvL,IAAL,CAAU,CAAC,WAAD,EAAcnD,QAAd,EAAwBkC,CAAxB,EACJ,WADI,EACSb,WAAWuN,QADpB,EAEJ,OAFI,EAEKC,oBAAoBvN,IAApB,EAA0B2D,GAA1B,EAA+B1E,SAA/B,EAA0Cc,WAAWyN,UAArD,EAAiER,GAAjE,CAFL,EAGJO,oBAAoBvN,IAApB,EAA0B2D,GAA1B,EAA+BzE,QAA/B,EAAyCa,WAAW0N,SAApD,EAA+DT,GAA/D,CAHI,EAIJO,oBAAoBvN,IAApB,EAA0B2D,GAA1B,EAA+BlE,WAA/B,EAA4CM,WAAW2N,OAAvD,EAAgEV,GAAhE,CAJI,EAKJO,oBAAoBvN,IAApB,EAA0B2D,GAA1B,EAA+B/D,iBAA/B,EAAkDG,WAAW4N,YAA7D,EAA2EX,GAA3E,CALI,EAMJO,oBAAoBvN,IAApB,EAA0B2D,GAA1B,EAA+BtE,OAA/B,EAAwCU,WAAW6N,QAAnD,EAA6DZ,GAA7D,CANI,EAOJO,oBAAoBvN,IAApB,EAA0B2D,GAA1B,EAA+B9D,aAA/B,EAA8CE,WAAW8N,aAAzD,EAAwEb,GAAxE,CAPI,EAQJ,YARI,EAQUhD,IARV,CAQe,EARf,CAAV;AAUH;AACD,cAAK,IAAIpJ,CAAT,IAAchC,WAAd,EAA2B;AACvB,iBAAIA,YAAY+C,cAAZ,CAA2Bf,CAA3B,CAAJ,EAAmC;AAC/B+C,uBAAM/E,YAAYgC,CAAZ,CAAN;AACAyM,yBAAQ1J,IAAIE,OAAJ,CAAY,KAAZ,EAAmB,EAAnB,CAAR;AACAuJ,sBAAKU,MAAL,CAAYlN,CAAZ,EAAe,CAAf,EAAkB,CAAC,WAAD,EAAclC,QAAd,EAAwBiF,GAAxB,EACZ,WADY,EACC5D,WAAWuN,QADZ,EAEZ,cAFY,EAEID,KAFJ,EAEW,GAFX,EAGZ,uBAHY,EAGaA,KAHb,EAGoB,SAHpB,EAIZ,YAJY,EAIErD,IAJF,CAIO,EAJP,CAAlB;AAKH;AACJ;AACD3F,kBAAS0D,IAAT,CAAcc,WAAd,CAA0BmE,GAA1B;AACA,gBAAOI,KAAKpD,IAAL,CAAU,EAAV,EAAcnG,OAAd,CAAsB,SAAtB,EAAiC,uBAAjC,CAAP;AACH,MAjCD;;AAmCA,SAAI0J,sBAAsB,SAAtBA,mBAAsB,CAAUQ,GAAV,EAAepK,GAAf,EAAoB3E,IAApB,EAA0BwD,GAA1B,EAA+BwK,GAA/B,EAAoC;AAC1D,aAAI5K,OAAO,EAAX;AAAA,aACMkI,KAAKyD,IAAIzD,EAAJ,IAAUyD,IAAIzD,EAAJ,CAAO3I,cAAP,CAAsBgC,IAAI3E,IAAJ,CAAtB,CADrB;AAAA,aAEMsM,OAAO3H,IAAI3E,IAAJ,KAAa,EAF1B;;AAKA,aAAIsL,EAAJ,EAAQ9H,OAAO,MAAMzC,WAAWiO,OAAxB;;AAGR,aAAKhP,QAAQa,aAAR,IAAyB8D,IAAItE,OAAJ,CAAzB,IAAyCiM,KAAK7D,WAAL,MAAsB9D,IAAItE,OAAJ,EAAaoI,WAAb,EAAhE,IACIzI,QAAQK,OAAR,IAAmBsE,IAAI9D,aAAJ,CAAnB,IAAyCyL,KAAK7D,WAAL,MAAsB9D,IAAI9D,aAAJ,EAAmB4H,WAAnB,EADvE,EAC0G;AACtGjF,oBAAO,MAAMzC,WAAWkO,UAAxB;AACH;AACD,aAAKjP,QAAQE,QAAR,IAAoByE,IAAI1E,SAAJ,CAApB,IAAsCqM,KAAK7D,WAAL,MAAsB9D,IAAI1E,SAAJ,EAAewI,WAAf,EAA7D,IACIzI,QAAQC,SAAR,IAAqB0E,IAAIzE,QAAJ,CAArB,IAAsCoM,KAAK7D,WAAL,MAAsB9D,IAAIzE,QAAJ,EAAcuI,WAAd,EADpE,EACkG;AAC9FjF,oBAAO,MAAMzC,WAAWmO,WAAxB;AACH;AACD,aAAKlP,QAAQE,QAAR,IAAoByE,IAAI9D,aAAJ,CAApB,IAA0CyL,KAAK7D,WAAL,MAAsB9D,IAAI9D,aAAJ,EAAmB4H,WAAnB,EAAjE,IACIzI,QAAQa,aAAR,IAAyB8D,IAAIzE,QAAJ,CAAzB,IAA0CoM,KAAK7D,WAAL,MAAsB9D,IAAIzE,QAAJ,EAAcuI,WAAd,EADxE,EACsG;AAClGjF,oBAAO,MAAMzC,WAAWoO,eAAxB;AACH;AACD,aAAKnP,QAAQK,OAAR,IAAmBsE,IAAI1E,SAAJ,CAAnB,IAAqCqM,KAAK7D,WAAL,MAAsB9D,IAAI1E,SAAJ,EAAewI,WAAf,EAA5D,IACIzI,QAAQC,SAAR,IAAqB0E,IAAItE,OAAJ,CAArB,IAAqCiM,KAAK7D,WAAL,MAAsB9D,IAAItE,OAAJ,EAAaoI,WAAb,EADnE,EACgG;AAC5FjF,oBAAO,MAAMzC,WAAWkO,UAAxB;AACH;AACD,aAAKjP,QAAQY,iBAAR,IAA6B+D,IAAIlE,WAAJ,CAA7B,IAAiD6L,KAAK7D,WAAL,MAAsB9D,IAAIlE,WAAJ,EAAiBgI,WAAjB,EAAxE,IACIzI,QAAQS,WAAR,IAAuBkE,IAAIzE,QAAJ,CAAvB,IAAwCoM,KAAK7D,WAAL,MAAsB9D,IAAIzE,QAAJ,EAAcuI,WAAd,EADtE,EACoG;AAChGjF,oBAAO,MAAMzC,WAAWqO,SAAxB;AACH;;AAEDhM,cAAKP,IAAL,CAAU,OAAV;AACA,aAAIW,GAAJ,EAAS;AACLJ,kBAAKP,IAAL,CAAU,cAAcW,GAAd,GAAoB,IAA9B;AACH;AACDJ,cAAKP,IAAL,CAAU,WAAWyJ,IAAX,GAAkB,aAA5B;AACA,gBAAOlJ,KAAK4H,IAAL,CAAU,EAAV,CAAP;AACH,MApCD,CAsCM,CAAC,YAAY;;AAEX3J,eAAMC,QAAN,GAAiB+D,SAASoF,aAAT,CAAuB,KAAvB,CAAjB;AACApJ,eAAMC,QAAN,CAAe+N,YAAf,GAA8B,IAA9B;AACAhO,eAAMC,QAAN,CAAe2F,EAAf,GAAoB,iBAApB;AACA5F,eAAMC,QAAN,CAAegC,SAAf,GAA2B,CAAC,sCACtB,0CADsB,GAEtB,6CAFsB,GAGtB,gKAHsB,GAG6I/D,KAAKC,SAHlJ,GAG8J,YAH/J,EAIzBqF,OAJyB,CAIjB,SAJiB,EAIN,uBAJM,CAA3B;;AAMAxD,eAAME,IAAN,GAAaF,MAAMC,QAAN,CAAegO,UAA5B;;AAEA,aAAIlK,KAAK/D,MAAMC,QAAN,CAAesF,UAAf,CAA0B2I,IAA1B,CAA+B,CAA/B,CAAT;AACA,0BAAGvG,gBAAH,CAAoB5D,EAApB,EAAwB,QAAxB,EAAkC,UAAUc,CAAV,EAAa;AAAE3G,kBAAKuD,YAAL,CAAkB,KAAKuB,KAAvB;AAA+B,UAAhF;AACAhD,eAAMG,OAAN,GAAgB4D,EAAhB;;AAEA,aAAIA,KAAKA,GAAGoK,WAAZ;AAAA,aACMC,WAAW,EADjB;;AAGA3P,kBAAS,+BAAe4P,GAAf,CAAmB,YAAnB,CAAT;;AAEA,aAAI,CAAC3P,QAAQ4C,cAAR,CAAuB7C,MAAvB,CAAL,EACIA,SAAS,iBAAT;;AAEJ,cAAK,IAAI8B,CAAT,IAAc7B,OAAd,EAAuB;AACnB,iBAAI6K,MAAM7K,QAAQ6B,CAAR,EAAWQ,KAAX,CAAiB,EAAjB,EAAqBwI,GAArB,CAAyB,UAAU+E,CAAV,EAAa;AAAE,wBAAOA,EAAEnK,UAAF,CAAa,CAAb,CAAP;AAAwB,cAAhE,CAAV;;AAEAoF,iBAAIkE,MAAJ,CAAW,EAAX,EAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB;AACAlE,iBAAIkE,MAAJ,CAAW,EAAX,EAAe,CAAf,EAAkB,EAAlB,EAAsB,EAAtB;AACAlE,iBAAIkE,MAAJ,CAAW,EAAX,EAAe,CAAf,EAAkB,EAAlB;AACAlE,iBAAIkE,MAAJ,CAAW,EAAX,EAAe,CAAf,EAAkB,EAAlB,EAAsB,EAAtB,EAA0B,EAA1B,EAA8B,EAA9B,EAAkC,EAAlC,EAAsC,EAAtC,EAA0C,EAA1C;;AAEA,iBAAIc,KAAKhF,GAAT;AACAA,mBAAM,EAAN;AACA,kBAAK,IAAIL,IAAI,CAAR,EAAWsF,KAAKD,GAAG7N,MAAxB,EAAgCwI,IAAIsF,EAApC,EAAwCtF,GAAxC,EAA6C;AACzCK,qBAAIgF,GAAGrF,CAAH,CAAJ,IAAaA,CAAb;AACH;AACDxK,qBAAQ6B,CAAR,IAAagJ,GAAb;;AAGAgF,kBAAKhO,EAAEQ,KAAF,CAAQ,GAAR,EAAa,CAAb,CAAL;AACA,iBAAIqN,SAASzH,OAAT,CAAiByH,WAAWG,GAAG,CAAH,CAA5B,KAAsC,CAA1C,EAA6C;AACzCxK,oBAAGuE,WAAH,CAAetE,SAASoF,aAAT,CAAuB,UAAvB,CAAf;AACArF,oBAAG0K,SAAH,CAAatF,KAAb,GAAqBiF,QAArB;AACH;AACD7E,mBAAMvF,SAASoF,aAAT,CAAuB,QAAvB,CAAN;AACArF,gBAAG0K,SAAH,CAAanG,WAAb,CAAyBiB,GAAzB;AACAA,iBAAIvG,KAAJ,GAAYzC,CAAZ;AACAgJ,iBAAItH,SAAJ,GAAgBsM,GAAG,CAAH,CAAhB;AACAhF,iBAAI1H,QAAJ,GAAgBtB,KAAK9B,MAArB;AACH;AACDA,kBAASC,QAAQD,MAAR,CAAT;AACA,0BAAGkJ,gBAAH,CAAoB5D,EAApB,EAAwB,QAAxB,EAAkCsD,aAAlC;;AAGA,0BAAGM,gBAAH,CAAoB3H,MAAME,IAA1B,EAAgC,WAAhC,EAA6C4G,cAA7C;AACA,0BAAGa,gBAAH,CAAoB3H,MAAME,IAA1B,EAAgC,SAAhC,EAA2CqG,UAA3C;AACA,0BAAGoB,gBAAH,CAAoB3H,MAAME,IAA1B,EAAgC,WAAhC,EAA6C6G,eAA7C;AACA,0BAAGY,gBAAH,CAAoB3H,MAAME,IAA1B,EAAgC,UAAhC,EAA4C6G,eAA5C;AACA,0BAAGY,gBAAH,CAAoB3H,MAAME,IAA1B,EAAgC,OAAhC,EAAyC,iBAAGwO,oBAA5C;;AAGA1O,eAAMC,QAAN,CAAe0O,WAAf,GAA6B,UAAU9J,CAAV,EAAa;AAAE,iBAAI,CAACA,CAAD,IAAM,CAACA,EAAE4B,MAAF,CAASe,OAAhB,IAA2B,YAAY3C,EAAE4B,MAAF,CAASe,OAAT,CAAiBJ,WAAjB,EAA3C,EAA2E,OAAO,KAAP;AAAc,UAArI;;AAGA,aAAIwH,OAAO,6BAAe,oBAAf,CAAX;AACAxQ,iBAAQwB,MAAR,GAAiB,+BAAeyO,GAAf,CAAmB,WAAnB,KAAmCO,KAAKC,SAAxC,IAAqD,IAAtE;AACH,MApEC;AAqET,EA1kCuB,EAAxB;;AA4kCA5Q,iBAAgB6Q,KAAhB,GAAwB,EAAxB;;AAEA7Q,iBAAgB0D,GAAhB;;AAGC,YAAUoN,CAAV,EAAa;AACVA,OAAEC,EAAF,CAAKC,QAAL,GAAgB,YAAY;AACxB,cAAKhR,eAAL,GAAuBA,eAAvB;;AAEA,cAAK+J,IAAL,GAAYkH,KAAZ;AACA,cAAK3G,KAAL,GAAa4G,MAAb;AACA,cAAK1G,MAAL,GAAc2G,OAAd;;AAEA,cAAKnM,cAAL,GAAsBoM,eAAtB;AACA,cAAK5N,YAAL,GAAoB6N,aAApB;AACA,cAAKC,UAAL,GAAkBC,WAAlB;AACA,cAAKC,gBAAL,GAAwBC,iBAAxB;;AAEA,cAAKC,SAAL,GAAiBC,UAAjB;AACA,cAAKC,eAAL,GAAuBC,gBAAvB;;AAGA,kBAASZ,KAAT,CAAgBhH,KAAhB,EAAuB;AACnBjK,6BAAgB+J,IAAhB,CAAqBE,iBAAiB6G,CAAjB,GAAqB7G,MAAMmG,GAAN,CAAU,CAAV,CAArB,GAAoCnG,KAAzD,EAAgE,KAAKmG,GAAL,CAAS,CAAT,CAAhE;AACH;;AAED,kBAASc,MAAT,GAAmB;AACflR,6BAAgBsK,KAAhB;AACH;;AAED,kBAAS6G,OAAT,CAAkBlH,KAAlB,EAAyB;AACrBjK,6BAAgBwK,MAAhB,CAAuBP,iBAAiB6G,CAAjB,GAAqB7G,MAAMmG,GAAN,CAAU,CAAV,CAArB,GAAoCnG,KAA3D,EAAkE,KAAKmG,GAAL,CAAS,CAAT,CAAlE;AACH;;AAGD,kBAASgB,eAAT,GAA2B;AACvB,oBAAOpR,gBAAgBgF,cAAhB,EAAP;AACH;;AAED,kBAASqM,aAAT,CAAuBzO,IAAvB,EAA6B;AACzB,oBAAO5C,gBAAgBwD,YAAhB,CAA6BZ,IAA7B,CAAP;AACH;;AAED,kBAAS2O,WAAT,CAAqBO,OAArB,EAA8B;AAC1B,kBAAK,IAAIxP,IAAI,CAAR,EAAWC,KAAKuP,QAAQrP,MAA7B,EAAqCH,IAAIC,EAAzC,EAA6CD,GAA7C,EAAkD;AAC9CtC,iCAAgB0C,SAAhB,CAA0BoP,QAAQxP,CAAR,CAA1B;AACH;AACJ;;AAED,kBAASmP,iBAAT,GAA6B;AACzB,oBAAOX,EAAEC,EAAF,CAAKC,QAAL,CAAce,QAArB;AACH;;AAED,kBAASJ,UAAT,CAAoBK,GAApB,EAAyB;AACrB,iBAAIA,QAAQC,SAAR,IAAqB,CAACD,MAAMlB,EAAEC,EAAF,CAAKC,QAAL,CAAckB,IAArB,MAA+BD,SAAxD,EACI,MAAM,wCAAN;;AAEJjS,6BAAgB0D,GAAhB,GAAsBsO,GAAtB;AACH;;AAED,kBAASH,gBAAT,CAA0BM,KAA1B,EAAiC;AAC7B,iBAAIA,UAAUF,SAAV,IAAuB,CAACE,QAAQrB,EAAEC,EAAF,CAAKC,QAAL,CAAcoB,MAAvB,MAAmCH,SAA9D,EACI,MAAM,kDAAN;;AAEJjS,6BAAgB6Q,KAAhB,GAAwBsB,KAAxB;AACH;;AAED,gBAAO,IAAP;AACH,MA9DD;;AAgEArB,OAAEC,EAAF,CAAKC,QAAL,CAAce,QAAd,GAAyB,EAAzB;AACH,EAlEA,EAkEEM,MAlEF,CAAD,C;;;;;;;;;;;;;;;;AC3lCA,UAASC,WAAT,CAAqBC,IAArB,EAA6B;AACzB,YAAQ,OAAOA,IAAP,IAAe,WAAvB;AACH;;AAED,UAASC,UAAT,CAAoBD,IAApB,EAA4B;AACxB,YAAQ,OAAOA,IAAP,IAAe,UAAvB;AACH;;AAED,UAASE,QAAT,CAAkBF,IAAlB,EAA0B;AACtB,YAAQ,OAAOA,IAAP,IAAe,QAAvB;AACH;;AAED,UAASG,QAAT,CAAkBH,IAAlB,EAA0B;AACtB,YAAQ,OAAOA,IAAP,IAAe,QAAvB;AACH;;AAED,UAASI,SAAT,CAAmBJ,IAAnB,EAA2B;AACvB,YAAO,CAACG,SAASH,IAAT,KAAkBE,SAASF,IAAT,CAAnB,KAAsC,CAACK,MAAM3F,SAASsF,IAAT,CAAN,CAAvC,IAAgEM,SAAS5F,SAASsF,IAAT,CAAT,CAAvE;AACH;;AAED,UAASO,OAAT,CAAiBP,IAAjB,EAAyB;AACrB,YAAQA,gBAAgBQ,KAAxB;AACH;;AAED,UAASC,QAAT,CAAkBT,IAAlB,EAA0B;AACtB,YAAQA,gBAAgBU,MAAxB;AACH;;AAED,UAASC,SAAT,CAAmBX,IAAnB,EAA2B;AACvB,YAAQ,aAAa,OAAOA,IAA5B;AACH;;AAED,UAASY,QAAT,CAAkBZ,IAAlB,EAA0B;AACtB,YAAOI,UAAUJ,IAAV,KAAmBE,SAASF,IAAT,CAAnB,IAAqCW,UAAUX,IAAV,CAA5C;AACH;;AAED,UAASa,OAAT,CAAiBb,IAAjB,EAAyB;AACrB,SAAIW,UAAUX,IAAV,CAAJ,EAAqB,OAAO,KAAP;AACrB,SAAIS,SAAST,IAAT,KAAkB,IAAIU,MAAJ,CAAW,EAAX,EAAe3P,QAAf,MAA6BiP,KAAKjP,QAAL,EAAnD,EAAoE,OAAO,IAAP;AACpE,SAAImP,SAASF,IAAT,KAAkBG,SAASH,IAAT,CAAtB,EAAsC,OAAO,CAACA,IAAR;AACtC,SAAIc,QAAQd,IAAR,KAAiB,SAASA,IAA9B,EAAoC;AAChC,cAAK,IAAIjQ,CAAT,IAAciQ,IAAd;AAAoB,iBAAIA,KAAKlP,cAAL,CAAoBf,CAApB,CAAJ,EAA4B,OAAO,KAAP;AAAhD;AACH;AACD,YAAO,IAAP;AACH;;AAKD,UAASgR,QAAT,GAAqB;;AASjB,WAAM,kEAAN;AACH;;AAGD,UAASC,QAAT,CAAkBC,KAAlB,EAA2B;AACvB,SAAIC,IAAI1N,SAAS2N,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyC1P,SAAjD;AAAA,SACM2P,KAAK,IAAIV,MAAJ,CAAW,SAAS,oCAAT,GAAgDO,KAAhD,GAAwD,eAAxD,GAA0E,MAArF,EAA6F,GAA7F,CADX;AAAA,SAEMI,IAAIH,EAAEpI,KAAF,CAAQsI,EAAR,CAFV;AAGA,SAAIC,CAAJ,EAAO;;AAEH,aAAIA,EAAE,CAAF,EAAKvI,KAAL,CAAW,kCAAX,CAAJ,EAAoD,OAAOuI,EAAE,CAAF,CAAP;;AAEpD,aAAIA,EAAE,CAAF,EAAKlL,OAAL,CAAa,GAAb,KAAqB,CAAzB,EAA4B,OAAOkL,EAAE,CAAF,CAAP;AAC5BC,aAAI9N,SAAS2N,oBAAT,CAA8B,MAA9B,CAAJ;AACA,aAAIG,EAAE,CAAF,KAAQA,EAAE,CAAF,EAAKC,IAAjB,EAAuB,OAAOD,EAAE,CAAF,EAAKC,IAAL,GAAYF,EAAE,CAAF,CAAnB;;AAEvB,gBAAO,CAAC7N,SAASgO,QAAT,CAAkBD,IAAlB,CAAuBzI,KAAvB,CAA6B,YAA7B,EAA2C,CAA3C,IAAgDuI,EAAE,CAAF,CAAjD,EAAuDrO,OAAvD,CAA+D,MAA/D,EAAuE,EAAvE,CAAP;AACH;AACD,YAAO,IAAP;AACH;;AAED,UAASyO,cAAT,CAAwBR,KAAxB,EAA+B;AAC3B,SAAIC,IAAI1N,SAAS2N,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyC1P,SAAjD;AAAA,SACM2P,KAAK,IAAIV,MAAJ,CAAW,SAAS,wBAAT,GAAoCO,KAApC,GAA4C,oBAA5C,GAAmE,MAA9E,EAAsF,GAAtF,CADX;AAAA,SAEMI,IAAIH,EAAEpI,KAAF,CAAQsI,EAAR,CAFV;AAGA,SAAIC,CAAJ,EAAO,OAAOK,WAAWL,EAAE,CAAF,EAAKrO,OAAL,CAAa,iBAAb,EAAgC,IAAhC,CAAX,CAAP;AACP,YAAO,EAAP;AACH;;AAED,UAAS0O,UAAT,CAAoBC,CAApB,EAAuB;AACnB,SAAI,YAAY,OAAOA,CAAnB,IAAwBA,EAAEzR,MAAF,GAAW,CAAvC,EAA0C,OAAO,EAAP;AAC1CyR,SAAIA,EAAEpR,KAAF,CAAQ,UAAR,CAAJ;AACA,UAAK,IAAImI,IAAI,CAAR,EAAWkJ,KAAKD,EAAEzR,MAAlB,EAA0B2R,KAAK,EAA/B,EAAmCC,EAAnC,EAAuCC,GAA5C,EAAiDrJ,IAAIkJ,EAArD,EAAyDlJ,GAAzD,EAA8D;AAC1DoJ,cAAKH,EAAEjJ,CAAF,EAAKnI,KAAL,CAAW,GAAX,CAAL;;AAEAuR,YAAG,CAAH,IAAQA,GAAG,CAAH,EAAM9O,OAAN,CAAc,YAAd,EAA4B,EAA5B,CAAR;AACA+O,eAAMF,GAAGC,GAAG,CAAH,CAAH,CAAN;;AAEAA,YAAG,CAAH,IAAQE,SAASF,GAAG,CAAH,IAAQA,GAAG,CAAH,EAAM9O,OAAN,CAAc,GAAd,EAAmB,GAAnB,CAAR,GAAkC,EAA3C,CAAR;AACA,aAAI+O,GAAJ;AACI,iBAAI,WAAW,OAAQA,GAAvB,EAA6BF,GAAGC,GAAG,CAAH,CAAH,EAAUD,GAAGC,GAAG,CAAH,CAAH,EAAU5R,MAApB,IAA8B4R,GAAG,CAAH,CAA9B,CAA7B,KACKD,GAAGC,GAAG,CAAH,CAAH,IAAY,CAACD,GAAGC,GAAG,CAAH,CAAH,CAAD,EAAYA,GAAG,CAAH,CAAZ,CAAZ;AAFT,gBAGKD,GAAGC,GAAG,CAAH,CAAH,IAAYA,GAAG,CAAH,CAAZ;AACR;AACD,YAAOD,EAAP;AACH;;AAQD,UAASI,WAAT,CAAqB7M,EAArB,EAAyB8M,EAAzB,EAA6BC,OAA7B,EAAsCC,UAAtC,EAAkD;AAC9C,SAAIlC,SAAS9K,EAAT,CAAJ,EAAkBA,KAAK5B,SAASC,cAAT,CAAwB2B,EAAxB,CAAL;AAClB,SAAI,CAACA,EAAD,IAAO,CAACiN,IAAIC,UAAJ,CAAelN,EAAf,EAAmB,CAAC,OAAD,EAAU,QAAV,EAAoB,OAApB,EAA6B,OAA7B,CAAnB,CAAZ,EAAuE,OAAO,IAAP;AACvE,SAAI,CAACyL,QAAQsB,OAAR,CAAD,KAAsB,CAACjC,SAASiC,OAAT,CAAD,IAAsB,EAAE/M,KAAKA,GAAG+L,oBAAH,CAAwBgB,OAAxB,CAAP,CAA5C,CAAJ,EAA2F,OAAO,IAAP;AAC3F,SAAI,CAACtB,QAAQuB,UAAR,CAAD,KAAyB,CAACjC,SAASiC,UAAT,CAAD,IAAyBA,aAAa,CAAtC,IAA2C,EAAEhN,KAAKA,GAAGgN,UAAH,CAAP,CAApE,CAAJ,EAAiG,OAAO,IAAP;;AAEjG,SAAIrC,YAAY3K,GAAGmN,IAAf,CAAJ,EAA0B,OAAO,IAAP;AAC1B,SAAIxG,MAAM,EAAV;AAAA,SACMyG,OAAOhP,SAASoF,aAAT,CAAuB,MAAvB,CADb;AAAA,SAEM6J,KAAK,IAFX;AAAA,SAGMC,KAAK,IAHX;AAIA,UAAK,IAAI3S,IAAI,CAAR,EAAW4S,KAAKvN,GAAGmN,IAAH,CAAQrS,MAA7B,EAAqCH,IAAI4S,EAAzC,EAA6C5S,GAA7C,EAAkD;AAC9C,aAAI6S,KAAK,EAAT;AACA,aAAIrC,QAAQ2B,EAAR,CAAJ,EAAiB;AACb,kBAAK,IAAIxJ,IAAI,CAAR,EAAWpG,KAAK4P,GAAGhS,MAAxB,EAAgCwI,IAAIpG,EAApC,EAAwCoG,GAAxC,EAA6C;AACzCgK,sBAAKtN,GAAGmN,IAAH,CAAQxS,CAAR,EAAW8S,KAAX,CAAiBX,GAAGxJ,CAAH,CAAjB,CAAL;AACA,qBAAIgK,EAAJ,EAAQ;AACJF,0BAAK/Q,SAAL,GAAiBiR,GAAGI,SAAH,GAAeJ,GAAGI,SAAlB,GAA8BJ,GAAGjR,SAAH,CAAauB,OAAb,CAAqB,0CAArB,EAAiE,EAAjE,CAA/C;AACAwP,0BAAKO,SAAL;AACAH,wBAAGA,GAAG1S,MAAN,IAAgBsS,KAAK/E,UAAL,GAAkB+E,KAAK/E,UAAL,CAAgBuF,SAAhB,CAA0BC,IAA1B,CAA+B,OAA/B,CAAlB,GAA4D,EAA5E;AACH,kBAJD,MAIO;AACHL,wBAAGA,GAAG1S,MAAN,IAAgB,EAAhB;AACH;AACJ;AACJ,UAXD,MAWO;AACH,kBAAK,IAAIwI,IAAI,CAAR,EAAWwK,KAAK9N,GAAGmN,IAAH,CAAQxS,CAAR,EAAW8S,KAAX,CAAiB3S,MAAtC,EAA8CwI,IAAIwK,EAAlD,EAAsDxK,GAAtD,EAA2D;AACvDyK,sBAAK/N,GAAGmN,IAAH,CAAQxS,CAAR,EAAW8S,KAAX,CAAiBnK,CAAjB,CAAL;AACA8J,sBAAK/Q,SAAL,GAAiBiR,GAAGI,SAAH,GAAeJ,GAAGI,SAAlB,GAA8BJ,GAAGjR,SAAH,CAAauB,OAAb,CAAqB,0CAArB,EAAiE,EAAjE,CAA/C;AACAwP,sBAAKO,SAAL;AACAH,oBAAGA,GAAG1S,MAAN,IAAgBsS,KAAK/E,UAAL,GAAkB+E,KAAK/E,UAAL,CAAgBuF,SAAhB,CAA0BC,IAA1B,CAA+B,OAA/B,CAAlB,GAA4D,EAA5E;AACH;AACJ;AACD,aAAI,CAACpC,QAAQ+B,EAAR,CAAL,EAAkB7G,IAAIA,IAAI7L,MAAR,IAAkB0S,EAAlB;AACrB;AACD,YAAO7G,GAAP;AACH;;AAGDvI,UAAS4P,gBAAT,GAA4B,UAAUC,GAAV,EAAgBC,CAAhB,EAAqB;AAC7C,SAAIC,CAAJ;AAAA,SAAOxT,CAAP;AAAA,SAAUyT,CAAV;AAAA,SAAajQ,KAAKC,SAASoF,aAAT,CAAuByK,GAAvB,CAAlB;AACA,SAAI,CAAC9P,EAAL,EAAS,OAAO,IAAP;AACT,UAAKxD,CAAL,IAAUuT,CAAV,EAAa;AACT,aAAI,CAACA,EAAExS,cAAF,CAAiBf,CAAjB,CAAL,EAA0B;AAC1B,iBAAQA,CAAR;AACI,kBAAK,OAAL;AAAcwD,oBAAGkQ,YAAH,CAAgB,WAAhB,EAA6BH,EAAEvT,CAAF,CAA7B,EAAoCwD,GAAGkQ,YAAH,CAAgB,OAAhB,EAAyBH,EAAEvT,CAAF,CAAzB,EAAgC;AAClF,kBAAK,OAAL;AAAc,sBAAKyT,CAAL,IAAUF,EAAEvT,CAAF,CAAV,EAAgB;AAAE,yBAAI,CAACuT,EAAEvT,CAAF,EAAKe,cAAL,CAAoB0S,CAApB,CAAL,EAA6B,SAAUjQ,GAAG6I,KAAH,CAASoH,CAAT,IAAcF,EAAEvT,CAAF,EAAKyT,CAAL,CAAd;AAAwB,kBAAC;AAChG,kBAAK,OAAL;AAAc,sBAAKA,CAAL,IAAUF,EAAEvT,CAAF,CAAV,EAAgB;AAAE,yBAAI,CAACuT,EAAEvT,CAAF,EAAKe,cAAL,CAAoB0S,CAApB,CAAL,EAA6B,SAAUjQ,GAAGmQ,WAAH,CAAeF,CAAf,EAAkBF,EAAEvT,CAAF,EAAKyT,CAAL,CAAlB;AAA6B,kBAAC;AACrG,kBAAK,OAAL;AAAcD,qBAAID,EAAEvT,CAAF,EAAKG,MAAT,CAAiB,KAAKsT,IAAI,CAAT,EAAYA,IAAID,CAAhB,EAAmBC,GAAnB;AAAwBjQ,wBAAGuE,WAAH,CAAewL,EAAEvT,CAAF,EAAKyT,CAAL,CAAf;AAAxB,kBAAiD;AAChF,kBAAK,OAAL;AAAc,sBAAKA,CAAL,IAAUF,EAAEvT,CAAF,CAAV,EAAgB;AAAE,yBAAI,CAACuT,EAAEvT,CAAF,EAAKe,cAAL,CAAoB0S,CAApB,CAAL,EAA6B,SAAU,IAAI;AAAEjQ,4BAAGiQ,CAAH,IAAQF,EAAEvT,CAAF,EAAKyT,CAAL,CAAR;AAAiB,sBAAvB,CAAwB,OAAOnP,CAAP,EAAU,CAAG;AAAE,kBAAC;AALnH;AAOH;AACD,YAAOd,EAAP;AACH,EAdD;;AAiBA,UAASoQ,YAAT,CAAsBC,CAAtB,EAA0B7T,CAA1B,EAA8BuI,CAA9B,EAAmC;AAAE,YAAOuL,YAAY,YAAY;AAAGvL,sBAAakI,KAAd,GAAuBoD,EAAEE,KAAF,CAAQ,IAAR,EAAcxL,CAAd,CAAvB,GAA0CsL,EAAEG,IAAF,CAAO,IAAP,EAAazL,CAAb,CAA1C;AAA2D,MAArF,EAAuFvI,CAAvF,CAAP;AAAkG;AACvI,UAASiU,WAAT,CAAqBJ,CAArB,EAAyB7T,CAAzB,EAA6BuI,CAA7B,EAAkC;AAAE,YAAO2L,WAAW,YAAY;AAAG3L,sBAAakI,KAAd,GAAuBoD,EAAEE,KAAF,CAAQ,IAAR,EAAcxL,CAAd,CAAvB,GAA0CsL,EAAEG,IAAF,CAAO,IAAP,EAAazL,CAAb,CAA1C;AAA2D,MAApF,EAAsFvI,CAAtF,CAAP;AAAiG;;AAGrI,UAASmU,WAAT,CAAqBC,GAArB,EAA0B;AACtB,SAAIvD,SAASuD,GAAT,KAAiBlE,WAAWkE,GAAX,CAAjB,IAAoC,QAAQA,GAAhD,EAAqD,OAAOA,GAAP;AACrD,SAAI;AAAE,aAAIC,YAAY,IAAID,IAAIE,WAAR,EAAhB;AAAwC,MAA9C,CAA+C,OAAOhQ,CAAP,EAAU;AAAE,gBAAO,IAAP;AAAc;AACzE,SAAIkM,QAAQ6D,SAAR,CAAJ,EAAwB;AACpB,cAAK,IAAIrU,IAAI,CAAR,EAAWuU,KAAKH,IAAIjU,MAAzB,EAAiCH,IAAIuU,EAArC,EAAyCvU,GAAzC,EAA8C;AAC1CqU,uBAAUrU,CAAV,IAAemU,YAAYC,IAAIpU,CAAJ,CAAZ,CAAf;AACH;AACJ,MAJD,MAIO;AACH,cAAK,IAAIA,CAAT,IAAcoU,GAAd,EAAmB;AACf,iBAAI,CAACA,IAAIrT,cAAJ,CAAmBf,CAAnB,CAAL,EAA4B;AAC5BqU,uBAAUrU,CAAV,IAAemU,YAAYC,IAAIpU,CAAJ,CAAZ,CAAf;AACH;AACJ;AACD,YAAOqU,SAAP;AACH;;AAGD,UAASG,WAAT,GAAuB;AACnB,SAAIxI,MAAM,EAAV;AAAA,SACMyI,EADN;AAAA,SAEML,GAFN;AAGA,UAAK,IAAIzL,IAAI,CAAR,EAAW1I,KAAKC,UAAUC,MAA/B,EAAuCwI,IAAI1I,EAA3C,EAA+C0I,GAA/C,EAAoD;AAChDyL,eAAMlU,UAAUyI,CAAV,CAAN;AACA,cAAK,IAAI3I,CAAT,IAAcoU,GAAd,EAAmB;AACf,iBAAI,CAACA,IAAIrT,cAAJ,CAAmBf,CAAnB,CAAL,EAA4B;AAC5ByU,kBAAKL,IAAIpU,CAAJ,CAAL;AACA,iBAAI,QAAQyU,EAAZ,EAAgB;AACZ,qBAAI,CAACzI,IAAIjL,cAAJ,CAAmBf,CAAnB,CAAL,EAA4BgM,IAAIhM,CAAJ,IAASyU,EAAT;AAC/B,cAFD,MAEO,IAAIjE,QAAQiE,EAAR,CAAJ,EAAiB;AACpB,qBAAIjE,QAAQxE,IAAIhM,CAAJ,CAAR,CAAJ,EACIgM,IAAIhM,CAAJ,IAASgM,IAAIhM,CAAJ,EAAO0U,MAAP,CAAcD,EAAd,EAAkBE,MAAlB,EAAT,CADJ,KAGI3I,IAAIhM,CAAJ,IAASyU,GAAGG,KAAH,CAAS,CAAT,CAAT;AACP,cALM,MAKA,IAAI/D,SAAS4D,EAAT,KAAgBvE,WAAWuE,EAAX,CAApB,EAAoC;AACvCzI,qBAAIhM,CAAJ,IAASyU,EAAT;AACH,cAFM,MAEA;AACH,qBAAIzI,IAAIjL,cAAJ,CAAmBf,CAAnB,CAAJ,EACIgM,IAAIhM,CAAJ,IAASwU,YAAYxI,IAAIhM,CAAJ,CAAZ,EAAoByU,EAApB,CAAT,CADJ,KAGIzI,IAAIhM,CAAJ,IAASmU,YAAYM,EAAZ,CAAT;AACP;AACJ;AACJ;AACD,YAAOzI,GAAP;AACH;;AAOD,UAAS6I,cAAT,CAAwBC,EAAxB,EAA4B;AACxB,SAAI,CAACC,cAAcD,EAAd,CAAL,EAAwB;AACpB,aAAIE,OAAOvR,SAAS2N,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAAX;AAAA,aACM6D,OAAOxR,SAASoF,aAAT,CAAuB,MAAvB,CADb;AAEAoM,cAAKC,GAAL,GAAW,YAAX;AACAD,cAAKpQ,IAAL,GAAY,UAAZ;AACAoQ,cAAKzD,IAAL,GAAYsD,EAAZ;AACAE,cAAKjN,WAAL,CAAiBkN,IAAjB;AACH;AACJ;;AAGD,UAASF,aAAT,CAAuBI,IAAvB,EAA6B;AACzB,SAAIhE,IAAI1N,SAAS2N,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyC1P,SAAjD;AAAA,SACM2P,KAAK,IAAIV,MAAJ,CAAW,yCAAyCmE,EAAzC,GAA8C,QAAzD,EAAmE,GAAnE,CADX;AAEA,YAAOzD,GAAG+D,IAAH,CAAQjE,CAAR,CAAP;AACH;;SAGGnB,W,GAAAA,W;SAAaE,U,GAAAA,U;SAAYC,Q,GAAAA,Q;SAAUC,Q,GAAAA,Q;SAAUC,S,GAAAA,S;SAAWG,O,GAAAA,O;SAASE,Q,GAAAA,Q;SAAUE,S,GAAAA,S;SAAWC,Q,GAAAA,Q;SAAUC,O,GAAAA,O;SAChGE,Q,GAAAA,Q;SAAUC,Q,GAAAA,Q;SAAUS,c,GAAAA,c;SAAgBC,U,GAAAA,U;SACpCO,W,GAAAA,W;SAAa0B,Y,GAAAA,Y;SAAcK,W,GAAAA,W;SAAaE,W,GAAAA,W;SAAaK,W,GAAAA,W;SAAaK,c,GAAAA,c;SAAgBE,a,GAAAA,a;;;;;;;;;;;ACvPtF;;AAqBA,KAAI,0BAAYtE,MAAM4E,SAAN,CAAgBC,IAA5B,CAAJ,EAAuC;AACnC7E,WAAM4E,SAAN,CAAgBC,IAAhB,GAAuB,YAAY;AAC/B,aAAIA,OAAO,IAAI7E,KAAJ,EAAX;AACA,cAAK,IAAIzQ,IAAI,CAAR,EAAWmT,KAAK,KAAKhT,MAA1B,EAAkCH,IAAImT,EAAtC,EAA0CnT,GAA1C,EAA+C;AAC3CsV,kBAAKtV,CAAL,IAAU,KAAKA,CAAL,CAAV;AACH;AACD,gBAAOsV,IAAP;AACH,MAND;AAOH;;AAmID,KAAI,0BAAY7E,MAAM4E,SAAN,CAAgBV,MAA5B,CAAJ,EAAyC;;AAErClE,WAAM4E,SAAN,CAAgBV,MAAhB,GAAyB,YAAa;AAClC,aAAIY,MAAM,EAAV;AACA,cAAK,IAAIvV,IAAI,CAAR,EAAWmT,KAAK,KAAKhT,MAA1B,EAAkCH,IAAImT,EAAtC,EAA0CnT,GAA1C,EAA+C;AAC3C,iBAAIuV,IAAInP,OAAJ,CAAY,KAAKpG,CAAL,CAAZ,IAAuB,CAA3B,EAA8BuV,IAAIA,IAAIpV,MAAR,IAAkB,KAAKH,CAAL,CAAlB;AACjC;AACD,gBAAOuV,GAAP;AACH,MAND;AAOH;;AAED,KAAI,0BAAY9E,MAAM4E,SAAN,CAAgBG,OAA5B,CAAJ,EAA0C;;AAEtC/E,WAAM4E,SAAN,CAAgBG,OAAhB,GAA0B,UAAUC,IAAV,EAAiBrC,EAAjB,EAAsB;AAC5C,aAAI,KAAKjT,MAAL,GAAc,CAAlB,EAAqB,OAAO,EAAP;AACrB,aAAIkQ,UAAUoF,IAAV,CAAJ,EAAqBA,OAAO,CAACA,IAAD,CAAP;AACrB,aAAIvJ,MAAM,KAAV;AACA,aAAIsE,QAAQiF,IAAR,CAAJ,EAAmB;AACfvJ,mBAAM,EAAN;AACA,kBAAK,IAAIlM,IAAI,CAAR,EAAWuC,KAAKkT,KAAKtV,MAA1B,EAAkCH,IAAIuC,EAAtC,EAA0CvC,GAA1C;AAA+CkM,qBAAIuJ,KAAKzV,CAAL,CAAJ,IAAe,IAAf;AAA/C;AACH;AACD,aAAIuV,MAAM,EAAV;AACA,cAAK,IAAIvV,IAAI,CAAR,EAAWmT,KAAK,KAAKhT,MAA1B,EAAkCH,IAAImT,EAAtC,EAA0CnT,GAA1C,EAA+C;AAC3C,iBAAI,0BAAY,KAAKA,CAAL,CAAZ,CAAJ,EAA0B;AAC1B,iBAAI,CAACwQ,QAAQ,KAAKxQ,CAAL,CAAR,CAAL,EAAuB;AACnB,qBAAI,UAAUkM,GAAd,EAAmBqJ,IAAIA,IAAIpV,MAAR,IAAkB,KAAKH,CAAL,CAAlB;AACtB,cAFD,MAEO;AACH,sBAAK,IAAIyT,IAAI,CAAR,EAAWlR,KAAK,KAAKvC,CAAL,EAAQG,MAA7B,EAAqCsT,IAAIlR,EAAzC,EAA6CkR,GAA7C,EAAkD;AAC9C,yBAAI,UAAUvH,GAAV,IAAiBA,IAAInL,cAAJ,CAAmB0S,CAAnB,CAArB,EAA4C8B,IAAIA,IAAIpV,MAAR,IAAkB,KAAKH,CAAL,EAAQyT,CAAR,CAAlB;AAC/C;AACJ;AACJ;AACD,gBAAO8B,GAAP;AACH,MApBD;AAqBH;;AAkBD,KAAI,0BAAY9E,MAAM4E,SAAN,CAAgBK,SAA5B,CAAJ,EAA4C;;AAExCjF,WAAM4E,SAAN,CAAgBK,SAAhB,GAA4B,UAAUlS,EAAV,EAAcX,GAAd,EAAmB;AAC3C,aAAIxC,IAAI,CAAR;AAAA,aACMsV,IAAI,KAAKxV,MADf;AAAA,aAEMyV,MAAMC,KAAKC,GAAL,CAASH,IAAI,CAAb,EAAgB,CAAhB,CAFZ;AAAA,aAGM5H,IAAI8H,KAAKE,IAAL,CAAUJ,IAAI,CAAd,CAHV;AAAA,aAIMK,MAAM,CAJZ;AAKA,aAAI,QAAQnT,GAAZ,EACI,OAAO,CAAC,CAAC,KAAKkL,CAAL,CAAD,IAAYvK,MAAM,KAAKuK,CAAL,EAAQlL,GAAR,CAAnB,KAAoC8S,KAAKtV,CAAhD,EAAmD;AAC/C,iBAAI,KAAK0N,CAAL,KAAWvK,KAAK,KAAKuK,CAAL,EAAQlL,GAAR,CAApB,EACIxC,IAAI0N,IAAI,CAAR,CADJ,KAGI4H,IAAI5H,IAAI,CAAR;AACJA,iBAAI8H,KAAKC,GAAL,CAAS,CAAT,EAAYD,KAAKE,IAAL,CAAU,CAACJ,IAAItV,CAAL,IAAU,CAApB,CAAZ,CAAJ;AACH,UAPL,MASI,OAAOmD,MAAM,KAAKuK,CAAL,CAAN,IAAiB4H,KAAKtV,CAA7B,EAAgC;AAC5B,iBAAImD,KAAK,KAAKuK,CAAL,CAAT,EACI1N,IAAI0N,IAAI,CAAR,CADJ,KAGI4H,IAAI5H,IAAI,CAAR;AACJA,iBAAI8H,KAAKC,GAAL,CAAS,CAAT,EAAYD,KAAKE,IAAL,CAAU,CAACJ,IAAItV,CAAL,IAAU,CAApB,CAAZ,CAAJ;AACH;AACL,gBAAO0N,CAAP;AACH,MAvBD;AAwBH;;AAED0C,OAAM4E,SAAN,CAAgB1S,QAAhB,GAA2B,YAAY;;AAInC,SAAIsT,OAAO,SAAPA,IAAO,CAAUC,GAAV,EAAeC,GAAf,EAAoBC,EAApB,EAAwB;AAC/B,aAAIrI,CAAJ;AAAA,aAAOwH,MAAMW,IAAIC,GAAJ,CAAb;;AAEA,gBAAO,IAAP,EAAa;AACTpI,iBAAI,CAACoI,OAAO,CAAR,IAAa,CAAjB;AACA,iBAAIpI,IAAIqI,EAAR,EAAY;AACZ,iBAAIrI,IAAIqI,EAAJ,IAAUF,IAAInI,IAAI,CAAR,IAAamI,IAAInI,CAAJ,CAA3B,EAAmCA;AACnC,iBAAIwH,OAAOW,IAAInI,CAAJ,CAAX,EAAmB;AACnBmI,iBAAIC,GAAJ,IAAWD,IAAInI,CAAJ,CAAX;AACAoI,mBAAMpI,CAAN;AACH;AACDmI,aAAIC,GAAJ,IAAWZ,GAAX;AACH,MAZD;AAAA,SAaIA,GAbJ;AAAA,SAcIc,UAAU,KAAKlW,MAAL,GAAc,CAd5B;AAAA,SAeIH,IAAIqW,WAAW,CAfnB;;AAiBA,YAAOrW,KAAK,CAAZ;AACIiW,cAAK,IAAL,EAAWjW,GAAX,EAAgBqW,OAAhB;AADJ,MAGArW,IAAIqW,OAAJ;AACA,YAAOrW,IAAI,CAAX,EAAc;;AAEVuV,eAAM,KAAK,CAAL,CAAN;AACA,cAAK,CAAL,IAAU,KAAKvV,CAAL,CAAV;AACA,cAAKA,CAAL,IAAUuV,GAAV;AACAU,cAAK,IAAL,EAAW,CAAX,EAAc,EAAEjW,CAAhB;AACH;AACD,YAAO,IAAP;AACH,EAjCD;;AAqCA,KAAI,0BAAYyQ,MAAM6F,KAAlB,CAAJ,EAA8B;;AAE1B7F,WAAM6F,KAAN,GAAc,UAAUC,GAAV,EAAgBhR,KAAhB,EAAwBiR,GAAxB,EAA+B;AACzC,aAAI,CAACpG,SAASmG,GAAT,CAAL,EAAoB,OAAO,IAAP;AACpB,aAAI,CAACnG,SAASoG,GAAT,CAAL,EAAoBA,MAAM,CAAN;AACpB,aAAI,CAACpG,SAAS7K,KAAT,CAAL,EAAsBA,QAAQ,CAAR;AACtB,aAAIgQ,MAAM,EAAV;AAAA,aACMkB,KAAKZ,KAAKa,GAAL,CAASnR,KAAT,EAAgBgR,GAAhB,CADX;AAAA,aAEMI,KAAKd,KAAKC,GAAL,CAASvQ,KAAT,EAAgBgR,GAAhB,CAFX;AAAA,aAGMvW,IAAI6V,KAAKe,GAAL,CAASJ,GAAT,CAHV;AAAA,aAIMR,MAAM,CAAC,CAJb;AAKA,YAAG;AACCA;AACAT,iBAAIS,GAAJ,IAAWS,EAAX;AACAA,mBAAMzW,CAAN;AACH,UAJD,QAISyW,MAAME,EAJf;AAKA,gBAAOH,MAAM,CAAN,GAAUjB,GAAV,GAAgBA,IAAIsB,OAAJ,EAAvB;AACH,MAfD;AAgBH,E;;;;;;;;;;;ACtSD,KAAI,eAAe,OAAOC,OAAO/V,cAAjC,EAAiD;AAC/C+V,UAAOzB,SAAP,CAAiBtU,cAAjB,GAAkC,UAAUkP,IAAV,EAAgB;AAChD,YAAO,EAAE,eAAe,OAAO,KAAKA,IAAL,CAAtB,IAAoC,KAAKqE,WAAL,IAAoB,KAAKA,WAAL,CAAiBe,SAAjB,CAA2BpF,IAA3B,CAApB,IAAwD,KAAKA,IAAL,MAAe,KAAKqE,WAAL,CAAiBe,SAAjB,CAA2BpF,IAA3B,CAA7G,CAAP;AACD,IAFD;AAGD,E;;;;;;;;;;;ACHDU,QAAOoG,MAAP,GAAgB,SAASA,MAAT,CAAiBC,IAAjB,EAAyB;AACvC,OAAI,CAACD,OAAOE,GAAZ,EAAiB;AACf,SAAIC,WAAW,CACb,GADa,EACR,GADQ,EACH,GADG,EACE,GADF,EACO,GADP,EACY,GADZ,EAEb,GAFa,EAER,GAFQ,EAEH,GAFG,EAEE,GAFF,EAEO,GAFP,EAEY,GAFZ,EAEiB,GAFjB,EAEsB,GAFtB,EAE2B,IAF3B,CAAf;AAIAH,YAAOE,GAAP,GAAa,IAAItG,MAAJ,CACX,QAAQuG,SAAS9N,IAAT,CAAc,KAAd,CAAR,GAA+B,GADpB,EACyB,GADzB,CAAb;AAGD;AACD,UAAO+G,SAAS6G,IAAT,IAAeA,KAAK/T,OAAL,CAAa8T,OAAOE,GAApB,EAAyB,MAAzB,CAAf,GACgBzG,QAAQwG,IAAR,IAAcA,KAAKhO,GAAL,CAAS2H,OAAOoG,MAAhB,EAAwB3N,IAAxB,CAA6B,GAA7B,CAAd,GACc,EAFrC;AAGD,EAbD,C;;;;;;;;;;;ACAAF,QAAOC,eAAP,GAAyB,UAAS7I,IAAT,EAAe;AACpC,SAAIA,OAAK,OAAT,EAAkB;AACd,gBAAO4I,OAAO0B,YAAP,CAAoBtK,IAApB,CAAP;AACH;AACDA,aAAQ,OAAR;AACA,YAAO4I,OAAO0B,YAAP,CAAoBtK,QAAO,EAAP,GAAY,MAAhC,IAAwC4I,OAAO0B,YAAP,CAAoBtK,OAAO,KAAP,GAAe,MAAnC,CAA/C;AACH,EAND;;AAQA4I,QAAOmM,SAAP,CAAiB9U,YAAjB,GAAgC,SAASA,YAAT,GAAwB;AACpD,SAAI,CAACA,aAAakS,IAAlB,EAAwBlS,aAAakS,IAAb,GAAoBhP,SAASoF,aAAT,CAAuB,MAAvB,CAApB;AACxB,SAAIP,IAAI/H,aAAakS,IAArB;AACAnK,OAAE5G,SAAF,GAAc,IAAd;AACA,YAAO4G,EAAEoF,UAAF,GAAapF,EAAEoF,UAAF,CAAauF,SAA1B,GAAoC,EAA3C;AACH,EALD;;AAQA/J,QAAOmM,SAAP,CAAiB8B,KAAjB,GAAyB,UAASpJ,CAAT,EAAY;AACjC,SAAIoC,SAASpC,CAAT,CAAJ,EAAiBA,IAAEA,EAAEvN,KAAF,CAAQ,EAAR,CAAF;AACjB,SAAIgQ,QAAQzC,CAAR,KAAciC,YAAYjC,CAAZ,CAAlB,EAAkC;AAC9BA,aAAI+C,QAAQ/C,CAAR,IAAW,KAAX,GAAiB4C,OAAOoG,MAAP,CAAchJ,CAAd,CAArB;AACAA,aAAI,IAAI4C,MAAJ,CAAW,SAAO5C,CAAP,GAAS,IAApB,EAA0B,GAA1B,CAAJ;AACA,gBAAO,KAAK9K,OAAL,CAAa8K,CAAb,EAAgB,EAAhB,CAAP;AACH;AACD,YAAO,IAAP;AACH,EARD;;AAUA7E,QAAOmM,SAAP,CAAiB+B,KAAjB,GAAyB,UAASrJ,CAAT,EAAY;AACjC,SAAIoC,SAASpC,CAAT,CAAJ,EAAiBA,IAAEA,EAAEvN,KAAF,CAAQ,EAAR,CAAF;AACjB,SAAIgQ,QAAQzC,CAAR,KAAciC,YAAYjC,CAAZ,CAAlB,EAAkC;AAC9BA,aAAI+C,QAAQ/C,CAAR,IAAW,KAAX,GAAiB4C,OAAOoG,MAAP,CAAchJ,CAAd,CAArB;AACAA,aAAI,IAAI4C,MAAJ,CAAW,QAAM5C,CAAN,GAAQ,KAAnB,EAA0B,GAA1B,CAAJ;AACA,gBAAO,KAAK9K,OAAL,CAAa8K,CAAb,EAAgB,EAAhB,CAAP;AACH;AACD,YAAO,IAAP;AACH,EARD;;AA2BA7E,QAAOmM,SAAP,CAAiBgC,GAAjB,GAAuB,YAAW;AAC9B,SAAIC,MAAM,KAAKC,OAAL,EAAV;AACA,YAAO,CAACD,GAAD,EAAKA,GAAL,EAAUlO,IAAV,CAAe,EAAf,CAAP;AACH,EAHD;;AAKAF,QAAOmM,SAAP,CAAiBmC,MAAjB,GAA0B,UAAShP,CAAT,EAAc;AACpC,SAAI8H,MAAM9H,IAAEmC,SAASnC,CAAT,CAAR,KAAwBA,IAAE,CAA9B,EAAiC,OAAO,EAAP;AACjC,YAAOiI,MAAMjI,IAAE,CAAR,EAAWY,IAAX,CAAgB,KAAKmO,OAAL,EAAhB,CAAP;AACH,EAHD;;AAKArO,QAAOmM,SAAP,CAAiBoC,OAAjB,GAA2B,UAASjP,CAAT,EAAYuF,CAAZ,EAAe;AACtC,SAAIuJ,MAAM,KAAKC,OAAL,EAAV;AACA/O,SAAImC,SAASnC,CAAT,CAAJ;AACA,SAAI,CAACA,CAAL,EAAQ,OAAO8O,GAAP;AACR,SAAItH,YAAYjC,CAAZ,CAAJ,EAAoBA,IAAI,GAAJ;AACpB,SAAI2J,MAAMxO,OAAO6E,CAAP,EAAU5B,MAAV,CAAiB,CAAjB,EAAoBqL,MAApB,CAA2B3B,KAAKe,GAAL,CAASpO,CAAT,IAAc,KAAKrI,MAA9C,CAAV;AACA,YAAQqI,IAAI,CAAL,GAAUkP,MAAMJ,GAAhB,GAAsBA,MAAMI,GAAnC;AACH,EAPD;;AASAxO,QAAOmM,SAAP,CAAiBsC,OAAjB,GAA2B,UAASnP,CAAT,EAAYuF,CAAZ,EAAe;AACtC,YAAO,KAAK0J,OAAL,CAAa,CAAC5B,KAAKe,GAAL,CAASpO,CAAT,CAAd,EAA2BuF,CAA3B,CAAP;AACH,EAFD;;AAIA7E,QAAOmM,SAAP,CAAiBuC,QAAjB,GAA4B,UAASpP,CAAT,EAAYuF,CAAZ,EAAe;AACvC,YAAO,KAAK0J,OAAL,CAAa5B,KAAKe,GAAL,CAASpO,CAAT,CAAb,EAA0BuF,CAA1B,CAAP;AACH,EAFD;;AAKA7E,QAAOmM,SAAP,CAAiBwC,OAAjB,GAA2B,YAAW;AAClC,SAAIC,OAAOtH,QAAQtQ,UAAU,CAAV,CAAR,IAAsBA,UAAU,CAAV,CAAtB,GAAmCA,SAA9C;AAAA,SACI6X,QAAQ,CADZ;AAAA,SAEIC,OAAO,KAAK/U,OAAL,CAAa,KAAb,EAAoB,MAApB,CAFX;AAAA,SAGIgV,KAAK,gGAHT;;AAKAD,YAAOA,KAAK/U,OAAL,CAAagV,EAAb,EAAiB,YAAW;AAC/B,aAAIC,IAAIhY,SAAR;AAAA,aACIiY,OAAO,KADX;AAAA,aAEIC,GAFJ;;AAKA,aAAI,CAACpI,YAAYkI,EAAE,CAAF,CAAZ,CAAD,IAAsBA,EAAE,CAAF,EAAK9R,OAAL,CAAa,GAAb,KAAmB,CAA7C,EAAgD;AAC5C8R,eAAE,CAAF,IAAOvN,SAASuN,EAAE,CAAF,EAAKjV,OAAL,CAAa,KAAb,EAAmB,EAAnB,CAAT,CAAP;AACA,iBAAIqN,MAAM4H,EAAE,CAAF,CAAN,CAAJ,EAAiB;AACfA,mBAAE,CAAF,IAAOJ,KAAKC,KAAL,CAAP;;AAEAA;AACD,cAJD,MAIO;AACLG,mBAAE,CAAF,IAAOJ,KAAKI,EAAE,CAAF,CAAL,CAAP;AACD;AACJ;;AAED,aAAI,MAAMA,EAAE,CAAF,CAAV,EAAgB;AACZ,iBAAIA,EAAE,CAAF,EAAK9R,OAAL,CAAa,GAAb,KAAmB,CAAvB,EAA0B;AACtB8R,mBAAE,CAAF,IAAOvN,SAASuN,EAAE,CAAF,EAAKjV,OAAL,CAAa,KAAb,EAAmB,EAAnB,CAAT,CAAP;AACA,qBAAIqN,MAAM4H,EAAE,CAAF,CAAN,CAAJ,EAAiB;AACfA,uBAAE,CAAF,IAAOJ,KAAKC,KAAL,CAAP;;AAEAA;AACD,kBAJD,MAIO;AACLG,uBAAE,CAAF,IAAOJ,KAAKI,EAAE,CAAF,CAAL,CAAP;AACD;AACJ,cATD,MASO;AACHA,mBAAE,CAAF,IAAOA,EAAE,CAAF,EAAKjV,OAAL,CAAa,IAAb,EAAkB,EAAlB,CAAP;AACH;AACDiV,eAAE,CAAF,IAAOrC,KAAKe,GAAL,CAASsB,EAAE,CAAF,CAAT,CAAP;AACH;;AAEDA,WAAE,CAAF,IAAOvN,SAASuN,EAAE,CAAF,CAAT,CAAP;AACA,aAAIE,GAAJ;AACA,aAAI/H,UAAU6H,EAAE,CAAF,CAAV,CAAJ,EAAqB;AACjBE,mBAAMN,KAAKI,EAAE,CAAF,CAAL,CAAN;AACH,UAFD,MAEO;AACHE,mBAAMN,KAAKC,KAAL,CAAN;;AAEAA;AACH;AACD,iBAAQG,EAAE,CAAF,CAAR;AACA,kBAAK,GAAL;AACI,qBAAIE,MAAI,CAAR,EAAWA,MAAM,sBAAoBzN,SAASyN,GAAT,CAA1B;AACXA,uBAAMC,OAAOD,GAAP,EAAYE,GAAZ,CAAgBJ,EAAE,CAAF,CAAhB,CAAN;AACA,qBAAIA,EAAE,CAAF,CAAJ,EAAUE,MAAMA,IAAIG,MAAJ,CAAW,CAAX,EAAaL,EAAE,CAAF,CAAb,CAAN;AACV,qBAAIA,EAAE,CAAF,KAAM,GAAV,EAAeE,MAAM,OAAKA,GAAX;AACf;AACJ,kBAAK,GAAL;AACIA,uBAAMlP,OAAO0B,YAAP,CAAoBwN,GAApB,CAAN;AACA;AACJ,kBAAK,GAAL;AACIA,uBAAMvC,KAAKe,GAAL,CAASwB,GAAT,CAAN;AACJ,kBAAK,GAAL;AACIA,uBAAMvC,KAAK2C,KAAL,CAAWJ,GAAX,CAAN;AACA,qBAAIA,MAAI,CAAR,EAAW;AACPA,2BAAM,MAAIvC,KAAKe,GAAL,CAASwB,GAAT,EAAcK,GAAd,CAAkBP,EAAE,CAAF,CAAlB,CAAV;AACH,kBAFD,MAEO;AACHE,2BAAMC,OAAOD,GAAP,EAAYK,GAAZ,CAAgBP,EAAE,CAAF,CAAhB,CAAN;AACAC,4BAAQD,EAAE,CAAF,KAAQ,GAAR,IAAeA,EAAE,CAAF,KAAQ,GAA/B;AACH;AACD;AACJ,kBAAK,GAAL;AACA,kBAAK,GAAL;AACI,qBAAIE,MAAI,CAAR,EAAW;AACPD,4BAAQD,EAAE,CAAF,KAAQ,GAAR,IAAeA,EAAE,CAAF,KAAQ,GAA/B;AACH;AACDE,uBAAMC,OAAOD,GAAP,EAAYM,aAAZ,CAA0BR,EAAE,CAAF,IAAKA,EAAE,CAAF,CAAL,GAAU,CAApC,CAAN;AACA,qBAAIA,EAAE,CAAF,KAAM,GAAV,EAAeE,MAAIA,IAAI5V,WAAJ,EAAJ;AACf;AACJ,kBAAK,GAAL;AACI,qBAAI4V,MAAI,CAAR,EAAW;AACPD,4BAAQD,EAAE,CAAF,KAAQ,GAAR,IAAeA,EAAE,CAAF,KAAQ,GAA/B;AACH;AACDE,uBAAMC,OAAOD,GAAP,EAAYO,OAAZ,CAAoBtI,UAAU6H,EAAE,CAAF,CAAV,IAAgBA,EAAE,CAAF,CAAhB,GAAqB,CAAzC,CAAN;AACA;AACJ,kBAAK,GAAL;AACI,qBAAIE,MAAI,CAAR,EAAWA,MAAM,sBAAoBzN,SAASyN,GAAT,CAA1B;AACXA,uBAAMC,OAAOD,GAAP,EAAYpX,QAAZ,CAAqB,CAArB,CAAN;AACA,qBAAIkX,EAAE,CAAF,CAAJ,EAAUE,MAAMA,IAAIG,MAAJ,CAAW,CAAX,EAAaL,EAAE,CAAF,CAAb,CAAN;AACV,qBAAIA,EAAE,CAAF,KAAM,GAAN,IAAaE,OAAO,CAAxB,EAA2BA,MAAM,MAAIA,GAAV;AAC3B;AACJ,kBAAK,GAAL;AACIA,uBAAMlP,OAAOkP,GAAP,CAAN;AACA,qBAAIF,EAAE,CAAF,CAAJ,EAAUE,MAAMA,IAAIG,MAAJ,CAAW,CAAX,EAAaL,EAAE,CAAF,CAAb,CAAN;AACV;AACJ,kBAAK,GAAL;AACA,kBAAK,GAAL;AACI,qBAAIE,MAAI,CAAR,EAAWA,MAAM,sBAAoBzN,SAASyN,GAAT,CAA1B;AACXA,uBAAMC,OAAOD,GAAP,EAAYQ,GAAZ,CAAgB,CAACV,EAAE,CAAF,CAAjB,CAAN;AACA,qBAAIA,EAAE,CAAF,CAAJ,EAAUE,MAAMA,IAAIG,MAAJ,CAAW,CAAX,EAAaL,EAAE,CAAF,CAAb,CAAN;AACV,qBAAIA,EAAE,CAAF,KAAM,GAAV,EAAeE,MAAM,OAAKA,GAAX;AACf,qBAAIF,EAAE,CAAF,KAAM,GAAV,EAAeE,MAAMA,IAAI5V,WAAJ,EAAN;AACf;AApDJ;AAsDA,aAAI2V,IAAJ,EAAUC,MAAMF,EAAE,CAAF,IAAKE,GAAX;AACV,aAAIF,EAAE,CAAF,CAAJ,EAAUE,MAAOF,EAAE,CAAF,KAAM,GAAN,IAAaA,EAAE,CAAF,IAAK,CAAnB,GAAsBE,IAAIR,QAAJ,CAAaM,EAAE,CAAF,CAAb,CAAtB,GAAyCE,IAAIT,OAAJ,CAAYO,EAAE,CAAF,CAAZ,EAAiBA,EAAE,CAAF,KAAM,GAAN,GAAU,CAAV,GAAY,GAA7B,CAA/C;AACV,gBAAOE,GAAP;AACH,MAnGM,CAAP;AAoGA,YAAOJ,KAAK/U,OAAL,CAAa,OAAb,EAAsB,GAAtB,CAAP;AACH,EA3GD,C;;;;;;;;;;;;;;;AClFA,KAAM4V,iBAAiB,IAAI,YAAY;AACnC,SAAIlb,OAAO,IAAX;;AAEA,SAAImb,SAAS,EAAb;;AAGAnb,UAAKmQ,GAAL,GAAW,UAAUrN,IAAV,EAAgB;AACvB,gBAAOqY,OAAOrY,IAAP,CAAP;AACH,MAFD;;AAKA9C,UAAKqE,GAAL,GAAW,UAAUvB,IAAV,EAAgBgC,KAAhB,EAAuBsW,MAAvB,EAA+B5D,IAA/B,EAAqCrU,MAArC,EAA6CkY,MAA7C,EAAqD;AAC5D,aAAIvY,IAAJ,EAAU;AACNgC,qBAAQsU,OAAOtU,KAAP,CAAR;AACAgB,sBAASqV,MAAT,GAAkBrY,OAAO,GAAP,GAAagC,KAAb,IACX0S,OAAO,WAAWA,IAAlB,GACG,EAFQ,KAGX4D,SAAS,aAAcA,kBAAkBE,IAAnB,GAA2BF,OAAOG,WAAP,EAA3B,GACnB,IAAID,IAAJ,CAAS,IAAIA,IAAJ,GAAWE,OAAX,KAAuBJ,SAAS,IAAzC,EAA+CG,WAA/C,EADM,CAAT,GAEG,EALQ,KAMXpY,SAAS,aAAaA,MAAb,IAAuB2C,SAASgO,QAAT,CAAkB3Q,MAAlD,GACG,EAPQ,KAQXkY,SAAS,SAAT,GACG,EATQ,CAAlB;AAUAF,oBAAOrY,IAAP,IAAegC,KAAf;AACA,oBAAO,IAAP;AACH;AACD,gBAAO,KAAP;AACH,MAjBD;;AAoBA9E,UAAKyb,KAAL,GAAa,UAAU3Y,IAAV,EAAgB;AACzB,gBAAO,CAAC,CAACqY,OAAOrY,IAAP,CAAT;AACH,MAFD;;AAKA9C,UAAK0b,GAAL,GAAW,UAAU5Y,IAAV,EAAgB0U,IAAhB,EAAsBrU,MAAtB,EAA8B;AACrC,aAAIwY,OAAOF,KAAP,CAAa3Y,IAAb,CAAJ,EAAwB;AACpBgD,sBAASqV,MAAT,GAAkBrY,OAAO,GAAP,IACX0U,OAAO,YAAYA,IAAnB,GAA0B,EADf,KAEXrU,SAAS,cAAcA,MAAvB,GAAgC,EAFrB,KAGXkY,SAAS,UAAT,GAAsB,EAHX,IAIZ,qCAJN;AAKA,oBAAOF,OAAOrY,IAAP,CAAP;AACA,oBAAO,IAAP;AACH;AACD,gBAAO,KAAP;AACH,MAXD;;AAcA9C,UAAK4b,MAAL,GAAc,YAAY;AACtB,cAAK,IAAIvZ,CAAT,IAAc8Y,MAAd,EAAsB;AAClB,iBAAIA,OAAO/X,cAAP,CAAsBf,CAAtB,CAAJ,EACIrC,KAAK0b,GAAL,CAASrZ,CAAT;AACP;AACJ,MALD,CAOM,CAAC,YAAY;AACX,aAAIuT,IAAI9P,SAASqV,MAAT,CAAgBtY,KAAhB,CAAsB,SAAtB,CAAR;AACA,cAAK,IAAIR,IAAI,CAAR,EAAWwZ,KAAKjG,EAAEpT,MAAvB,EAA+BH,IAAIwZ,EAAnC,EAAuCxZ,GAAvC,EAA4C;AACxC,iBAAIyZ,QAAQlG,EAAEvT,CAAF,EAAKQ,KAAL,CAAW,SAAX,CAAZ;AACAsY,oBAAOW,MAAM,CAAN,CAAP,IAAmBxH,SAASwH,MAAM,CAAN,CAAT,CAAnB;AACH;AACJ,MANC;AAOT,EAhEsB,EAAvB;;SAkESZ,c,GAAAA,c;;;;;;;;;;;;;;;;ACnET;;AAIA,KAAIa,oBAAoB,IAAI,YAAY;AACpC,SAAI/b,OAAO,IAAX;;AAEA,SAAIgc,OAAO;AACP,yBAAgB;AADT,MAAX;;AAOA,SAAIC,aAAa,SAAbA,UAAa,CAAUtI,CAAV,EAAauI,GAAb,EAAkB;AAC/B,aAAIrW,KAAKqW,IAAI,CAAJ,CAAT;AAAA,aACMxU,EADN;AAAA,aAEMyU,SAAS,EAFf;AAGA,aAAI,CAACtW,EAAD,IAAO,CAACA,GAAGyD,OAAf,EAAwB,OAAO,KAAP;AACxB,iBAAQ4S,IAAI,CAAJ,EAAO5S,OAAP,CAAeJ,WAAf,EAAR;AACI,kBAAK,OAAL;AACI,qBAAIrD,GAAGqB,IAAH,IAAWrB,GAAGqB,IAAH,IAAW,MAAtB,IAAgCrB,GAAGqB,IAAH,IAAW,UAA/C,EAA2D,OAAO,KAAP;AAC/D,kBAAK,UAAL;AACIiV,0BAAS,OAAT;AACA;AACJ,kBAAK,QAAL;AACIA,0BAAS,OAAT;AACAD,qBAAI,CAAJ,IAASrW,GAAGS,aAAZ;AACA;AACJ;AACI,wBAAO,KAAP;AAXR;;AAcA,aAAI,cAAc,OAAOtG,KAAKmc,MAAL,CAAYA,MAAZ,CAAzB,EACInc,KAAKmc,MAAL,CAAYA,MAAZ,IAAsB,IAAInc,KAAKmc,MAAL,CAAYA,MAAZ,CAAJ,CAAwBH,IAAxB,CAAtB;;AAEJ,aAAI,CAAChc,KAAKmc,MAAL,CAAYA,MAAZ,CAAD,IAAwB,CAACnc,KAAKmc,MAAL,CAAYA,MAAZ,EAAoBxI,CAApB,CAA7B,EACI,MAAM,IAAIzQ,KAAJ,CAAU,cAAcyQ,CAAd,GAAkB,gDAAlB,GAAqEwI,MAArE,GAA8E,YAAxF,CAAN;;AAEJ,gBAAOnc,KAAKmc,MAAL,CAAYA,MAAZ,EAAoBxI,CAApB,EAAuByC,KAAvB,CAA6BpW,IAA7B,EAAmCkc,GAAnC,CAAP;AACH,MA1BD;;AA4BA,SAAIE,aAAa,SAAbA,UAAa,CAAUvW,EAAV,EAAcwW,EAAd,EAAkBC,EAAlB,EAAsB;AACnC,aAAIC,OAAO5W,YAAP,IAAuB,YAAYE,GAAGyD,OAAH,CAAWJ,WAAX,EAAvC,EAAiE;AAC7D,iBAAI+K,IAAIjU,KAAKwc,kBAAL,CAAwB3W,EAAxB,CAAR;AACA,iBAAIA,GAAGS,aAAP,EAAsBT,KAAKA,GAAGS,aAAH,CAAiBR,QAAjB,CAA0B0D,IAA/B;;AAEtB,iBAAI6S,KAAKpI,EAAEwI,CAAX,EAAc5W,GAAG6W,SAAH,GAAezI,EAAEwI,CAAjB,CAAd,KACK,IAAIJ,KAAKxW,GAAG8W,YAAR,GAAuB1I,EAAEwI,CAA7B,EAAgC5W,GAAG6W,SAAH,GAAeL,EAAf,CAAhC,KACAxW,GAAG6W,SAAH,GAAezI,EAAEwI,CAAF,GAAM5W,GAAG8W,YAAH,GAAkB,CAAvC;;AAEL,iBAAIL,KAAKrI,EAAEsG,CAAX,EAAc1U,GAAG+W,UAAH,GAAgB3I,EAAEsG,CAAlB,CAAd,KACK,IAAI+B,KAAKzW,GAAGgX,WAAR,GAAsB5I,EAAEsG,CAA5B,EAA+B1U,GAAG+W,UAAH,GAAgBN,EAAhB,CAA/B,KACAzW,GAAG+W,UAAH,GAAgB3I,EAAEsG,CAAF,GAAM1U,GAAGgX,WAAH,GAAiB,CAAvC;AACR;AACJ,MAbD;;AAkBA7c,UAAK6G,QAAL,GAAgB,UAAUhB,EAAV,EAAc+B,KAAd,EAAqBgR,GAArB,EAA0BkE,OAA1B,EAAmC;AAC/C,aAAIT,KAAKxW,GAAG6W,SAAZ;AAAA,aACMJ,KAAKzW,GAAG+W,UADd;;AAGA,aAAIE,OAAJ,EAAa;AACT,iBAAIC,KAAK/c,KAAK6H,QAAL,CAAchC,EAAd,CAAT;AACA+S,mBAAMmE,KAAKnE,GAAX;AACAhR,qBAAQmV,KAAKnV,KAAb;AACH;AACD,aAAIA,QAAQ,CAAZ,EAAeA,QAAQ,CAAR;AACf,aAAIgR,MAAMhR,KAAV,EAAiBgR,MAAMhR,KAAN;;AAEjBqU,oBAAW,UAAX,EAAuB,CAACpW,EAAD,EAAK+B,KAAL,EAAYgR,GAAZ,CAAvB;;AAEAwD,oBAAWvW,EAAX,EAAewW,EAAf,EAAmBC,EAAnB;AACH,MAfD;;AAoBAtc,UAAK2F,YAAL,GAAoB,UAAUE,EAAV,EAAc;AAC9B,gBAAOoW,WAAW,cAAX,EAA2B,CAACpW,EAAD,CAA3B,CAAP;AACH,MAFD;;AAIA7F,UAAK6H,QAAL,GAAgB,UAAUhC,EAAV,EAAc;AAC1B,gBAAOoW,WAAW,QAAX,EAAqB,CAACpW,EAAD,CAArB,EAA2B,CAA3B,CAAP;AACH,MAFD;;AAIA7F,UAAKgd,MAAL,GAAc,UAAUnX,EAAV,EAAc;AACxB,gBAAOoW,WAAW,QAAX,EAAqB,CAACpW,EAAD,CAArB,EAA2B,CAA3B,CAAP;AACH,MAFD;;AAIA7F,UAAKid,iBAAL,GAAyB,UAAUpX,EAAV,EAAc;AACnC,gBAAO7F,KAAK6H,QAAL,CAAchC,EAAd,CAAP;AACH,MAFD;;AAOA7F,UAAK4G,cAAL,GAAsB,UAAUf,EAAV,EAAc8T,GAAd,EAAmBuD,IAAnB,EAAyB;AAC3C,aAAIb,KAAKxW,GAAG6W,SAAZ;AAAA,aACMJ,KAAKzW,GAAG+W,UADd;AAEA,aAAI,CAACM,IAAL,EAAW;AACPjB,wBAAW,KAAX,EAAkB,CAACpW,EAAD,CAAlB;AACH;AACD,aAAIsX,MAAMlB,WAAW,KAAX,EAAkB,CAACpW,EAAD,EAAK8T,GAAL,CAAlB,CAAV;AACAyC,oBAAWvW,EAAX,EAAewW,EAAf,EAAmBC,EAAnB;AACA,gBAAOa,GAAP;AACH,MATD;;AAWAnd,UAAKod,aAAL,GAAqB,UAAUvX,EAAV,EAAc+B,KAAd,EAAqBgR,GAArB,EAA0B;AAC3C,aAAIjO,IAAI3K,KAAKid,iBAAL,CAAuBpX,EAAvB,CAAR;AAAA,aACMc,IAAI3G,KAAKgd,MAAL,CAAYnX,EAAZ,CADV;AAEA,aAAI8E,KAAKhE,CAAT,EAAY;AACR3G,kBAAK4G,cAAL,CAAoBf,EAApB,EAAwB+B,QAAQgR,GAAhC;AACH,UAFD,MAEO;AACH5Y,kBAAK4G,cAAL,CAAoBf,EAApB,EAAwB+B,KAAxB,EAA+B,IAA/B;AACA5H,kBAAK6G,QAAL,CAAchB,EAAd,EAAkBc,IAAIiB,MAAMpF,MAA5B,EAAoCmE,IAAIiB,MAAMpF,MAA9C;AACAxC,kBAAK4G,cAAL,CAAoBf,EAApB,EAAwB+S,GAAxB,EAA6B,IAA7B;AACH;AACJ,MAVD;;AAaA5Y,UAAK4F,cAAL,GAAsB,UAAUC,EAAV,EAAcwX,KAAd,EAAqB;AACvC,aAAI,CAACrd,KAAK2F,YAAL,CAAkBE,EAAlB,CAAL,EAA4B;AACxB,iBAAIwX,KAAJ,EACIrd,KAAK6G,QAAL,CAAchB,EAAd,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,IAAxB,EADJ,KAGI7F,KAAK6G,QAAL,CAAchB,EAAd,EAAkB,CAAC,CAAnB,EAAsB,CAAtB,EAAyB,IAAzB;AACP;AACD,gBAAO7F,KAAKsd,eAAL,CAAqBzX,EAArB,CAAP;AACH,MARD;;AAUA7F,UAAKsd,eAAL,GAAuB,UAAUzX,EAAV,EAAc;AACjC,aAAIyW,KAAKzW,GAAG+W,UAAZ;AAAA,aACMP,KAAKxW,GAAG6W,SADd;AAAA,aAEMrX,MAAM4W,WAAW,KAAX,EAAkB,CAACpW,EAAD,CAAlB,CAFZ;AAGAuW,oBAAWvW,EAAX,EAAewW,EAAf,EAAmBC,EAAnB;AACA,gBAAOjX,GAAP;AACH,MAND;;AAQArF,UAAKwc,kBAAL,GAA0B,UAAU3W,EAAV,EAAc;AACpC,gBAAOoW,WAAW,oBAAX,EAAiC,CAACpW,EAAD,CAAjC,EAAuC,IAAvC,CAAP;AACH,MAFD;;AAIA7F,UAAKud,UAAL,GAAkB,UAAU1X,EAAV,EAAc;AAC5B,gBAAOoW,WAAW,YAAX,EAAyB,CAACpW,EAAD,CAAzB,CAAP;AACH,MAFD;AAGH,EAhJuB,EAAxB;AAiJAkW,mBAAkBI,MAAlB,GAA2B;;AAEvB,cAAS,eAAUH,IAAV,EAAgB;AACrB,aAAIhc,OAAO,IAAX;;AAEA,aAAIwd,mBAAmB,IAAvB;;AAEAxd,cAAKud,UAAL,GAAkB,UAAU1X,EAAV,EAAc;AAC5B,iBAAIsX,MAAMnd,KAAKyd,MAAL,CAAY5X,EAAZ,CAAV;AAAA,iBACM8T,MAAM9T,GAAGf,KADf;AAAA,iBAEM4Y,KAAK/D,IAAIvO,KAAJ,CAAU,IAAI4H,MAAJ,CAAW,uBAAuBmK,IAAI,CAAJ,IAAS,CAAhC,IAAqC,YAAhD,EAA8D,GAA9D,CAAV,KAAiF,EAF5F;AAAA,iBAGMQ,KAAKhE,IAAIvO,KAAJ,CAAU,IAAI4H,MAAJ,CAAW,oBAAoBmK,IAAI,CAAJ,CAApB,GAA6B,GAAxC,EAA6C,GAA7C,CAAV,EAA6D,CAA7D,CAHX;AAAA,iBAIMS,KAAKjE,IAAIrU,OAAJ,CAAYqY,EAAZ,EAAgB,EAAhB,CAJX;AAAA,iBAKME,KAAKD,GAAGlV,SAAH,CAAa,CAAb,EAAgByU,IAAI,CAAJ,IAASA,IAAI,CAAJ,CAAzB,CALX;AAAA,iBAMMW,KAAMF,GAAGtY,OAAH,CAAWuY,EAAX,EAAe,EAAf,CAAD,CAAqBzS,KAArB,CAA2B,WAA3B,CANX;AAOA,oBAAO,CAACuS,GAAGrY,OAAH,CAAWoY,EAAX,EAAe,EAAf,CAAD,EAAqBG,EAArB,EAAyBC,EAAzB,CAAP;AACH,UATD;;AAWA9d,cAAKyd,MAAL,GAAc,UAAU5X,EAAV,EAAc;AACxB,iBAAIsX,MAAM,CAAC,CAAD,EAAI,CAAJ,CAAV;AACA,iBAAI,cAAc,OAAOZ,OAAO5W,YAAhC,EAA8C;AAC1C,qBAAI;AACAwX,2BAAM,CAACtX,GAAGkY,cAAJ,EAAoBlY,GAAGmY,YAAvB,CAAN;AACH,kBAFD,CAEE,OAAOrX,CAAP,EAAU,CACX;AACJ,cALD,MAKO;AACHd,oBAAGoY,SAAH;AACAd,uBAAM,CAACjF,KAAKe,GAAL,CAASpT,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,GAAoCC,SAApC,CAA8C,WAA9C,EAA2D,CAAC,SAA5D,CAAT,CAAD,EACAlG,KAAKe,GAAL,CAASpT,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,GAAoCE,OAApC,CAA4C,WAA5C,EAAyD,CAAC,SAA1D,CAAT,CADA,CAAN;;AAGA,qBAAIxY,GAAGyD,OAAH,CAAWJ,WAAX,MAA4B,OAAhC,EAAyC;;AAErC,yBAAI8O,IAAInS,GAAGC,QAAH,CAAY0D,IAAZ,CAAiB8U,eAAjB,EAAR;AACAtG,uBAAEuG,iBAAF,CAAoB1Y,EAApB;AACA,yBAAI2Y,QAAQtG,KAAKe,GAAL,CAASjB,EAAEoG,SAAF,CAAY,WAAZ,EAAyB,CAAC,SAA1B,CAAT,CAAZ;AACAjB,yBAAI,CAAJ,KAAUqB,KAAV;AACArB,yBAAI,CAAJ,KAAUqB,KAAV;AACH;AACJ;AACD,oBAAOrB,GAAP;AACH,UAtBD;;AAwBAnd,cAAK0b,GAAL,GAAW,UAAU7V,EAAV,EAAc;AACrB,iBAAIR,MAAM,EAAV;AAAA,iBACMuQ,IAAI5V,KAAKyd,MAAL,CAAY5X,EAAZ,CADV;AAAA,iBAEM8E,IAAIiL,EAAE,CAAF,CAFV;AAAA,iBAGMjP,IAAIiP,EAAE,CAAF,CAHV;AAIA,iBAAIjL,KAAKhE,CAAT,EAAY;;AAER,qBAAIiR,MAAM9R,SAASoY,SAAT,IAAsB,CAAC3B,OAAOkC,KAA9B,GAAsC5Y,GAAGf,KAAH,CAASQ,OAAT,CAAiB,KAAjB,EAAwB,EAAxB,CAAtC,GAAoEO,GAAGf,KAAjF;AACAO,uBAAMuS,IAAIlP,SAAJ,CAAciC,CAAd,EAAiBhE,CAAjB,CAAN;AACAd,oBAAGf,KAAH,GAAW8S,IAAIlP,SAAJ,CAAc,CAAd,EAAiBiC,CAAjB,IAAsBiN,IAAIlP,SAAJ,CAAc/B,CAAd,EAAiBiR,IAAIpV,MAArB,CAAjC;AACAxC,sBAAK6G,QAAL,CAAchB,EAAd,EAAkB8E,CAAlB,EAAqBA,CAArB;AACH;AACD,oBAAOtF,GAAP;AACH,UAbD;;AAeArF,cAAKya,GAAL,GAAW,UAAU5U,EAAV,EAAc8T,GAAd,EAAmB;AAC1B,iBAAItU,MAAM,EAAV;AAAA,iBACMsF,IAAI3K,KAAKyd,MAAL,CAAY5X,EAAZ,EAAgB,CAAhB,CADV;;AAGA,iBAAI+R,MAAM9R,SAASoY,SAAT,IAAsB,CAAC3B,OAAOkC,KAA9B,GAAsC5Y,GAAGf,KAAH,CAASQ,OAAT,CAAiB,KAAjB,EAAwB,EAAxB,CAAtC,GAAoEO,GAAGf,KAAjF;AACAe,gBAAGf,KAAH,GAAW8S,IAAIlP,SAAJ,CAAc,CAAd,EAAiBiC,CAAjB,IAAsBgP,GAAtB,GAA4B/B,IAAIlP,SAAJ,CAAciC,CAAd,EAAiBiN,IAAIpV,MAArB,CAAvC;AACAmI,kBAAKgP,IAAInX,MAAT;AACAxC,kBAAK6G,QAAL,CAAchB,EAAd,EAAkB8E,CAAlB,EAAqBA,CAArB;AACA,oBAAOA,CAAP;AACH,UATD;;AAWA3K,cAAK2F,YAAL,GAAoB,UAAUE,EAAV,EAAc;AAC9B,iBAAI+P,IAAI5V,KAAKyd,MAAL,CAAY5X,EAAZ,CAAR;AAAA,iBACM8E,IAAIiL,EAAE,CAAF,CADV;AAAA,iBAEMjP,IAAIiP,EAAE,CAAF,CAFV;;AAIA,iBAAIjP,IAAIgE,CAAR,EAAWhE,IAAIgE,CAAJ;;AAEX,iBAAIiN,MAAM9R,SAASoY,SAAT,IAAsB,CAAC3B,OAAOkC,KAA9B,GAAsC5Y,GAAGf,KAAH,CAASQ,OAAT,CAAiB,KAAjB,EAAwB,EAAxB,CAAtC,GAAoEO,GAAGf,KAAjF;AACA,oBAAO8S,IAAIlP,SAAJ,CAAciC,CAAd,EAAiBhE,CAAjB,CAAP;AACH,UATD;;AAWA3G,cAAK6G,QAAL,GAAgB,UAAUhB,EAAV,EAAc+B,KAAd,EAAqBgR,GAArB,EAA0B;AACtC,iBAAI,cAAc,OAAO/S,GAAG6Y,iBAA5B,EAA+C;;AAE3C,qBAAI;AAAE7Y,wBAAG6Y,iBAAH,CAAqB9W,KAArB,EAA4BgR,GAA5B;AAAkC,kBAAxC,CAAyC,OAAOjS,CAAP,EAAU,CAAG;AACzD,cAHD,MAGO;;AAEH,qBAAIgS,KAAJ;;AAEA,qBAAI;AACAA,6BAAQ9S,GAAGyY,eAAH,EAAR;AACH,kBAFD,CAEE,OAAO3X,CAAP,EAAU;AACR,yBAAI;AACAgS,iCAAQ9S,GAAGC,QAAH,CAAY0D,IAAZ,CAAiB8U,eAAjB,EAAR;AACA3F,+BAAM4F,iBAAN,CAAwB1Y,EAAxB;AACH,sBAHD,CAGE,OAAOc,CAAP,EAAU;AACR,gCAAO,KAAP;AACH;AACJ;AACDd,oBAAGoY,SAAH;AACAtF,uBAAMgG,QAAN,CAAe,IAAf;AACAhG,uBAAMyF,SAAN,CAAgB,WAAhB,EAA6BxW,KAA7B;AACA+Q,uBAAM0F,OAAN,CAAc,WAAd,EAA2BzF,MAAMhR,KAAjC;AACA+Q,uBAAMiG,MAAN;AACH;AACJ,UAxBD;;AA0BA5e,cAAKwc,kBAAL,GAA0B,UAAU3W,EAAV,EAAc;AACpC,iBAAI8S,KAAJ;AAAA,iBACMkG,MAAM,SAAIC,SAAJ,CAAcjZ,EAAd,EAAkBC,QAD9B;AAEA,iBAAI,cAAc,OAAOD,GAAG6Y,iBAA5B,EAA+C;;AAE3C,qBAAI,CAAClB,gBAAL,EAAuB;;AAEnBA,wCAAmBqB,IAAI3T,aAAJ,CAAkB,IAAlB,CAAnB;;AAEA2T,yBAAIrV,IAAJ,CAASY,WAAT,CAAqBoT,gBAArB;AACH;;AAED,qBAAIA,iBAAiBxB,KAAK+C,YAAtB,KAAuClZ,EAA3C,EAA+C;AAC3C2X,sCAAiBxB,KAAK+C,YAAtB,IAAsClZ,EAAtC;AACA,yBAAIoG,KAAK4S,IAAIG,WAAJ,CAAgBC,gBAAhB,CAAiCpZ,EAAjC,EAAqC,IAArC,CAAT;AACA,0BAAK,IAAIxD,CAAT,IAAc4J,EAAd,EAAkB;AACd,6BAAI;AAAE,iCAAIA,GAAG5J,CAAH,CAAJ,EAAWmb,iBAAiB9O,KAAjB,CAAuBrM,CAAvB,IAA4B4J,GAAG5J,CAAH,CAA5B;AAAoC,0BAArD,CAAsD,OAAOsE,CAAP,EAAU,CAAG;AACtE;AACD6W,sCAAiB9O,KAAjB,CAAuBwQ,QAAvB,GAAkC,MAAlC;AACA1B,sCAAiB9O,KAAjB,CAAuBC,QAAvB,GAAkC,UAAlC;AACA6O,sCAAiB9O,KAAjB,CAAuByQ,UAAvB,GAAoC,QAApC;AACA3B,sCAAiB9O,KAAjB,CAAuB0Q,MAAvB,GAAgC,KAAhC;AACA5B,sCAAiB9O,KAAjB,CAAuBE,IAAvB,GAA8B,UAA9B;AACA4O,sCAAiB9O,KAAjB,CAAuB2Q,GAAvB,GAA6B,UAA7B;AACA7B,sCAAiB9O,KAAjB,CAAuB4Q,eAAvB,GAAyC,QAAzC;AACH;;AAED,qBAAI3G,QAAQkG,IAAIV,WAAJ,EAAZ;AAAA,qBACMxE,MAAM9T,GAAGf,KAAH,IAAY,GADxB;;AAGA,qBAAI,WAAWe,GAAGyD,OAAH,CAAWJ,WAAX,EAAf,EAAyC;AACrCsU,sCAAiB9O,KAAjB,CAAuB6Q,KAAvB,GAA+B,MAA/B;AACA/B,sCAAiB9O,KAAjB,CAAuB8Q,UAAvB,GAAoC,QAApC;AACH,kBAHD,MAGO;AACHhC,sCAAiB9O,KAAjB,CAAuB8Q,UAAvB,GAAoC,SAAS3Z,GAAG4Z,YAAH,CAAgB,MAAhB,CAAT,GAAmC,KAAnC,GAA2C,EAA/E;AACH;;AAED9F,uBAAMA,IAAIrU,OAAJ,CAAY,WAAZ,EAAyB,UAAzB,EAAqCA,OAArC,CAA6C,IAA7C,EAAmD,MAAnD,EAA2DA,OAA3D,CAAmE,IAAnE,EAAyE,KAAzE,CAAN;AACAkY,kCAAiBzZ,SAAjB,GAA6B,CAAC4V,IAAIjR,SAAJ,CAAc,CAAd,EAAiB7C,GAAGkY,cAAH,GAAoB,CAArC,IAA0C,QAA1C,GAAqDpE,IAAIjR,SAAJ,CAAc7C,GAAGkY,cAAH,GAAoB,CAAlC,EAAqClY,GAAGkY,cAAxC,CAArD,GAA+G,SAA/G,GACxBpE,IAAIjR,SAAJ,CAAc7C,GAAGkY,cAAjB,CADuB,EACWzY,OADX,CACmB,KADnB,EAC0B,QAD1B,EAExBA,OAFwB,CAEhB,KAFgB,EAET,uCAFS,CAA7B;;AAIA,qBAAIwP,OAAO0I,iBAAiB/J,oBAAjB,CAAsC,MAAtC,EAA8C,CAA9C,CAAX;AACAqB,sBAAKpG,KAAL,CAAWgR,MAAX,GAAoB,eAApB;AACA/G,uBAAMgH,UAAN,GAAmB7K,KAAK6K,UAAxB,CAzC2C,CAyCT;AAClChH,uBAAMiH,SAAN,GAAkB9K,KAAK8K,SAAvB,CA1C2C,CA0CX;AAChCjH,uBAAMkH,YAAN,GAAqB/K,KAAK+K,YAA1B;AACA,qBAAI,QAAQlG,IAAInL,MAAJ,CAAW3I,GAAGkY,cAAH,GAAoB,CAA/B,CAAZ,EAA+CpF,MAAMiH,SAAN,IAAmBjH,MAAMkH,YAAN,GAAqB,CAAxC;AAC/C/K,wBAAO,IAAP;AACH,cA9CD,MA8CO,IAAI+J,IAAIX,SAAJ,IAAiBW,IAAIX,SAAJ,CAAcC,WAAnC,EAAgD;;AAEnDxF,yBAAQkG,IAAIX,SAAJ,CAAcC,WAAd,EAAR;;AAEAxF,uBAAMkH,YAAN,GAAqB3H,KAAK2C,KAAL,CAAWlC,MAAMmH,cAAN,IAAwBnH,MAAMU,IAAN,CAAW/T,OAAX,CAAmB,QAAnB,EAA6B,EAA7B,EAAiC9C,MAAjC,GAA0C,CAAlE,CAAX,CAArB;AACA,qBAAIqD,GAAGyD,OAAH,IAAc,cAAczD,GAAGyD,OAAH,CAAWJ,WAAX,EAAhC,EAA0D;AACtD,yBAAI6W,KAAK,SAAIC,SAAJ,CAAcna,EAAd,CAAT;AACA8S,6BAAQ;AACJ,sCAAaA,MAAMiH,SAAN,GAAkBG,GAAGtD,CAArB,GAAyB,SAAIwD,gBAAJ,CAAqBpa,EAArB,CADlC;AAEF,uCAAc8S,MAAMgH,UAAN,GAAmBI,GAAGxF,CAAtB,GAA0B,SAAI2F,iBAAJ,CAAsBra,EAAtB,CAFtC;AAGF,yCAAgB8S,MAAMkH;AAHpB,sBAAR;AAKH;AACJ;AACD,iBAAIlH,KAAJ,EAAW;AACP,wBAAO,EAAE,KAAKA,MAAMgH,UAAb,EAAyB,KAAKhH,MAAMiH,SAApC,EAA+C,KAAKjH,MAAMkH,YAA1D,EAAP;AACH;AACD,oBAAO,EAAE,KAAK,CAAP,EAAU,KAAK,CAAf,EAAkB,KAAK,CAAvB,EAAP;AACH,UAnED;AAoEH,MA7KsB;AA8KrB,cAAS,iBAAY;AACnB,aAAI7f,OAAO,IAAX;;AAEAA,cAAKud,UAAL,GAAkB,UAAU1X,EAAV,EAAc;AAC5B,iBAAI,cAAc,OAAOA,GAAGF,YAA5B,EAA0C;AACtC,qBAAIwX,MAAMnd,KAAKyd,MAAL,CAAY5X,EAAZ,CAAV;AAAA,qBACM8T,MAAM9T,GAAGC,QAAH,CAAY0D,IAAZ,CAAiB4L,SAAjB,IAA8BvP,GAAGC,QAAH,CAAY0D,IAAZ,CAAiBzF,SAAjB,CAA2BuB,OAA3B,CAAmC,qBAAnC,EAA0D,EAA1D,EAA8DA,OAA9D,CAAsE,QAAtE,EAAgF,GAAhF,CAD1C;AAAA,qBAEMoY,KAAK/D,IAAIvO,KAAJ,CAAU,IAAI4H,MAAJ,CAAW,uBAAuBmK,IAAI,CAAJ,IAAS,CAAhC,IAAqC,YAAhD,EAA8D,GAA9D,CAAV,KAAiF,EAF5F;AAAA,qBAGMQ,KAAKhE,IAAIvO,KAAJ,CAAU,IAAI4H,MAAJ,CAAW,oBAAoBmK,IAAI,CAAJ,CAApB,GAA6B,GAAxC,EAA6C,GAA7C,CAAV,KAAgE,EAH3E;AAAA,qBAIMS,KAAKjE,IAAIrU,OAAJ,CAAYqY,EAAZ,EAAgB,EAAhB,CAJX;AAAA,qBAKME,KAAKD,GAAGlV,SAAH,CAAa,CAAb,EAAgByU,IAAI,CAAJ,IAASA,IAAI,CAAJ,CAAzB,CALX;AAAA,qBAMMW,KAAMF,GAAGtY,OAAH,CAAWuY,EAAX,EAAe,EAAf,CAAD,CAAqBzS,KAArB,CAA2B,WAA3B,CANX;AAOA,wBAAO,CAACuS,GAAGta,QAAH,GAAciC,OAAd,CAAsBoY,EAAtB,EAA0B,EAA1B,CAAD,EAAgCG,EAAhC,EAAoCC,EAApC,CAAP;AACH,cATD,MASO;AACH,qBAAIlQ,KAAK/H,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,EAAT;AAAA,qBACMtQ,KAAKhI,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,EADX;AAAA,qBAEMgC,KAAKta,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,EAFX;AAGAvQ,oBAAGwQ,SAAH,CAAa,MAAb,EAAqB,CAAC,CAAtB;AACA+B,oBAAG9B,OAAH,CAAW,MAAX,EAAmB,CAAnB;;AAEA,wBAAO,CAACzQ,GAAGyL,IAAH,CAAQ/T,OAAR,CAAgB,IAAI0N,MAAJ,CAAWA,OAAOoG,MAAP,CAAcvL,GAAGwL,IAAjB,IAAyB,GAApC,CAAhB,EAA0D,EAA1D,CAAD,EACDxL,GAAGwL,IADF,EAED8G,GAAG9G,IAAH,CAAQ/T,OAAR,CAAgB,IAAI0N,MAAJ,CAAW,MAAMA,OAAOoG,MAAP,CAAcvL,GAAGwL,IAAjB,CAAjB,CAAhB,EAA0D,EAA1D,CAFC,CAAP;AAGH;AACJ,UArBD;;AAuBArZ,cAAKyd,MAAL,GAAc,UAAU5X,EAAV,EAAc;AACxB,iBAAIsX,MAAM,CAAC,CAAD,EAAI,CAAJ,CAAV;AACA,iBAAI,cAAc,OAAOtX,GAAGF,YAA5B,EAA0C;;AAEtC,qBAAIya,MAAMva,GAAGF,YAAH,EAAV;AAAA,qBACMwR,KAAKiJ,IAAIC,UADf;AAAA,qBAEMC,KAAKF,IAAIG,YAFf;AAAA,qBAGMC,KAAKJ,IAAIK,SAHf;AAAA,qBAIMC,KAAKN,IAAIO,WAJf;AAAA,qBAKMC,KAAK,KALX;AAAA,qBAMMC,KAAK,KANX;AAAA,qBAOMC,KAAK,CAPX;AAAA,qBAQMC,KAAK,CARX;AAAA,qBASMC,EATN;AAAA,qBAUMC,KAAKpb,GAAGC,QAAH,CAAYob,gBAAZ,CAA6Brb,GAAGC,QAAH,CAAY0D,IAAzC,EAA+C2X,WAAWC,SAA1D,EAAqE,IAArE,EAA2E,KAA3E,CAVX;AAWA,wBAAOjK,MAAMA,GAAGhN,QAAH,IAAe,CAA5B,EAA+B;AAC3BgN,0BAAKA,GAAG9P,UAAH,CAAciZ,EAAd,CAAL;AACAA,0BAAK,CAAL;AACH;AACD,wBAAOE,MAAMA,GAAGrW,QAAH,IAAe,CAA5B,EAA+B;AAC3BqW,0BAAKA,GAAGnZ,UAAH,CAAcqZ,EAAd,CAAL;AACAA,0BAAK,CAAL;AACH;AACD,wBAAOM,KAAKC,GAAGI,QAAH,EAAZ,EAA2B;AACvB,yBAAIL,MAAMR,EAAV,EAAc;AACVO,+BAAML,EAAN;AACAG,8BAAK,IAAL;AACH;AACD,yBAAIG,MAAM7J,EAAV,EAAc;AACV2J,+BAAMR,EAAN;AACAM,8BAAK,IAAL;AACH;AACD,yBAAI,CAACC,EAAL,EAASE,MAAMC,GAAG1L,SAAH,CAAa9S,MAAnB;AACT,yBAAI,CAACoe,EAAL,EAASE,MAAME,GAAG1L,SAAH,CAAa9S,MAAnB;AACT,yBAAIqe,MAAMD,EAAV,EAAc;AACjB;AACDzD,uBAAM,CAACjF,KAAKa,GAAL,CAASgI,EAAT,EAAaD,EAAb,CAAD,EAAmB5I,KAAKC,GAAL,CAAS4I,EAAT,EAAaD,EAAb,CAAnB,CAAN;AACH,cAnCD,MAmCO;AACHjb,oBAAGC,QAAH,CAAY0D,IAAZ,CAAiByU,SAAjB;AACAd,uBAAM,CAACjF,KAAKe,GAAL,CAASpT,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,GAAoCC,SAApC,CAA8C,WAA9C,EAA2D,CAAC,SAA5D,CAAT,CAAD,EACAlG,KAAKe,GAAL,CAASpT,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,GAAoCE,OAApC,CAA4C,WAA5C,EAAyD,CAAC,SAA1D,CAAT,CADA,CAAN;AAEH;AACD,oBAAOlB,GAAP;AACH,UA3CD;;AA6CAnd,cAAK0b,GAAL,GAAW,UAAU7V,EAAV,EAAc;AACrB,iBAAI,cAAc,OAAOA,GAAGF,YAA5B,EAA0C;AACtC,qBAAIgF,IAAI9E,GAAGF,YAAH,EAAR;AAAA,qBACMtD,IAAIsI,EAAE2W,UADZ;AAEA,wBAAO,EAAEjf,CAAF,GAAM,CAAC,CAAd;AAAiBsI,uBAAE4W,UAAF,CAAalf,CAAb,EAAgBmf,cAAhB;AAAjB,kBAGA,IAAIxJ,IAAIrN,EAAE4W,UAAF,CAAa5W,EAAE2W,UAAF,GAAe,CAA5B,CAAR;AACAtJ,mBAAEyJ,UAAF,CAAa5b,GAAGC,QAAH,CAAYqF,cAAZ,CAA2B,EAA3B,CAAb;AACAR,mBAAE+W,QAAF,CAAW1J,CAAX;AACH,cATD,MASO,IAAInS,GAAGC,QAAH,IAAeD,GAAGC,QAAH,CAAYoY,SAA/B,EAA0C;AAC7CrY,oBAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,GAAoC9E,IAApC,GAA2C,EAA3C;AACAxT,oBAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,GAAoCS,MAApC;AACH;AACJ,UAdD;;AAgBA5e,cAAKya,GAAL,GAAW,UAAU5U,EAAV,EAAc8T,GAAd,EAAmB;AAC1B,iBAAI,cAAc,OAAO9T,GAAGF,YAA5B,EAA0C;AACtCgU,uBAAMA,IAAIrU,OAAJ,CAAY,GAAZ,EAAiB,OAAjB,EAA0BA,OAA1B,CAAkC,GAAlC,EAAuC,MAAvC,EAA+CA,OAA/C,CAAuD,GAAvD,EAA4D,MAA5D,EAAoEA,OAApE,CAA4E,MAA5E,EAAoF,QAApF,EAA8FA,OAA9F,CAAsG,QAAtG,EAAgH,QAAhH,CAAN;AACA,qBAAIuF,IAAIhF,GAAGC,QAAH,CAAYoF,aAAZ,CAA0B,MAA1B,CAAR;AAAA,qBACMP,IAAI9E,GAAGF,YAAH,EADV;AAAA,qBAEMqS,IAAIrN,EAAE4W,UAAF,CAAa,CAAb,CAFV;AAAA,qBAGMI,EAHN;AAIA9W,mBAAE9G,SAAF,GAAc4V,GAAd;AACA3B,mBAAEyJ,UAAF,CAAa5W,CAAb;AACAmN,mBAAE4J,kBAAF,CAAqB/W,CAArB;;AAEA,qBAAIgX,KAAKhX,EAAErC,UAAX;AAAA,qBACMmZ,KAAK9W,EAAEoF,WADb;;AAIApF,mBAAErC,UAAF,CAAasZ,YAAb,CAA0B9J,EAAE+J,eAAF,EAA1B,EAA+ClX,CAA/C;;AAGA,qBAAI,CAAC8W,EAAL,EACIA,KAAKE,GAAGtR,SAAR;;AAEJ,qBAAImN,KAAK7X,GAAGC,QAAH,CAAYqY,WAAZ,EAAT;;AAEA,qBAAIwD,GAAGrM,SAAP,EAAkB;;AAEdoI,wBAAGsE,QAAH,CAAYL,EAAZ,EAAgB,CAAhB;AACH,kBAHD,MAGO;;AAEHjE,wBAAGuE,aAAH,CAAiBN,EAAjB;AACH;;AAGDhX,mBAAEuX,eAAF;AACAvX,mBAAE+W,QAAF,CAAWhE,EAAX;AAEH,cAlCD,MAkCO,IAAI7X,GAAGC,QAAH,IAAeD,GAAGC,QAAH,CAAYoY,SAA/B,EAA0C;AAC7CrY,oBAAGC,QAAH,CAAY0D,IAAZ,CAAiByU,SAAjB;AACA,qBAAIjG,IAAInS,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,EAAR;AACAnG,mBAAEqB,IAAF,GAASM,GAAT;;AAEA,qBAAI3B,EAAEoG,SAAF,CAAY,WAAZ,EAAyB,CAAzB,CAAJ,EAAiC;AAC7BpG,uBAAEoG,SAAF,CAAY,WAAZ,EAAyB,CAAC,CAA1B;AACApG,uBAAEqG,OAAF,CAAU,WAAV,EAAuB,CAAC,CAAxB;AACArG,uBAAE4G,MAAF;AACH;AACJ;AACD,oBAAO5e,KAAKyd,MAAL,CAAY5X,EAAZ,EAAgB,CAAhB,CAAP;AACH,UA/CD;;AAiDA7F,cAAK2F,YAAL,GAAoB,UAAUE,EAAV,EAAc8E,CAAd,EAAiBhE,CAAjB,EAAoB;AACpC,iBAAI,cAAc,OAAOd,GAAGF,YAA5B,EAA0C;AACtC,qBAAIgF,IAAI9E,GAAGF,YAAH,EAAR;AACA,wBAAOgF,IAAIA,EAAEtH,QAAF,EAAJ,GAAmB,EAA1B;AACH,cAHD,MAGO,IAAIwC,GAAGC,QAAH,IAAeD,GAAGC,QAAH,CAAYoY,SAA/B,EAA0C;AAC7C,wBAAOrY,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,GAAoC9E,IAA3C;AACH;AACJ,UAPD;;AASArZ,cAAK6G,QAAL,GAAgB,UAAUhB,EAAV,EAAc+B,KAAd,EAAqBgR,GAArB,EAA0B;AACtC,iBAAI,cAAc,OAAO/S,GAAGF,YAA5B,EAA0C;AACtC,qBAAIya,MAAMva,GAAGF,YAAH,EAAV;AACAya,qBAAI8B,eAAJ;AACA,qBAAIlK,IAAInS,GAAGC,QAAH,CAAYqY,WAAZ,EAAR;AAAA,qBACM9F,MAAM,CADZ;AAAA,qBAEM8J,KAAK,CAFX;AAAA,qBAGMnB,EAHN;AAAA,qBAIMa,EAJN;AAAA,qBAKMZ,KAAKpb,GAAGC,QAAH,CAAYob,gBAAZ,CAA6Brb,GAAGC,QAAH,CAAY0D,IAAzC,EAA+C2X,WAAWC,SAA1D,EAAqE,IAArE,EAA2E,KAA3E,CALX;;AAQA,wBAAO,CAACJ,KAAKC,GAAGI,QAAH,EAAN,MAAyB,CAACL,GAAG1L,SAAH,CAAa9S,MAAd,IAAyB6V,MAAM2I,GAAG1L,SAAH,CAAa9S,MAAnB,IAA6BoF,KAA/E,CAAP,EAA+F;AAC3Fia,0BAAKb,EAAL;AACA3I,4BAAO2I,GAAG1L,SAAH,CAAa9S,MAApB;AACH;;AAED,qBAAIwe,OAAOA,KAAKa,EAAZ,CAAJ,EAAqB;AACjB7J,uBAAEgK,QAAF,CAAWhB,EAAX,EAAepZ,QAAQyQ,GAAvB;AACAL,uBAAEoK,MAAF,CAASpB,EAAT,EAAapZ,QAAQyQ,GAArB;AACH;AACD,qBAAI2I,EAAJ,EAAQ;AACJ,wBAAG;AACC,6BAAIA,GAAG7W,QAAH,IAAe,CAAnB,EAAsB;AACtB,6BAAIkO,MAAM2I,GAAG1L,SAAH,CAAa9S,MAAnB,GAA4BoW,GAAhC,EAAqC;AACjCP,oCAAO2I,GAAG1L,SAAH,CAAa9S,MAApB;AACH,0BAFD,MAEO;AACHwV,+BAAEoK,MAAF,CAASpB,EAAT,EAAapI,MAAMP,GAAnB;AACA;AACH;AACJ,sBARD,QAQS2I,KAAKC,GAAGI,QAAH,EARd;AASH;AACDjB,qBAAIsB,QAAJ,CAAa1J,CAAb;AACH,cAhCD,MAgCO,IAAInS,GAAGC,QAAH,IAAeD,GAAGC,QAAH,CAAYoY,SAA/B,EAA0C;AAC7CrY,oBAAGC,QAAH,CAAY0D,IAAZ,CAAiByU,SAAjB;AACA,qBAAIjG,IAAInS,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,EAAR;AACAnG,mBAAEuG,iBAAF,CAAoB1Y,GAAGC,QAAH,CAAY0D,IAAhC;AACAwO,mBAAEqK,IAAF,CAAO,WAAP,EAAoBza,KAApB;AACAoQ,mBAAEqG,OAAF,CAAU,WAAV,EAAuBzF,MAAMhR,KAA7B;AACAoQ,mBAAE4G,MAAF;AACH;AACJ,UAzCD;;AA2CA5e,cAAKwc,kBAAL,GAA0B,UAAU3W,EAAV,EAAc;AACpC,iBAAIyc,MAAM,EAAE,KAAK,CAAP,EAAU,KAAK,CAAf,EAAkB,KAAK,CAAvB,EAAV;AACA,iBAAI,cAAc,OAAOzc,GAAGF,YAA5B,EAA0C;AACtC,qBAAIqS,IAAInS,GAAGF,YAAH,GAAkB4b,UAAlB,CAA6B,CAA7B,CAAR;AAAA,qBACM5W,IAAI9E,GAAGC,QAAH,CAAYoF,aAAZ,CAA0B,MAA1B,CADV;AAAA,qBAEMqX,WAAWvK,EAAEwK,aAAF,EAFjB;AAAA,qBAGM7b,IAAIqR,EAAEyK,SAHZ;AAAA,qBAIM5X,IAAIF,CAJV;;AAMAA,mBAAE+D,KAAF,CAAQgU,UAAR,GAAqB,eAArB;AACA1K,mBAAE2K,gBAAF,CAAmBhY,CAAnB;AACA2X,qBAAI9O,CAAJ,GAAQ3I,EAAEgV,YAAV;AACA,wBAAOhV,EAAE+X,YAAT,EAAuB;AACnBN,yBAAI/H,CAAJ,IAAS1P,EAAE8U,UAAX;AACA2C,yBAAI7F,CAAJ,IAAS5R,EAAE+U,SAAX;AACA/U,yBAAIA,EAAE+X,YAAN;AACH;AACDjY,mBAAEnC,UAAF,CAAa8B,WAAb,CAAyBK,CAAzB;;AAEA,qBAAI+S,KAAK7X,GAAGC,QAAH,CAAYqY,WAAZ,EAAT;AACA,qBAAIoE,SAASlb,UAAT,CAAoB7E,MAApB,GAA6B,CAAjC,EAAoC;AAChC,0BAAK,IAAIH,IAAI,CAAb,EAAgBA,IAAIkgB,SAASlb,UAAT,CAAoB7E,MAAxC,EAAgDH,GAAhD,EAAqD;AACjD,6BAAIwI,IAAI0X,SAASlb,UAAT,CAAoBhF,CAApB,CAAR;AACA2V,2BAAEyJ,UAAF,CAAa5W,CAAb;AACA6S,4BAAGmF,UAAH,CAAchY,CAAd;AACH;AACDhF,wBAAGF,YAAH,GAAkB+b,QAAlB,CAA2BhE,EAA3B;AACH;AACJ,cA1BD,MA0BO,IAAI7X,GAAGC,QAAH,IAAeD,GAAGC,QAAH,CAAYoY,SAA/B,EAA0C;AAC7C,qBAAIlG,IAAInS,GAAGC,QAAH,CAAYoY,SAAZ,CAAsBC,WAAtB,EAAR;AACAmE,qBAAI9O,CAAJ,GAAQwE,EAAE8H,cAAV;AACAwC,qBAAI/H,CAAJ,GAAQvC,EAAE2H,UAAV;AACA2C,qBAAI7F,CAAJ,GAAQzE,EAAE4H,SAAV;AACH;AACD,oBAAO0C,GAAP;AACH,UAnCD;AAoCH;AA9YsB,EAA3B;;SAiZSvG,iB,GAAAA,iB;;;;;;;;;;;;;;;;ACtiBT;;AAKA,KAAMpH,MAAM,EAAZ;;AAEAA,KAAIrM,SAAJ,GAAgB,SAASA,SAAT,CAAmBzC,EAAnB,EAAwBid,EAAxB,EAA6BC,EAA7B,EAAmC;AACjD,SAAIld,MAAM,IAAV,EAAgB,OAAO,IAAP,CAAhB,KACK,IAAIA,GAAGsE,QAAH,IAAe,CAAf,KACH,CAAC,0BAAY4Y,EAAZ,CAAD,IAAoBld,GAAGid,EAAH,KAAUC,EAA/B,IACC,YAAY,OAAOD,EAAnB,IAAyBnO,IAAIC,UAAJ,CAAe/O,EAAf,EAAmBid,EAAnB,CAD1B,IAEAjd,MAAMid,EAHF,CAAJ,EAGW,OAAOjd,EAAP,CAHX,KAIA,OAAOyC,UAAUzC,GAAG2C,UAAb,EAAyBsa,EAAzB,EAA6BC,EAA7B,CAAP;AACN,EAPD;;AASApO,KAAIqL,SAAJ,GAAgB,UAAUna,EAAV,EAAgB;AAC5B,SAAImd,mBAAmB,IAAvB;AAAA,SACIpY,IAAI/E,EADR;AAAA,SAEI+I,OAAO,CAFX;AAAA,SAGIyQ,MAAM,CAHV;AAAA,SAIIE,QAAQ,CAJZ;AAAA,SAKI0D,SAAS,CALb;AAAA,SAMIza,aAAa,IANjB;AAAA,SAOIoa,eAAe,IAPnB;;AASA,SAAIhY,KAAG,IAAP,EAAa,OAAO,IAAP;;AAEbgY,oBAAehY,EAAEgY,YAAjB;AACA,SAAIM,iBAAiBtY,CAArB;AAAA,SACI/E,KAAK+E,CADT;AAEA,YAAO/E,GAAG2C,UAAH,IAAe,IAAtB,EAA4B;AAC1B3C,cAAKA,GAAG2C,UAAR;AACA,aAAI3C,GAAG+c,YAAH,KAAkB,IAAtB,EAA4B;AAC1B,iBAAIO,iBAAiB,IAArB;;AAEA,iBAAIH,oBAAoBzG,OAAOkC,KAA/B,EAAsC;AACpC,qBAAI5Y,MAAIqd,eAAe1a,UAAnB,IAAiC3C,GAAGud,QAAH,IAAa,IAAlD,EAAwD;AACtDD,sCAAiB,KAAjB;AACD;AACF;AACD,iBAAIA,cAAJ,EAAoB;AAClB,qBAAItd,GAAG6W,SAAH,IAAgB7W,GAAG6W,SAAH,GAAa,CAAjC,EAAoC;AAClC2C,4BAAOxZ,GAAG6W,SAAV;AACD;AACD,qBAAI7W,GAAG+W,UAAH,IAAiB/W,GAAG+W,UAAH,GAAc,CAAnC,EAAsC;AACpChO,6BAAQ/I,GAAG+W,UAAX;AACD;AACF;AACF;;AAED,aAAI/W,MAAM+c,YAAV,EAAwB;AACtBhU,qBAAQhE,EAAE+U,UAAV;AACA,iBAAI9Z,GAAGwd,UAAH,IAAiBxd,GAAGud,QAAH,IAAa,OAAlC,EAA2C;AACzCxU,yBAAQ/I,GAAGwd,UAAX;AACD;AACDhE,oBAAOzU,EAAEgV,SAAT;AACA,iBAAI/Z,GAAGyd,SAAH,IAAgBzd,GAAGud,QAAH,IAAa,OAAjC,EAA0C;AACxC/D,wBAAOxZ,GAAGyd,SAAV;AACD;AACD1Y,iBAAI/E,EAAJ;AACA,iBAAI+E,EAAEgY,YAAF,IAAgB,IAApB,EAA0B;AACxB,qBAAIhY,EAAE+U,UAAN,EAAkB;AAChB/Q,6BAAQhE,EAAE+U,UAAV;AACD;AACD,qBAAI/U,EAAEgV,SAAN,EAAiB;AACfP,4BAAOzU,EAAEgV,SAAT;AACD;AACF;AACDgD,4BAAehY,EAAEgY,YAAjB;AACD;AACF;;AAGD,SAAIM,eAAeK,WAAnB,EAAgC;AAC9BhE,iBAAQ2D,eAAeK,WAAvB;AACD;AACD,SAAIL,eAAerD,YAAnB,EAAiC;AAC/BoD,kBAASC,eAAerD,YAAxB;AACD;;AAED,YAAO,EAAC,KAAIjR,IAAL,EAAW,KAAIyQ,GAAf,EAAoB,SAAQE,KAA5B,EAAmC,UAAS0D,MAA5C,EAAP;AACH,EAlED;;AAuEAtO,KAAI6O,cAAJ,GAAqB,UAAU3d,EAAV,EAAc;AAC/B,SAAI4d,MAAM,KAAK3E,SAAL,CAAejZ,EAAf,CAAV;AAAA,SACIgZ,MAAM4E,IAAI3d,QADd;AAAA,SAEI4d,IAAE,CAFN;AAGA,SAAID,IAAIE,UAAR,EAAoBD,IAAID,IAAIE,UAAR,CAApB,KACK,IAAI9E,IAAI+E,eAAJ,IAAuB/E,IAAI+E,eAAJ,CAAoB/G,WAA/C,EAA4D6G,IAAI7E,IAAI+E,eAAJ,CAAoB/G,WAAxB,CAA5D,KACA,IAAIgC,IAAIrV,IAAR,EAAcka,IAAI7E,IAAIrV,IAAJ,CAASqT,WAAb;AACnB,YAAO6G,CAAP;AACH,EARD;;AAUA/O,KAAIkP,cAAJ,GAAqB,UAAUhe,EAAV,EAAc;AAC/B,SAAI4d,MAAM,KAAK3E,SAAL,CAAejZ,EAAf,CAAV;AAAA,SACIgZ,MAAM4E,IAAI3d,QADd;AAAA,SAEI4d,IAAE,CAFN;AAGA,SAAID,IAAIK,UAAR,EAAoBJ,IAAID,IAAIK,UAAR,CAApB,KACK,IAAIjF,IAAI+E,eAAJ,IAAuB/E,IAAI+E,eAAJ,CAAoB/G,WAA/C,EAA4D6G,IAAI7E,IAAI+E,eAAJ,CAAoB/G,WAAxB,CAA5D,KACA,IAAIgC,IAAIrV,IAAR,EAAcka,IAAI7E,IAAIrV,IAAJ,CAASqT,WAAb;AACnB,YAAO6G,CAAP;AACH,EARD;;AAUA/O,KAAIoP,eAAJ,GAAsB,UAAUle,EAAV,EAAc;AAChC,SAAI4d,MAAM,KAAK3E,SAAL,CAAejZ,EAAf,CAAV;AAAA,SACIgZ,MAAM4E,IAAI3d,QADd;AAAA,SAEI0N,IAAE,CAFN;AAGA,SAAIiQ,IAAIO,WAAR,EAAqBxQ,IAAIiQ,IAAIO,WAAR,CAArB,KACK,IAAInF,IAAI+E,eAAJ,IAAuB/E,IAAI+E,eAAJ,CAAoBjH,YAA/C,EAA6DnJ,IAAIqL,IAAI+E,eAAJ,CAAoBjH,YAAxB,CAA7D,KACA,IAAIkC,IAAIrV,IAAR,EAAcgK,IAAIqL,IAAIrV,IAAJ,CAASmT,YAAb;AACnB,YAAOnJ,CAAP;AACH,EARD;;AAUAmB,KAAIsP,eAAJ,GAAsB,UAAUpe,EAAV,EAAc;AAChC,SAAI4d,MAAM,KAAK3E,SAAL,CAAejZ,EAAf,CAAV;AAAA,SACIgZ,MAAM4E,IAAI3d,QADd;AAAA,SAEI0N,IAAE,CAFN;AAGA,SAAIiQ,IAAIS,WAAR,EAAqB1Q,IAAIiQ,IAAIS,WAAR,CAArB,KACK,IAAIrF,IAAI+E,eAAJ,IAAuB/E,IAAI+E,eAAJ,CAAoBjH,YAA/C,EAA6DnJ,IAAIqL,IAAI+E,eAAJ,CAAoBjH,YAAxB,CAA7D,KACA,IAAIkC,IAAIrV,IAAR,EAAcgK,IAAIqL,IAAIrV,IAAJ,CAASmT,YAAb;AACnB,YAAOnJ,CAAP;AACH,EARD;;AAUAmB,KAAIsL,gBAAJ,GAAuB,UAAUpa,EAAV,EAAc;AACjC,SAAI4d,MAAM,KAAK3E,SAAL,CAAejZ,EAAf,CAAV;AAAA,SACIgZ,MAAM4E,IAAI3d,QADd;AAEA,YAAO2d,IAAIU,WAAJ,IAAoBtF,IAAI+E,eAAJ,IAAuB/E,IAAI+E,eAAJ,CAAoBlH,SAA/D,IAA8EmC,IAAIrV,IAAJ,IAAYqV,IAAIrV,IAAJ,CAASkT,SAA1G;AACH,EAJD;;AAMA/H,KAAIuL,iBAAJ,GAAwB,UAAUra,EAAV,EAAc;AAClC,SAAI4d,MAAM,KAAK3E,SAAL,CAAejZ,EAAf,CAAV;AAAA,SACIgZ,MAAM4E,IAAI3d,QADd;AAEA,YAAO2d,IAAIW,WAAJ,IAAoBvF,IAAI+E,eAAJ,IAAuB/E,IAAI+E,eAAJ,CAAoBhH,UAA/D,IAA+EiC,IAAIrV,IAAJ,IAAYqV,IAAIrV,IAAJ,CAASoT,UAA3G;AACH,EAJD;;AAMAjI,KAAImK,SAAJ,GAAgB,UAAUjZ,EAAV,EAAc;AAC1B,SAAI4d,MAAMlH,MAAV;AACA,SAAI1W,EAAJ,EAAQ;AACJ,aAAIgZ,MAAMhZ,GAAGwe,aAAb;AACAZ,eAAM5E,IAAIG,WAAJ,IAAmBH,IAAIyF,YAAvB,IAAuCzF,IAAItC,MAA3C,IAAqDA,MAA3D;AACH;AACD,YAAOkH,GAAP;AACH,EAPD;;AAUA9O,KAAIsI,iBAAJ,GAAwB,UAAUtW,CAAV,EAAa;AACjC,SAAIA,EAAE4d,KAAF,IAAW5d,EAAE6d,KAAjB,EAAwB,OAAO,EAAC,KAAK7d,EAAE4d,KAAR,EAAe,KAAK5d,EAAE6d,KAAtB,EAAP;;AAExB,SAAIC,KAAK3e,SAAS8d,eAAT,IAA4B9d,SAAS0D,IAA9C;AACA,YAAO,EAAC,KAAK7C,EAAE+d,OAAF,GAAYD,GAAG7H,UAAf,IAA6B6H,GAAGpB,UAAH,IAAiB,CAA9C,CAAN;AACC,cAAK1c,EAAEge,OAAF,GAAYF,GAAG/H,SAAf,IAA4B+H,GAAGnB,SAAH,IAAgB,CAA5C,CADN,EAAP;AAEH,EAND;;AAQA3O,KAAIC,UAAJ,GAAiB,UAAUtC,IAAV,EAAiBsS,IAAjB,EAAwB;AACrC,SAAI,uBAASA,IAAT,CAAJ,EAAoBA,OAAO,CAACA,IAAD,CAAP;AACpB,SAAI,CAAC,sBAAQA,IAAR,CAAD,IAAkB,sBAAQA,IAAR,CAAlB,IAAmC,0BAAYtS,IAAZ,CAAnC,IAAwD,sBAAQA,KAAKhJ,OAAb,CAA5D,EAAmF,OAAO,KAAP;AACnF,SAAIub,IAAIvS,KAAKhJ,OAAL,CAAaJ,WAAb,EAAR;AACA,UAAK,IAAI7G,IAAE,CAAN,EAASmT,KAAGoP,KAAKpiB,MAAtB,EAA8BH,IAAEmT,EAAhC,EAAoCnT,GAApC,EAAyC;AACrC,aAAIuiB,KAAKviB,CAAL,EAAQ6G,WAAR,MAAyB2b,CAA7B,EAAgC,OAAO,IAAP;AACnC;AACD,YAAO,KAAP;AACH,EARD;;AAUAlQ,KAAImQ,SAAJ,GAAgB,UAAUxS,IAAV,EAAgB;AAC5B,SAAI3L,CAAJ;;AAEA,SAAI,yBAAyB8Q,IAAzB,CAA8BnF,IAA9B,CAAJ,EAAyC;AACrC,aAAIyS,IAAIjf,SAAS0D,IAAjB;AAAA,aAAuBwb,KAAKD,EAAEE,KAA9B;AACAF,WAAEE,KAAF,GAAU3S,KAAKzP,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAAV;AACAyP,gBAAOyS,EAAEE,KAAT;AACAF,WAAEE,KAAF,GAAUD,EAAV;AACH;AACD,SAAI;AACA,aAAIre,IAAI2L,KAAKlH,KAAL,CAAW,kBAAX,CAAR,EAAwC;AACpC,oBAAOzE,IAAEqG,SAASrG,EAAE,CAAF,CAAT,EAAc,EAAd,CAAF,EAAoB,CAAC,CAACA,IAAE,QAAH,KAAc,EAAf,EAAkB,CAACA,IAAE,MAAH,KAAY,CAA9B,EAAiCA,IAAE,IAAnC,CAA3B;AACH,UAFD,MAEO,IAAIA,IAAI2L,KAAKlH,KAAL,CAAW,kBAAX,CAAR,EAAwC;AAC3C,oBAAOzE,IAAEqG,SAASrG,EAAE,CAAF,CAAT,EAAc,EAAd,CAAF,EAAoB,CAAC,CAAC,CAACA,IAAE,KAAH,KAAW,CAAZ,IAAe,IAAhB,EAAqB,CAAC,CAACA,IAAE,IAAH,KAAU,CAAX,IAAc,IAAnC,EAAwC,CAACA,IAAE,GAAH,IAAQ,IAAhD,CAA3B;AACH,UAFM,MAGH,OAAQ2L,KAAKlH,KAAL,CAAW,WAAX,EAAwBmE,MAAxB,CAA+B,CAA/B,EAAiC,CAAjC,EAAoClE,GAApC,CAAwC,UAASC,CAAT,EAAW;AAAE,oBAAO,KAAImM,IAAJ,CAASnM,CAAT,IAAY,CAAC0B,SAAS1B,CAAT,IAAY,IAAb,EAAmB0P,OAAnB,CAA2B,CAA3B,CAAZ,GAA0ChO,SAAS1B,CAAT;AAAjD;AAA6D,UAAlH,CAAR;AACP,MAPD,CAOE,OAAM4Z,GAAN,EAAU;AACR;AACH;AACJ,EAnBD;AAoBAvQ,KAAIwQ,UAAJ,GAAiB,UAAUtf,EAAV,EAAcuf,OAAd,EAAuB;AACpC,SAAIvf,GAAG6I,KAAH,CAAS0W,OAAT,IAAoBA,OAAxB,EAAiC;AAC7Bvf,YAAG6I,KAAH,CAAS0W,OAAT,GACAvf,GAAG6I,KAAH,CAAS2W,WAAT,GACAxf,GAAG6I,KAAH,CAAS4W,UAAT,GAAsBF,OAFtB;AAGAvf,YAAG6I,KAAH,CAAS/J,MAAT,GAAkB,mBAAkBygB,UAAQ,GAA1B,GAA+B,GAAjD;AACH;AACJ,EAPD;;AASAzQ,KAAIpN,GAAJ,GAAU,UAAU1B,EAAV,EAAc;AACpB,SAAI7F,OAAO,IAAX;;AAEAA,UAAKwH,QAAL,GAAgB,YAAW;AACvB,aAAI0U,MAAM,sBAAQ3Z,UAAU,CAAV,CAAR,IAAsBA,UAAU,CAAV,CAAtB,GAAmCuQ,MAAM4E,SAAN,CAAgBT,KAAhB,CAAsBZ,IAAtB,CAA2B9T,SAA3B,CAA7C;AACAvC,cAAKkI,WAAL,CAAiBgU,GAAjB;AACArW,YAAG7B,SAAH,GAAe6B,GAAG7B,SAAH,GAAa,GAAb,GAAiB8O,MAAM4E,SAAN,CAAgBjM,IAAhB,CAAqB4K,IAArB,CAA0B6F,GAA1B,EAA8B,GAA9B,CAAhC;AACA,gBAAOlc,IAAP;AACH,MALD;;AAOAA,UAAKkI,WAAL,GAAmB,SAASA,WAAT,GAAuB;AACtC,aAAIgU,MAAM,sBAAQ3Z,UAAU,CAAV,CAAR,IAAsBA,UAAU,CAAV,CAAtB,GAAmCA,SAA7C;AACA,aAAI,CAAC2F,YAAYqd,KAAjB,EAAwBrd,YAAYqd,KAAZ,GAAoB,EAApB;AACxB,aAAInV,IAAIlI,YAAYqd,KAApB;AACA,cAAK,IAAIljB,IAAE,CAAN,EAASC,KAAG4Z,IAAI1Z,MAArB,EAA6BH,IAAEC,EAA/B,EAAmCD,GAAnC,EAAwC;AACpC,iBAAI,CAAC+N,EAAEhN,cAAF,CAAiB8Y,IAAI7Z,CAAJ,CAAjB,CAAL,EAA+B+N,EAAE8L,IAAI7Z,CAAJ,CAAF,IAAY,IAAI2Q,MAAJ,CAAW,aAAWkJ,IAAI7Z,CAAJ,CAAX,GAAkB,UAA7B,CAAZ;AAC/BwD,gBAAG7B,SAAH,GAAe6B,GAAG7B,SAAH,CAAasB,OAAb,CAAqB8K,EAAE8L,IAAI7Z,CAAJ,CAAF,CAArB,EAA+B,GAA/B,CAAf;AACH;AACDwD,YAAG7B,SAAH,GAAa6B,GAAG7B,SAAH,CAAasB,OAAb,CAAqB,QAArB,EAA8B,GAA9B,CAAb;AACA,gBAAOtF,IAAP;AACH,MAVD;;AAYAA,UAAK2I,QAAL,GAAgB,UAASyH,CAAT,EAAY;AACxB,aAAIkK,KAAK,IAAItH,MAAJ,CAAW,aAAW5C,CAAX,GAAa,UAAxB,CAAT;AACA,gBAAOvK,GAAG7B,SAAH,CAAaoH,KAAb,CAAmBkP,EAAnB,EAAsB,MAAIlK,CAAJ,GAAM,GAA5B,CAAP;AACH,MAHD;;AAKApQ,UAAK8N,QAAL,GAAgB,YAAW;AACvB,gBAAOjI,GAAG7B,SAAV;AACH,MAFD;;AAIAhE,UAAKwlB,aAAL,GAAqB,UAASpV,CAAT,EAAY;AAC7B,aAAIqV,OAAO5f,GAAG7B,SAAH,CAAaoH,KAAb,CAAmB,IAAI4H,MAAJ,CAAW,YAAU5C,CAAV,GAAY,YAAvB,CAAnB,CAAX;;AAEA,gBAAOqV,OAAOA,KAAK,CAAL,EAAQhd,OAAR,CAAgB,GAAhB,IAAqB,CAAtB,GAAyBgd,KAAK,CAAL,EAAQ5iB,KAAR,CAAc,GAAd,CAAzB,GACyB4iB,KAAK,CAAL,CAD/B,GAEK,IAFZ;AAGH,MAND;;AAQAzlB,UAAKif,gBAAL,GAAwB,UAAS3M,IAAT,EAAe;AACnC,aAAImK,CAAJ;AACA,aAAI5W,GAAG6f,YAAP,EACIjJ,IAAInK,OAAKzM,GAAG6f,YAAH,CAAgBpT,IAAhB,CAAL,GAA2BzM,GAAG6f,YAAlC,CADJ,KAEK,IAAInJ,OAAO0C,gBAAX,EAA6B;AAC9BxC,iBAAI3W,SAASkZ,WAAT,CAAqBC,gBAArB,CAAsCpZ,EAAtC,EAAyC,IAAzC,CAAJ;AACA,iBAAIyM,IAAJ,EAAUmK,IAAEA,EAAEnK,IAAF,CAAF;AACb,UAHI,MAGE;AACHmK,iBAAI,IAAJ;AACH;AACD,gBAAOA,CAAP;AACH,MAXD;AAYA,YAAO,IAAP;AACH,EApDD;;SAsDS9H,G,GAAAA,G;;;;;;;;;;;;;;;;AC1PT;;AAEA;;AAGA,KAAIgR,KAAK,IAAI,YAAY;AACrB,SAAI3lB,OAAO,IAAX;;AAEA,SAAI4lB,OAAO,EAAX;;AAEA,SAAIC,MAAM,CAAV;;AAEA,SAAI7J,OAAO;AACP,iBAAQ;;AADD,MAAX;;AAMA,SAAI8J,mBAAmB,SAAnBA,gBAAmB,CAAUnf,CAAV,EAAa;AAChCof,oBAAWpf,CAAX;AACA,aAAIe,KAAK,IAAT;AAAA,aACMse,MAAM,IADZ;AAAA,aAEMngB,KAAKc,EAAE4B,MAFb;AAAA,aAGM0d,KAAK,IAHX;AAAA,aAIM5X,MAAM,IAJZ;;AAMA,aAAI,CAAC1H,EAAEuf,aAAH,IAAoB,EAAExe,KAAKf,EAAEuf,aAAF,CAAgBlK,KAAKmK,IAArB,CAAP,CAApB,IAA0D,EAAEH,MAAMJ,KAAKle,EAAL,EAAS0e,OAAT,CAAiBzf,EAAEO,IAAnB,CAAR,CAA9D,EAAiG;;AAEjG,aAAI;AACA,kBAAK,IAAI7E,IAAI,CAAR,EAAWgkB,KAAKL,IAAIxjB,MAAzB,EAAiCH,IAAIgkB,EAArC,EAAyChkB,GAAzC;AAA8C,qBAAI,yBAAW2jB,IAAI3jB,CAAJ,CAAX,CAAJ,EAAwBgM,MAAMA,OAAO,EAAE,UAAU2X,IAAI3jB,CAAJ,EAAOgU,IAAP,CAAY1P,EAAEuf,aAAd,EAA6Bvf,CAA7B,CAAZ,CAAb;AAAtE;AACH,UAFD,CAEE,OAAOue,GAAP,EAAY;AAAE3O,wBAAW,YAAY;AAAE,uBAAM,IAAIrT,KAAJ,CAAU,wBAAwByD,EAAEO,IAA1B,GAAiC,iCAAjC,GAAqEge,IAAIoB,OAAzE,GAAmF,IAA7F,CAAN;AAA2G,cAApI,EAAsI,EAAtI;AAA2I;;AAE3J,gBAAOjY,GAAP;AACH,MAfD;;AAiBA,SAAIkY,qBAAqB,SAASA,kBAAT,CAA6B5f,CAA7B,EAAgC;AACrD,cAAK,IAAItE,IAAIujB,KAAKpjB,MAAL,GAAc,CAAtB,EAAyBgkB,MAAM,IAA/B,EAAqC3gB,KAAK,IAA/C,EAAqDxD,KAAK,CAA1D,EAA6DA,GAA7D,EAAkE;AAC9D,iBAAIujB,KAAKvjB,CAAL,MAAYwD,KAAK,CAAC2gB,MAAMZ,KAAKvjB,CAAL,CAAP,EAAgBokB,IAAjC,CAAJ,EAA4C;AACxC,sBAAK,IAAIzb,CAAT,IAAcwb,IAAIJ,OAAlB,EAA2B;AACvB,yBAAI,CAACI,IAAIJ,OAAJ,CAAYhjB,cAAZ,CAA2B4H,CAA3B,CAAL,EAAoC;AACpC,yBAAI;AACA,6BAAInF,GAAG+D,mBAAP,EAA4B;AACxB/D,gCAAG+D,mBAAH,CAAuBoB,CAAvB,EAA0Bwb,IAAIE,YAAJ,GAAmBF,IAAIE,YAAvB,GAAsCZ,gBAAhE,EAAkF,KAAlF;AACH,0BAFD,MAEO,IAAIjgB,GAAG8gB,WAAP,EAAoB;AACvB9gB,gCAAG8gB,WAAH,CAAe,OAAO3b,CAAtB,EAAyBwb,IAAIE,YAAJ,GAAmBF,IAAIE,YAAvB,GAAsCZ,gBAA/D;AACH;AACJ,sBAND,CAME,OAAOnf,CAAP,EAAU,CAAG;AACf6f,yBAAIJ,OAAJ,CAAYpb,CAAZ,EAAexI,MAAf,GAAwB,CAAxB;AACH;AACJ;AACDqD,kBAAK2gB,IAAIC,IAAJ,GAAW,IAAhB;AACH;AACD,aAAIlK,OAAO3S,mBAAX,EAAgC;AAC5B2S,oBAAO3S,mBAAP,CAA2BoB,CAA3B,EAA8Bub,kBAA9B,EAAkD,KAAlD;AACH,UAFD,MAEO;AACHhK,oBAAOoK,WAAP,CAAmB,OAAO3b,CAA1B,EAA6Bub,kBAA7B;AACH;AACJ,MAtBD;;AAyBA,SAAIR,aAAa,SAAbA,UAAa,CAAUpf,CAAV,EAAa;AAC1B,aAAItE,IAAIrC,KAAK4mB,EAAL,CAAQpkB,MAAhB;AAAA,aACMqkB,GADN;AAAA,aACWC,IADX;AAAA,aACiBhR,CADjB;AAAA,aACoBiR,IADpB;AAEA,gBAAO1kB,GAAP,EAAY;AACRwkB,mBAAM7mB,KAAK4mB,EAAL,CAAQvkB,CAAR,CAAN;AACA,iBAAIwkB,IAAI,CAAJ,EAAOpP,IAAP,CAAY9Q,EAAEO,IAAd,CAAJ,EAAyB;AACrB4O,qBAAI+Q,IAAI,CAAJ,EAAOrkB,MAAX;AACAukB,wBAAO,IAAP;AACA,wBAAOjR,GAAP,EAAY;AACRgR,4BAAOD,IAAI,CAAJ,EAAO/Q,CAAP,CAAP;AACA,yBAAI,UAAUgR,KAAK,CAAL,CAAd,EAAuBC,OAAOD,KAAK,CAAL,CAAP,CAAvB,KACK,IAAI,CAACngB,EAAEmgB,KAAK,CAAL,CAAF,CAAL,EAAiBngB,EAAEmgB,KAAK,CAAL,CAAF,IAAaA,KAAK,CAAL,CAAb;AACzB;AACD,qBAAIC,IAAJ,EAAUA,KAAK1Q,IAAL,CAAU1P,CAAV;AACb;AACJ;AACD,aAAI,CAACA,EAAE4B,MAAH,IAAa5B,EAAEO,IAAF,IAAU,QAA3B,EAAqCP,EAAE4B,MAAF,GAAW5B,EAAEsB,UAAb;AACrC,gBAAOtB,CAAP;AACH,MAlBD;;AAoBA,SAAIqgB,UAAU,SAAVA,OAAU,CAAUnhB,EAAV,EAAcqQ,CAAd,EAAiB;AAC3B,gBAAOrQ,GAAGmW,KAAKmK,IAAR,KAAkBjQ,MAAMrQ,GAAGmW,KAAKmK,IAAR,IAAgB,EAAEN,GAAxB,CAAzB;AACH,MAFD;;AAKA7lB,UAAKyJ,gBAAL,GAAwB,UAAU5D,EAAV,EAAcohB,EAAd,EAAkBzT,CAAlB,EAAqB;AACzC,aAAI,CAAC3N,EAAD,IAAO,CAAC,yBAAW2N,CAAX,CAAZ,EAA2B,OAAO,KAAP;;AAG3B,aAAI9L,KAAKsf,QAAQnhB,EAAR,EAAY,IAAZ,CAAT;AAAA,aACM2gB,MAAM,IADZ;AAAA,aAEMR,MAAM,IAFZ;;AAKA,aAAI,CAACJ,KAAKle,EAAL,CAAL,EAAe;AACXke,kBAAKle,EAAL,IAAW;AACP,yBAAQ7B,EADD;AAEL,4BAAW;AAFN,cAAX;AAIH;AACD2gB,eAAMZ,KAAKle,EAAL,CAAN;;AAEA,aAAI,CAAC8e,IAAIJ,OAAJ,CAAYhjB,cAAZ,CAA2B6jB,EAA3B,CAAL,EAAqC;AACjCT,iBAAIJ,OAAJ,CAAYa,EAAZ,IAAkB,EAAlB;;AAEA,iBAAIphB,GAAG4D,gBAAP,EAAyB;AACrB5D,oBAAG4D,gBAAH,CAAoBwd,EAApB,EAAwBnB,gBAAxB,EAA0C,KAA1C;AACH,cAFD,MAEO,IAAIjgB,GAAGmQ,WAAP,EAAoB;;AAEvBwQ,qBAAIE,YAAJ,GAAmB,UAAU/f,CAAV,EAAa;AAC5BA,uBAAEuf,aAAF,GAAkBM,IAAIC,IAAtB,CAD4B,CACD;AAC3B,yBAAIpY,MAAMyX,iBAAiBnf,CAAjB,CAAV;AACAA,uBAAEuf,aAAF,GAAkB,IAAlB;AACA,4BAAO7X,GAAP;AACH,kBALD;AAMAxI,oBAAGmQ,WAAH,CAAe,OAAOiR,EAAtB,EAA0BT,IAAIE,YAA9B;AACH;AACJ;AACDV,eAAMQ,IAAIJ,OAAJ,CAAYa,EAAZ,CAAN;;AAEA,aAAIjB,IAAIvd,OAAJ,CAAY+K,CAAZ,KAAkB,CAAC,CAAvB,EAA0B;AACtBwS,iBAAIA,IAAIxjB,MAAR,IAAkBgR,CAAlB;AACA,oBAAO,IAAP;AACH;AACD,gBAAO,KAAP;AACH,MAxCD;;AA0CAxT,UAAK4J,mBAAL,GAA2B,UAAU/D,EAAV,EAAcohB,EAAd,EAAkBzT,CAAlB,EAAqB;AAC5C,aAAI,CAAC3N,EAAD,IAAO,CAAC,yBAAW2N,CAAX,CAAZ,EAA2B,OAAO,KAAP;AAC3B,aAAI9L,KAAKsf,QAAQnhB,EAAR,CAAT;AAAA,aACM2gB,MAAMZ,KAAKle,EAAL,CADZ;AAAA,aAEMwf,MAAM,IAFZ;AAGA,aAAIV,QAAQU,MAAMV,IAAIJ,OAAJ,CAAYa,EAAZ,CAAd,CAAJ,EAAoC;;AAEhCC,iBAAI3X,MAAJ,CAAW2X,IAAIze,OAAJ,CAAY+K,CAAZ,CAAX,EAA2B,CAA3B;AACA,iBAAI,KAAK0T,IAAI1kB,MAAb,EAAqB;AACjB,wBAAOgkB,IAAIJ,OAAJ,CAAYa,EAAZ,CAAP;;AAEA,qBAAIphB,GAAG+D,mBAAP,EAA4B;AACxB/D,wBAAG+D,mBAAH,CAAuBqd,EAAvB,EAA2BT,IAAIE,YAAJ,GAAmBF,IAAIE,YAAvB,GAAsCZ,gBAAjE,EAAmF,KAAnF;AACH,kBAFD,MAEO,IAAIjgB,GAAG8gB,WAAP,EAAoB;AACvB9gB,wBAAG8gB,WAAH,CAAe,OAAOM,EAAtB,EAA0BT,IAAIE,YAAJ,GAAmBF,IAAIE,YAAvB,GAAsCZ,gBAAhE;AACH;AACJ;AACD,oBAAO,IAAP;AACH;AACD,gBAAO,KAAP;AACH,MApBD;;AAsBA9lB,UAAKyG,aAAL,GAAqB,UAAUE,CAAV,EAAa;AAC9B,aAAI0H,MAAMyX,iBAAiBnf,CAAjB,CAAV;AACA,gBAAO0H,GAAP;AACH,MAHD;;AAKArO,UAAKmnB,aAAL,GAAqB,UAAUvc,CAAV,EAAaC,CAAb,EAAgB+I,CAAhB,EAAmBmR,CAAnB,EAAsB;AACvC,aAAIrd,KAAKsf,QAAQpc,CAAR,EAAW,IAAX,CAAT;AACA,aAAI,CAACgb,KAAKle,EAAL,CAAL,EAAe;AACXke,kBAAKle,EAAL,IAAW;AACP,yBAAQkD,CADD;AAEP,4BAAW;AAFJ,cAAX;AAIH,UALD,MAKO;AACHgb,kBAAKle,EAAL,EAAS+e,IAAT,GAAgB7b,CAAhB;AACH;AACD,gBAAO,IAAI+a,GAAGyB,WAAP,CAAmBxc,CAAnB,EAAsBC,CAAtB,EAAyB+I,CAAzB,EAA4BmR,CAA5B,CAAP;AACH,MAXD;;AAaA,SAAIsC,cAAc,SAAdA,WAAc,GAAY;;AAE1B,aAAI9K,OAAOvG,WAAP,IAAsB,CAACuG,OAAO9S,gBAAlC,EAAoD;AAChD8S,oBAAOvG,WAAP,CAAmB,UAAnB,EAA+BuQ,kBAA/B;AACH;AACJ,MALD;AAMAc;AACH,EAzKQ,EAAT;;AA2KA1B,IAAGnV,oBAAH,GAA0B,UAAU7J,CAAV,EAAa;AACnCA,OAAEgB,cAAF;AACH,EAFD;AAGAge,IAAG2B,qBAAH,GAA2B,UAAU3gB,CAAV,EAAa;AACpCA,OAAEwB,eAAF;AACH,EAFD;;AAMAwd,IAAGyB,WAAH,GAAiB,UAAU3Q,GAAV,EAAe3T,IAAf,EAAqBykB,MAArB,EAA6BC,GAA7B,EAAkC;AAC/C,SAAIxnB,OAAO,IAAX;;AAGA,SAAIynB,YAAY,CAAC,CAACF,MAAlB;;AAEA,SAAIG,gBAAgB,yBAAWF,GAAX,IAAkBA,GAAlB,GAAwB,IAA5C;;AAIAxnB,UAAK2nB,OAAL,GAAe,UAAU9hB,EAAV,EAAc+hB,IAAd,EAAoB;AAC/B,aAAI,EAAErlB,UAAUC,MAAV,GAAmB,CAArB,KAA2BqD,MAAM4Q,GAArC,EAA0C;AACtCmR,oBAAO/hB,EAAP;AACAA,kBAAK,IAAL;AACH;AACD,aAAI,CAACA,EAAL,EAASA,KAAK4Q,GAAL;AACT,aAAI9P,IAAI,EAAR;AAAA,aACM0H,MAAM,IADZ;AAAA,aAEMwZ,QAAQ,IAFd;AAAA,aAGMjQ,MAAM,IAHZ;AAIA,cAAK,IAAIvV,CAAT,IAAculB,IAAd,EAAoB;AAChB,iBAAIA,KAAKxkB,cAAL,CAAoBf,CAApB,CAAJ,EAA4BsE,EAAEtE,CAAF,IAAOulB,KAAKvlB,CAAL,CAAP;AAC/B;;AAGDolB,qBAAY,CAAC,CAACF,MAAd;AACAG,yBAAgBF,GAAhB;;AAGA,YAAG;AACC7gB,eAAEgB,cAAF,GAAmBA,cAAnB;AACAhB,eAAEwB,eAAF,GAAoBA,eAApB;AACAxB,eAAE4B,MAAF,GAAW1C,EAAX;AACAc,eAAEuf,aAAF,GAAkBrgB,EAAlB;AACAc,eAAEO,IAAF,GAASpE,IAAT;AACA8U,mBAAM+N,GAAGlf,aAAH,CAAiBE,CAAjB,CAAN;AACAkhB,sBAAU,0BAAYjQ,GAAZ,CAAV;AACAvJ,oBAAO,EAAE,UAAUuJ,GAAZ,CAAP;AACH,UATD,QASS,CAAC/R,KAAKA,GAAG2C,UAAT,KAAwBif,SATjC;;AAWA,aAAI,yBAAWC,aAAX,KAA6BrZ,GAA7B,IAAoC,CAACwZ,KAAzC,EAAgD;AAC5CH,2BAAc/gB,CAAd;AACH;AACD,gBAAQ+gB,iBAAiBrZ,GAAjB,IAAwB,CAACwZ,KAAjC;AACH,MAlCD;;AAoCA,SAAIlgB,iBAAiB,SAAjBA,cAAiB,GAAY;AAC7B+f,yBAAgB,IAAhB;AACH,MAFD;;AAIA,SAAIvf,kBAAkB,SAAlBA,eAAkB,GAAY;AAC9Bsf,qBAAY,KAAZ;AACH,MAFD;AAGH,EArDD;;AAuDA9B,IAAGiB,EAAH,GAAQ,CACJ,CAAC,GAAD,EAAM,CAEF,CAAC,gBAAD,EAAmB,YAAY;AAC3B,UAAKkB,WAAL,GAAmB,KAAnB;AACH,EAFD,CAFE,EAOA,CAAC,iBAAD,EAAoB,YAAY;AAC9B,UAAKC,YAAL,GAAoB,IAApB;AACH,EAFC,CAPA,CAAN,CADI,EAaF,CAAC,0BAAD,EAA6B,CAE3B,CAAC,WAAD,EAAc,YAAY;AACtB,YAAO,KAAKC,MAAL,IAAe,CAAf,GAAmB,CAAnB,GAAuB,CAA9B;AACH,EAFD,CAF2B,EAMzB,CAAC,YAAD,EAAe,GAAf,CANyB,EAOzB,CAAC,aAAD,EAAgB,GAAhB,CAPyB,CAA7B,CAbE,EAsBF,CAAC,qBAAD,EAAwB,CAEtB,CAAC,YAAD,EAAe,YAAY;AACvB,aAAQ,KAAKthB,OAAb;AACI,cAAK,GAAL;AAAU,oBAAO,GAAP;AACV,cAAK,GAAL;AAAU,oBAAO,EAAP;AACV,cAAK,GAAL;AAAU,oBAAO,EAAP;AACV,cAAK,GAAL;AAAU,oBAAO,EAAP;AACV;AAAS,oBAAO,KAAKA,OAAZ;AALb;AAOH,EARD,CAFsB,EAapB,CAAC,WAAD,EAAc,SAASY,SAAT,GAAqB;AACjC,YAAOA,UAAUuS,MAAjB;AACH,EAFC,CAboB,EAiBpB,CAAC,MAAD,EAAS,YAAY;AACnB,SAAIoO,KAAK,KAAK3gB,SAAd;AACA,SAAI,WAAW,KAAKJ,IAApB,EAA0B;AACtB+gB,YAAGpO,MAAH,GAAY,CAAZ;AACAoO,YAAGvhB,OAAH,GAAa,CAAb;AACH,MAHD,MAGO,IAAI,aAAa,KAAKQ,IAAtB,EAA4B;AAC/B+gB,YAAGpO,MAAH,GAAYoO,GAAGvhB,OAAH,IAAc,KAAKA,OAA/B;AACAuhB,YAAGvhB,OAAH,GAAa,KAAKA,OAAlB;AACH;AACJ,EATC,CAjBoB,CAAxB,CAtBE,CAAR;;AAuDA,EAAC,YAAY;;AAET,SAAIvB,MAAMwgB,GAAGwB,aAAH,CAAiB5K,MAAjB,EAAyB,SAAzB,CAAV;AAAA,SACM2L,WAAW,KADjB;AAAA,SAEMC,cAAc,SAAdA,WAAc,GAAY;;AAExBxC,YAAG/b,mBAAH,CAAuB9D,QAAvB,EAAiC,gBAAjC,EAAmDsiB,SAASC,EAA5D;;AAEA1C,YAAG/b,mBAAH,CAAuB9D,QAAvB,EAAiC,kBAAjC,EAAqDsiB,SAASE,EAA9D;;AAEA3C,YAAG/b,mBAAH,CAAuB2S,MAAvB,EAA+B,MAA/B,EAAuC6L,SAASE,EAAhD;AACH,MATL;AAAA,SAUMF,WAAW;AACT,eAAM,YAAUzhB,CAAV,EAAa;AACf,iBAAI4V,OAAOgM,KAAP,CAAaC,YAAb,IAA6B,eAA7B,IAAgD,CAACN,QAArD,EAA+D;AAC3D/iB,qBAAIwiB,OAAJ,CAAYpL,MAAZ;AACA4L;AACAD,4BAAW,IAAX;AACH;AACJ,UAPQ;AAQP,eAAM,YAAUvhB,CAAV,EAAa;AAAE,iBAAI,CAACuhB,QAAL,EAAe/iB,IAAIwiB,OAAJ,CAAYpL,MAAZ,EAAqB2L,WAAW,IAAX;AAAkB;AARpE,MAVjB;;AAsBAvC,QAAGlc,gBAAH,CAAoB3D,QAApB,EAA8B,gBAA9B,EAAgDsiB,SAASC,EAAzD;;AAEA1C,QAAGlc,gBAAH,CAAoB3D,QAApB,EAA8B,kBAA9B,EAAkDsiB,SAASE,EAA3D;;AAEA,SAAI,gBAAgB7Q,IAAhB,CAAqBgR,UAAUC,SAA/B,KAA8CnM,OAAOkC,KAAP,IAAgBzR,SAASuP,OAAOkC,KAAP,CAAakK,OAAb,EAAT,IAAmC,CAArG,EACI,CAAC,SAASC,oBAAT,GAAgC;AAAE,aAAI,CAACV,QAAL,EAAe,kBAAkBzQ,IAAlB,CAAuB3R,SAAS+iB,UAAhC,KAA+C1jB,IAAIwiB,OAAJ,CAAYpL,MAAZ,GAAqB2L,WAAW,IAA/E,IAAuF3R,WAAWqS,oBAAX,EAAiC,GAAjC,CAAvF;AAA8H,MAAhL;;AAEJjD,QAAGlc,gBAAH,CAAoB8S,MAApB,EAA4B,MAA5B,EAAoC6L,SAASE,EAA7C;AACH,EAhCD;;SAkCS3C,E,GAAAA,E;;;;;;;;;;;;;;;ACxUT,KAAImD,cAAc,SAAdA,WAAc,CAAU9c,GAAV,EAAe;AAC7B,SAAIhM,OAAO,IAAX;AAAA,SACM+oB,WAAWxmB,UAAUymB,MAD3B;;AAGA,SAAI,cAAc,OAAOhd,GAAzB,EAA8BA,MAAM,eAAY,CAAG,CAArB;;AAE9B,SAAIid,QAAQ,EAAZ;;AAKAjpB,UAAKkpB,IAAL,GAAY,UAAU1R,IAAV,EAAgB;AACxB0R,cAAK1R,IAAL,EAAWxL,GAAX;AACH,MAFD;;AAIAhM,UAAKipB,KAAL,GAAa,UAAUzR,IAAV,EAAgB;AACzB,aAAItB,IAAI+S,MAAMzmB,MAAd;AACAymB,eAAM/S,CAAN,IAAWsB,IAAX;AACA,aAAI,CAACtB,CAAL,EAAQgT,KAAK1R,IAAL,EAAW2R,YAAX;AACX,MAJD;;AASA,SAAID,OAAO,SAAPA,IAAO,CAAU1R,IAAV,EAAgBxL,GAAhB,EAAqB;AAC5B,aAAIod,GAAJ;AAAA,aACMC,MAAMN,SAASO,OADrB;AAEA,aAAIF,MAAMC,IAAI1nB,IAAJ,CAAS6V,IAAT,CAAV,EAA0B;AACtB6R,mBAAMN,SAASO,OAAT,CAAiBF,GAAjB,CAAN;AACA,iBAAIC,IAAI,CAAJ,CAAJ,EAAY;AACRrd,qBAAIwL,IAAJ,EAAU6R,IAAI,CAAJ,CAAV;AACH,cAFD,MAEO;AACHA,qBAAI,CAAJ,EAAO/lB,IAAP,CAAY0I,GAAZ;AACH;AACJ,UAPD,MAOO;AACHod,mBAAMC,IAAI7mB,MAAV;AACA6mB,iBAAID,GAAJ,IAAW,CAAC5R,IAAD,EAAO,CAACxL,GAAD,CAAP,EAAc,KAAd,CAAX;AACAqd,iBAAI1nB,IAAJ,CAAS6V,IAAT,IAAiB4R,GAAjB;AACAG,gBAAG/R,IAAH;AACH;AACJ,MAhBD;;AAkBA,SAAI+R,KAAK,SAALA,EAAK,CAAUC,GAAV,EAAe;AACpB,aAAI1jB,SAAS0D,IAAb,EAAmB;AACf,iBAAImB,IAAI7E,SAASoF,aAAT,CAAuB,QAAvB,CAAR;AAAA,iBACMsI,IAAI1N,SAAS2N,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CADV;AAEA9I,eAAEzD,IAAF,GAAS,iBAAT;AACAyD,eAAE8e,OAAF,GAAY,OAAZ;AACA9e,eAAE6e,GAAF,GAAQA,GAAR;;AAEA7e,eAAE+e,IAAF,GAASF,GAAT;AACA7e,eAAEgf,OAAF,GAAYhf,EAAEif,MAAF,GAAWjf,EAAEkf,kBAAF,GAAuBC,WAA9C;AACAtW,eAAEpJ,WAAF,CAAcO,CAAd;AACH,UAVD,MAUO;AACH7E,sBAASikB,KAAT,CAAe,SAAS,wBAAT,GAAoCP,GAApC,GAA0C,4BAA1C,GAAyE,MAAxF;;AAGAM,yBAAYzT,IAAZ,CAAiB,EAAE,QAAQmT,GAAV,EAAjB,EAAkC,EAAE,QAAQ,MAAV,EAAlC;AACH;AACJ,MAjBD;;AAsBA,SAAIL,eAAe,SAASA,YAAT,CAAuB3R,IAAvB,EAA6B7M,CAA7B,EAAgC;;AAE/CqB,aAAIwL,IAAJ,EAAU7M,CAAV;AACAse,eAAM1Z,MAAN,CAAa,CAAb,EAAgB,CAAhB;;AAEA,aAAI0Z,MAAMzmB,MAAN,IAAgBmI,CAApB,EACIue,KAAKD,MAAM,CAAN,CAAL,EAAeE,YAAf,EADJ,KAGInd,IAAI,IAAJ,EAAUrB,CAAV;AACP,MATD;;AAWA,SAAImf,cAAc,SAAdA,WAAc,CAAUnjB,CAAV,EAAa;AAC3B,aAAI0iB,MAAMN,SAASO,OAAnB;AAAA,aACMF,MAAMC,IAAI1nB,IAAJ,CAAS,KAAK+nB,IAAd,CADZ;AAAA,aAEM/iB,IAAIA,KAAK4V,OAAOgM,KAFtB;AAAA,aAGMla,GAHN;;AAKAgb,eAAMA,IAAID,GAAJ,CAAN;AACA,aAAIC,OAAO,CAACA,IAAI,CAAJ,CAAZ,EAAoB;AAChB,iBAAI,UAAU1iB,EAAEO,IAAZ,IAAoB,cAAc,KAAK2hB,UAAvC,IAAqD,YAAY,KAAKA,UAA1E,EAAsF;AAClFQ,qBAAI,CAAJ,IAAShb,MAAM,IAAf;AACH,cAFD,MAEO,IAAI,WAAW1H,EAAEO,IAAjB,EAAuB;AAC1BmH,uBAAM,KAAN;AACH;AACD,iBAAI,QAAQA,GAAZ,EAAiB;AACb,sBAAK,IAAIhM,IAAI,CAAR,EAAW2J,MAAMqd,IAAI,CAAJ,CAAjB,EAAyBzkB,KAAKoH,IAAIxJ,MAAvC,EAA+CH,IAAIuC,EAAnD,EAAuDvC,GAAvD,EAA4D;AACxD2J,yBAAI3J,CAAJ,EAAOgnB,IAAI,CAAJ,CAAP,EAAeA,IAAI,CAAJ,CAAf;AACH;AACD,qBAAI,CAAChb,GAAL,EAAU;AACN,4BAAO0a,SAASO,OAAT,CAAiB3nB,IAAjB,CAAsB,KAAK+nB,IAA3B,CAAP;AACA,4BAAOX,SAASO,OAAT,CAAiBF,GAAjB,CAAP;AACH;AACJ;AACJ;AACJ,MAvBD;AAwBH,EAnGD;;AAsGAN,aAAYQ,OAAZ,GAAsB,CAAC,KAAD,CAAtB;AACAR,aAAYQ,OAAZ,CAAoB3nB,IAApB,GAA2B,EAA3B;;AAEAmnB,aAAYG,KAAZ,GAAoB,UAAU1Q,GAAV,EAAevM,GAAf,EAAoB;AACpC,SAAI,CAACuM,IAAI/V,MAAT,EAAiB;AACjB,SAAIyR,IAAI,IAAI6U,WAAJ,CAAgB9c,GAAhB,CAAR;AACA,UAAK,IAAI3J,IAAI,CAAR,EAAWC,KAAKiW,IAAI/V,MAAzB,EAAiCH,IAAIC,EAArC,EAAyCD,GAAzC,EAA8C;AAC1C4R,WAAEgV,KAAF,CAAQ1Q,IAAIlW,CAAJ,CAAR;AACH;AACJ,EAND;;AAQAymB,aAAYI,IAAZ,GAAmB,UAAUM,GAAV,EAAexd,GAAf,EAAoB;AACnC,SAAIwd,GAAJ,EAAS;AACJ,aAAIV,WAAJ,CAAgB9c,GAAhB,CAAD,CAAuBkd,IAAvB,CAA4BM,GAA5B;AACH;AACJ,EAJD;;AAMA,KAAIjN,OAAOyN,mBAAP,YAAsClX,KAA1C,EAAiD;AAC7CgW,iBAAYG,KAAZ,CAAkB1M,OAAOyN,mBAAzB;AACH;;SAEQlB,W,GAAAA,W;;;;;;;;;;;;;;AC5HT,KAAIrlB,MAAM,IAAI,YAAY;AACtB,SAAIzD,OAAO,IAAX;AACA,SAAI6D,OAAO,+GACL,2CADK,GAEL,wEAFK,GAGL,iKAHN;AAIA,SAAIkO,MAAM,IAAV;AACA,SAAIkY,QAAQ,EAAZ;AACA,SAAIC,OAAO,CAAX;AACA,SAAIC,UAAU,KAAd;AACA,SAAIC,KAAK,EAAT;AACA,SAAI7hB,SAAS,IAAb;AACA,SAAI8hB,eAAe,IAAnB;;AAEIrqB,UAAK+J,IAAL,GAAY,UAAUY,CAAV,EAAa;AACzBpC,kBAASxI,gBAAgB8J,gBAAhB,EAAT;AACA,aAAI4Z,MAAM9O,IAAImK,SAAJ,CAAcvW,MAAd,CAAV;AACQ,aAAI8hB,gBAAgB5G,GAApB,EAAyB;AAC7B,iBAAI1R,OAAOA,IAAIvJ,UAAf,EAA2B;AACvBuJ,qBAAIvJ,UAAJ,CAAe8B,WAAf,CAA2ByH,GAA3B;AACH;AACDsY,4BAAe5G,GAAf;AACA6G;AACAD,0BAAavkB,QAAb,CAAsB0D,IAAtB,CAA2BY,WAA3B,CAAuC2H,GAAvC;AACH;AACOA,aAAI/N,SAAJ,GAAgBhE,KAAKiE,GAArB;;AAER,aAAI0G,CAAJ,EAAO3K,KAAKuqB,cAAL,CAAoB5f,CAApB;AACP,aAAIpC,UAAUwJ,GAAV,IAAiBqY,GAAG5nB,MAAH,GAAY,CAAjC,EAAoC;AAChCmjB,gBAAGlc,gBAAH,CAAoBlB,MAApB,EAA4B,MAA5B,EAAoCvI,KAAK0J,WAAzC;AACAqI,iBAAIrD,KAAJ,CAAU8b,OAAV,GAAoB,OAApB;AACAxqB,kBAAKyqB,cAAL,CAAoBliB,MAApB;AACH,UAJD,MAIO,IAAI,UAAUwJ,IAAIrD,KAAJ,CAAU8b,OAAxB,EAAiC;AACpCxqB,kBAAK0D,IAAL;AACH;AACJ,MArBG;;AAuBA1D,UAAK0D,IAAL,GAAY,UAAUwZ,IAAV,EAAgB;AAC5B,aAAInL,OAAO,UAAUA,IAAIrD,KAAJ,CAAU8b,OAA/B,EAAwC;AACpCzY,iBAAIrD,KAAJ,CAAU8b,OAAV,GAAoB,MAApB;AACA7E,gBAAG/b,mBAAH,CAAuBrB,MAAvB,EAA+B,MAA/B,EAAuCvI,KAAK0J,WAA5C;AACA,iBAAInB,UAAUwT,kBAAkBpW,YAAlB,CAA+B4C,MAA/B,CAAV,IAAoD,CAAC2U,IAAzD,EACInB,kBAAkBuB,eAAlB,CAAkC/U,MAAlC;AACJA,sBAAS,IAAT;AACA6hB,kBAAK,EAAL;AACH;AACJ,MATG;AAUApqB,UAAKyqB,cAAL,GAAsB,YAAY;AAClC,aAAI1K,KAAKpL,IAAIqL,SAAJ,CAAczX,MAAd,CAAT;AACAwJ,aAAIrD,KAAJ,CAAUE,IAAV,GAAiBmR,GAAGxF,CAAH,GAAO,IAAxB;AACA,aAAImQ,KAAK3O,kBAAkBS,kBAAlB,CAAqCjU,MAArC,CAAT;AACAwJ,aAAIrD,KAAJ,CAAU2Q,GAAV,GAAgBU,GAAGtD,CAAH,GAAOiO,GAAGjO,CAAV,GAAciO,GAAGlX,CAAjB,GAAqB,IAArC;AACH,MALG;AAMAxT,UAAKuqB,cAAL,GAAsB,UAAUhS,GAAV,EAAe;AACrC,aAAI,CAAC1F,QAAQ0F,GAAR,CAAL,EAAmB,OAAO,KAAP;AACnB6R,cAAK7R,GAAL;AACA2R,gBAAO,CAAP;AACAS;AACA3qB,cAAKyqB,cAAL,CAAoBliB,MAApB;AACH,MANG;AAOAvI,UAAK4qB,cAAL,GAAsB,UAAUrc,GAAV,EAAe;AACrC,gBAAOkE,SAASlE,GAAT,IAAgB6b,GAAG7b,GAAH,CAAhB,GAA0B6b,EAAjC;AACH,MAFG;AAGApqB,UAAKoH,QAAL,GAAgB,UAAUT,CAAV,EAAa;AAC7BujB,gBAAOhS,KAAKC,GAAL,CAASD,KAAKa,GAAL,CAASmR,OAAO,CAAhB,EAAoBhS,KAAKE,IAAL,CAAUgS,GAAG5nB,MAAH,GAAY,EAAtB,CAAD,GAA8B,CAAjD,CAAT,EAA8D,CAA9D,CAAP;AACAmoB;AACH,MAHG;AAIA3qB,UAAKmH,QAAL,GAAgB,UAAUR,CAAV,EAAa;AAC7BujB,gBAAOhS,KAAKC,GAAL,CAAS+R,OAAO,CAAhB,EAAmB,CAAnB,CAAP;AACAS;AACH,MAHG;AAIA3qB,UAAK6qB,OAAL,GAAe,YAAY;AAC3B,gBAAOX,IAAP;AACH,MAFG;AAGAlqB,UAAK8qB,OAAL,GAAe,UAAUjgB,CAAV,EAAa;AAC5BA,aAAI,EAAEA,CAAF,GAAM,CAAN,GAAU,CAAV,GAAcA,CAAlB;AACA,gBAAOuf,GAAGpqB,KAAK6qB,OAAL,KAAiB,EAAjB,GAAsBhgB,CAAzB,CAAP;AACH,MAHG;AAIJ7K,UAAK+G,MAAL,GAAc,YAAY;AACtB,gBAAOgL,OAAO,WAAWA,IAAIrD,KAAJ,CAAU8b,OAAnC;AACH,MAFD;AAGIxqB,UAAK0J,WAAL,GAAmB,UAAU/C,CAAV,EAAa;AAChC3G,cAAK0D,IAAL;AACH,MAFG;AAGA1D,UAAK+qB,aAAL,GAAqB,UAAUpkB,CAAV,EAAa;AAClC,aAAIqkB,KAAKjZ,IAAIhC,UAAJ,CAAe8E,IAAf,CAAoB,CAApB,EAAuBM,KAAvB,CAA6B,CAA7B,EAAgC5E,SAAzC;AACA,aAAI4Z,UAAU,CAACA,OAAf,EAAwB;AACpBD,oBAAO,CAAP;AACAc,gBAAGhnB,SAAH,GAAe,UAAf;AACH,UAHD,MAGO;AACHgnB,gBAAGhnB,SAAH,GAAe,SAAf;AACH;AACD2mB;AACH,MATG;AAUA,SAAIA,WAAW,SAAXA,QAAW,GAAY;AAC3B,aAAIhgB,IAAI,CAAC,SAAD,CAAR;AACA,cAAK,IAAIK,IAAI,CAAR,EAAW6Q,KAAK3D,KAAKE,IAAL,CAAUgS,GAAG5nB,MAAH,GAAY,EAAtB,CAArB,EAAgDwI,IAAI6Q,EAApD,EAAwD7Q,GAAxD,EAA6D;AACzD,iBAAImf,WAAWnf,KAAKkf,IAApB,EAA0B;AACtBvf,mBAAErH,IAAF,CAAO,MAAP;AACA,sBAAK,IAAIjB,IAAI,CAAR,EAAWuT,IAAI5K,IAAI,EAAxB,EAA4B3I,IAAI,EAAJ,IAAU,CAACgQ,YAAY+X,GAAGxU,IAAIvT,CAAP,CAAZ,CAAvC,EAA+DA,GAA/D,EAAoE;AAChEsI,uBAAErH,IAAF,CAAO,iBAAP;AACA,yBAAI0H,KAAKkf,IAAT,EAAe;AACXvf,2BAAErH,IAAF,CAAO,cAAe,CAACjB,IAAI,CAAL,IAAU,EAAzB,GAA+B,QAAtC;AACH,sBAFD,MAEO;AACHsI,2BAAErH,IAAF,CAAO,6CAAP;AACH;AACDqH,uBAAErH,IAAF,CAAO8mB,GAAGxU,IAAIvT,CAAP,IAAY,WAAnB;AACH;AACDsI,mBAAErH,IAAF,CAAO,OAAP;AACH;AACJ;AACDqH,WAAErH,IAAF,CAAO,UAAP;AACAyO,aAAIhC,UAAJ,CAAe8E,IAAf,CAAoB,CAApB,EAAuBM,KAAvB,CAA6B,CAA7B,EAAgCpR,SAAhC,GAA4C4G,EAAEc,IAAF,CAAO,EAAP,CAA5C;;AAEAsG,aAAIhC,UAAJ,CAAe8E,IAAf,CAAoB,CAApB,EAAuBM,KAAvB,CAA6B,CAA7B,EAAgCpF,UAAhC,CAA2CA,UAA3C,CAAsDhM,SAAtD,GAAmEmmB,OAAO,CAAR,GAAa,GAAb,IAAoB,IAAIC,OAAJ,IAAejS,KAAKE,IAAL,CAAUgS,GAAG5nB,MAAH,GAAY,EAAtB,CAAnC,CAAlE;;AAEA,aAAIyoB,MAAMlZ,IAAI0B,oBAAJ,CAAyB,GAAzB,CAAV;AACA,cAAK,IAAIpR,IAAI,CAAR,EAAW6oB,KAAKD,IAAIzoB,MAAzB,EAAiCH,IAAI6oB,EAArC,EAAyC7oB,GAAzC,EAA8C;AAC1C4oB,iBAAI5oB,CAAJ,EAAOyN,YAAP,GAAsB,IAAtB;AACH;AACJ,MA1BG;AA2BA,SAAIqb,kBAAkB,SAAlBA,eAAkB,CAAUxkB,CAAV,EAAa;AACnC,aAAId,KAAK8O,IAAIrM,SAAJ,CAAc3B,EAAE4B,MAAhB,EAAwB,GAAxB,CAAT;AACA,aAAI1C,EAAJ,EAAQ;AACJkW,+BAAkBnV,cAAlB,CAAiC2B,MAAjC,EAAyC1C,GAAG0K,SAAH,CAAa+E,SAAtD;AACAtV,kBAAK0D,IAAL;AACH;AACDiD,WAAEgB,cAAF;AACH,MAPG;;AASA,SAAI2iB,qBAAqB,SAArBA,kBAAqB,GAAY;AACrC,aAAIzkB,KAAKwkB,aAAavkB,QAAb,CAAsBoF,aAAtB,CAAoC,KAApC,CAAT;AACArF,YAAG9B,SAAH,GAAeF,IAAf;AACAkO,eAAMlM,GAAGkK,UAAT;AACAgC,aAAIrD,KAAJ,CAAU8b,OAAV,GAAoB,MAApB;AACA,aAAIY,OAAOrZ,IAAIhC,UAAJ,CAAe8E,IAAf,CAAoB,CAApB,EAAuBM,KAAvB,CAA6B,CAA7B,CAAX;AAAA,aACMkW,OAAOtZ,IAAIhC,UAAJ,CAAe8E,IAAf,CAAoB,CAApB,EAAuBM,KAAvB,CAA6B,CAA7B,CADb;AAAA,aAEMmW,OAAOvZ,IAAIhC,UAAJ,CAAe8E,IAAf,CAAoB,CAApB,EAAuBM,KAAvB,CAA6B,CAA7B,EAAgC5E,SAF7C;AAGAoV,YAAGlc,gBAAH,CAAoB2hB,IAApB,EAA0B,WAA1B,EAAuCprB,KAAKmH,QAA5C;AACAwe,YAAGlc,gBAAH,CAAoB2hB,IAApB,EAA0B,WAA1B,EAAuCzF,GAAGnV,oBAA1C;AACAmV,YAAGlc,gBAAH,CAAoB2hB,IAApB,EAA0B,WAA1B,EAAuCzF,GAAG2B,qBAA1C;AACA3B,YAAGlc,gBAAH,CAAoB4hB,IAApB,EAA0B,WAA1B,EAAuCrrB,KAAKoH,QAA5C;AACAue,YAAGlc,gBAAH,CAAoB4hB,IAApB,EAA0B,WAA1B,EAAuC1F,GAAGnV,oBAA1C;AACAmV,YAAGlc,gBAAH,CAAoB4hB,IAApB,EAA0B,WAA1B,EAAuC1F,GAAG2B,qBAA1C;AACA3B,YAAGlc,gBAAH,CAAoB6hB,IAApB,EAA0B,WAA1B,EAAuCtrB,KAAK+qB,aAA5C;AACApF,YAAGlc,gBAAH,CAAoB6hB,IAApB,EAA0B,WAA1B,EAAuC3F,GAAGnV,oBAA1C;AACAmV,YAAGlc,gBAAH,CAAoB6hB,IAApB,EAA0B,WAA1B,EAAuC3F,GAAG2B,qBAA1C;AACQvV,aAAIjC,YAAJ,GAAmB,IAAnB;AACR,aAAImb,MAAMlZ,IAAI0B,oBAAJ,CAAyB,GAAzB,CAAV;AACA,cAAK,IAAIpR,IAAI,CAAR,EAAW6oB,KAAKD,IAAIzoB,MAAzB,EAAiCH,IAAI6oB,EAArC,EAAyC7oB,GAAzC,EAA8C;AAC1C4oB,iBAAI5oB,CAAJ,EAAOyN,YAAP,GAAsB,IAAtB;AACH;;AAED6V,YAAGlc,gBAAH,CAAoBsI,GAApB,EAAyB,WAAzB,EAAsCoZ,eAAtC;AACH,MAxBG;AAyBP,EA3JS,EAAV;;SA6JS1nB,G,GAAAA,G","file":"virtkeys.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f27134300cdee02fba61","import { isUndefined, isFunction, isString, isNumber, isNumeric, isArray, isRegExp, isBoolean, isScalar, isEmpty,\r\n    getScriptQuery } from './extensions/helpers';\r\nimport './extensions/ext/array';\r\nimport './extensions/ext/object';\r\nimport './extensions/ext/regexp';\r\nimport './extensions/ext/string';\r\n\r\nimport { DocumentCookie } from './extensions/documentcookie';\r\nimport { DocumentSelection } from './extensions/documentselection';\r\nimport { DOM } from './extensions/dom';\r\nimport { EM } from './extensions/eventmanager';\r\nimport { ScriptQueue } from './extensions/scriptqueue';\r\nimport { IME } from './ime';\r\n\r\n\r\nconst VirtualKeyboard = new function () {\r\n    var self = this;\r\n    self.$VERSION$ = \"3.6.1.585\";\r\n\r\n    \r\n    var options = {\r\n        'layout': null\r\n    }\r\n    \r\n    var idPrefix = 'kb_b';\r\n    \r\n    var animate = true;\r\n    \r\n    var controlKeys = {\r\n        14: 'backspace'\r\n        , 15: 'tab'\r\n        , 28: 'enter'\r\n        , 29: 'caps'\r\n        , 41: 'shift_left'\r\n        , 52: 'shift_right'\r\n        , 53: 'del'\r\n        , 54: 'ctrl_left'\r\n        , 55: 'alt_left'\r\n        , 56: 'space'\r\n        , 57: 'alt_right'\r\n        , 58: 'ctrl_right'\r\n    };\r\n    \r\n    var KEY = {\r\n        'SHIFT': 'shift'\r\n        , 'ALT': 'alt'\r\n        , 'CTRL': 'ctrl'\r\n        , 'CAPS': 'caps'\r\n    }\r\n    \r\n    var keymap;\r\n\r\n    \r\n    var keymaps = {\r\n        'QWERTY Standard': \"1234567890m=QWERTYUIOPASDFGHJKL;ZXCVBNM\"\r\n        , 'QWERTY Canadian': \"1234567890m=QWERTYUIOPASDFGHJKL;ZXCVBNM\"\r\n        , 'QWERTY Dutch': \"1234567890QWERTYUIOP;ASDFGHJKL=ZXCVBNMm\"\r\n        , 'QWERTY Estonian': \"1234567890m=QWERTYUIOPASDFGHJKL;ZXCVBNM\"\r\n        , 'QWERTY Greek (220)': \"1234567890QWERTYUIOP=ASDFGHJKL;ZXCVBNMm\"\r\n        , 'QWERTY Greek (319)': \"1234567890=QWERTYUIOPASDFGHJKL;ZXCVBNMm\"\r\n        , 'QWERTY Gujarati': \"1234567890m=XQWERTYUIOPASDFGHJKL;ZXCVBNM\"\r\n        , 'QWERTY Italian': \"1234567890QWERTYUIOP;=ASDFGHJKLZXCVBNMm\"\r\n        , 'QWERTY Kannada': \"1234567890m=ZQWERTYUIOPASDFGHJKL;ZXCVBNM\"\r\n        , 'QWERTY Portuguese': \"1234567890QWERTYUIOP=;ASDFGHJKLZXCVBNMm\"\r\n        , 'QWERTY Scandinavian': \"1234567890=QWERTYUIOP;ASDFGHJKLZXCVBNMm\"\r\n        , 'QWERTY Spanish': \"1234567890mQWERTYUIOP;ASDFGHJKLZXCVBNM\"\r\n        , 'QWERTY Tamil': \"1234567890m =ZQWERTYUIOPASDFGHJKL;CVBNM \"\r\n        , 'QWERTY Turkish': \"1234567890mQWERTYUIOPASDFGHJKL;ZXCVBNM\"\r\n        , 'QWERTY UK': \"1234567890m=QWERTYUIOPASDFGHJKL;ZXCVBNM\"\r\n        , 'QWERTZ Albanian': \"1234567890m=QWERTZUIOPASDFGHJKL;YXCVBNM\"\r\n        , 'QWERTZ Bosnian': \"1234567890=QWERTZUIOPASDFGHJKL;YXCVBNMm\"\r\n        , 'QWERTZ Czech': \"1234567890=QWERTZUIOPASDFGHJKL;YXCVBNMm\"\r\n        , 'QWERTZ German': \"1234567890QWERTZUIOP;=ASDFGHJKLYXCVBNMm\"\r\n        , 'QWERTZ Hungarian': \"0123456789=QWERTZUIOPASDFGHJKL;YXCVBNMm\"\r\n        , 'QWERTZ Slovak': \"1234567890QWERTZUIOPASDFGHJKL;YXCVBNMm\"\r\n        , 'QWERTZ Swiss': \"1234567890QWERTZUIOP;ASDFGHJKLYXCVBNMm\"\r\n        , 'AZERTY Belgian': \"1234567890mAZERTYUIOP;QSDFGHJKLMWXCVBN=\"\r\n        , 'AZERTY French': \"1234567890=AZERTYUIOP;QSDFGHJKLMWXCVBN\"\r\n        , ',WERTY Bulgarian': \"1234567890mWERTYUIOPASDFGHJKL;ZXCVBNMQ\"\r\n        , 'QGJRMV Latvian': \"1234567890mFQGJRMVNZWXYH;USILDATECBKPO\"\r\n        , '/,.PYF UK-Dvorak': \"m1234567890PYFGCRL=AOEUIDHTNS;QJKXBMWVZ\"\r\n        , 'FG;IOD Turkish F': \"1234567890=mXFG;IODRNHPQWUEATKMLYJVCZSB\"\r\n        , ';QBYUR US-Dvorak': \"7PFMLJ4321;QBYURSO65=mKCDTHEAZ8XGVWNI09\"\r\n        , '56Q.OR US-Dvorak': \"m1234JLMFP56QORSUYB;=78ZAEHTDCK90XINWVG\"\r\n    }\r\n    \r\n    var mode = 0\r\n        , VK_NORMAL = 0\r\n        , VK_SHIFT = 1\r\n        , VK_ALT = 2\r\n        , VK_CTRL = 4\r\n        , VK_CAPS = 8\r\n        , VK_CTRL_CAPS = VK_CTRL | VK_CAPS\r\n        , VK_CTRL_SHIFT = VK_CTRL | VK_SHIFT\r\n        , VK_ALT_CAPS = VK_ALT | VK_CAPS\r\n        , VK_ALT_CTRL = VK_ALT | VK_CTRL\r\n        , VK_ALT_CTRL_CAPS = VK_ALT | VK_CTRL | VK_CAPS\r\n        , VK_ALT_SHIFT = VK_ALT | VK_SHIFT\r\n        , VK_SHIFT_ALT_CTRL = VK_SHIFT | VK_ALT | VK_CTRL\r\n        , VK_SHIFT_CAPS = VK_SHIFT | VK_CAPS\r\n        , VK_ALL = VK_SHIFT | VK_ALT | VK_CTRL | VK_CAPS;\r\n    \r\n    var cssClasses = {\r\n        'buttonUp': 'kbButton'\r\n        , 'buttonDown': 'kbButtonDown'\r\n        , 'buttonHover': 'kbButtonHover'\r\n        , 'hoverShift': 'hoverShift'\r\n        , 'hoverAlt': 'hoverAlt'\r\n        , 'modeAlt': 'modeAlt'\r\n        , 'modeAltCaps': 'modeAltCaps'\r\n        , 'modeCaps': 'modeCaps'\r\n        , 'modeNormal': 'modeNormal'\r\n        , 'modeShift': 'modeShift'\r\n        , 'modeShiftAlt': 'modeShiftAlt'\r\n        , 'modeShiftAltCaps': 'modeShiftAltCaps'\r\n        , 'modeShiftCaps': 'modeShiftCaps'\r\n        , 'charNormal': 'charNormal'\r\n        , 'charShift': 'charShift'\r\n        , 'charAlt': 'charAlt'\r\n        , 'charShiftAlt': 'charShiftAlt'\r\n        , 'charCaps': 'charCaps'\r\n        , 'charShiftCaps': 'charShiftCaps'\r\n        , 'hiddenAlt': 'hiddenAlt'\r\n        , 'hiddenCaps': 'hiddenCaps'\r\n        , 'hiddenShift': 'hiddenShift'\r\n        , 'hiddenShiftCaps': 'hiddenShiftCaps'\r\n        , 'deadkey': 'deadKey'\r\n        , 'noanim': 'VK_no_animate'\r\n\r\n    }\r\n    \r\n    var lang = null;\r\n    \r\n    var layout = []\r\n    \r\n    layout.hash = {};\r\n    \r\n    layout.codes = {};\r\n    \r\n    layout.codeFilter = null;\r\n    \r\n    layout.options = null;\r\n\r\n    \r\n    var nodes = {\r\n        keyboard: null    \r\n        , desk: null        \r\n        , langbox: null     \r\n        , attachedInput: null// Field, keyboard attached to\r\n    }\r\n    \r\n    var newKeyCode = null;\r\n\r\n    \r\n    \r\n    self.addLayoutList = function () {\r\n        for (var i = 0, aL = arguments.length; i < aL; i++) {\r\n            self.addLayout(arguments[i]);\r\n        }\r\n    }\r\n\r\n    \r\n    self.addLayout = function (l) {\r\n\r\n        var code = l.code.entityDecode().split(\"-\")\r\n            , name = l.name.entityDecode()\r\n            , alpha = __doParse(l.normal)\r\n\r\n        if (!isArray(alpha) || 47 != alpha.length) throw new Error('VirtualKeyboard requires \\'keys\\' property to be an array with 47 items, ' + alpha.length + ' detected. Layout code: ' + code + ', layout name: ' + name);\r\n\r\n        \r\n        l.code = (code[1] || code[0]);\r\n        l.name = name;\r\n        l.normal = alpha;\r\n        l.domain = code[0];\r\n\r\n        \r\n        if (layout.hash.hasOwnProperty(l.code + \" \" + l.name))\r\n            return;\r\n\r\n        \r\n        if (!layout.codes.hasOwnProperty(l.code))\r\n            layout.codes[l.code] = l.code;\r\n\r\n        \r\n        l.toString = function () { return this.code + \" \" + this.name };\r\n\r\n        layout.push(l);\r\n\r\n        \r\n        layout.options = null;\r\n    }\r\n    \r\n    self.switchLayout = function (code) {\r\n        \r\n        __buildOptionsList();\r\n\r\n        if (!layout.options.hasOwnProperty(code)) return false;\r\n\r\n        \r\n        self.IME.hide();\r\n\r\n        \r\n        nodes.langbox.options[layout.options[code]].selected = true;\r\n\r\n        lang = layout[layout.hash[code]];\r\n        if (!isArray(lang)) lang = layout[layout.hash[code]] = __prepareLayout(lang);\r\n\r\n        if (!isArray(lang)) {\r\n            lang = layout[layout.hash[code]] = __prepareLayout(lang);\r\n        }\r\n        if (!lang.html) {\r\n            lang.html = __getKeyboardHtml(lang);\r\n        }\r\n        \r\n        nodes.desk.innerHTML = lang.html;\r\n\r\n        \r\n        nodes.keyboard.className = lang.domain\r\n        self.IME.css = lang.domain\r\n\r\n        \r\n        mode = VK_NORMAL;\r\n        __updateLayout();\r\n        \r\n        if (isFunction(lang.activate)) {\r\n            lang.activate();\r\n        }\r\n        \r\n        __toggleInputDir();\r\n        \r\n        DocumentCookie.set('vk_layout', code)\r\n        return true;\r\n    }\r\n\r\n    \r\n    self.getLayouts = function () {\r\n        var lts = [];\r\n        for (var i = 0, lL = layout.length; i < lL; i++) {\r\n            lts[lts.length] = [layout[i].code, layout[i].name];\r\n        }\r\n        return lts.sort();\r\n    }\r\n    \r\n    self.setVisibleLayoutCodes = function () {\r\n        var codes = isArray(arguments[0]) ? arguments[0] : arguments\r\n            , filter = null\r\n            , code\r\n\r\n        for (var i = 0, cL = codes.length; i < cL; i++) {\r\n            code = codes[i].toUpperCase();\r\n            if (!layout.codes.hasOwnProperty(code))\r\n                continue;\r\n            if (!filter)\r\n                filter = {}\r\n            filter[code] = code;\r\n        }\r\n        layout.codeFilter = filter;\r\n\r\n        \r\n        layout.options = null;\r\n\r\n        if (!self.switchLayout(nodes.langbox.value)) {\r\n            \r\n            self.switchLayout(nodes.langbox.value);\r\n        }\r\n    }\r\n    \r\n    self.getLayoutCodes = function () {\r\n        var codes = [];\r\n        for (var i in layout.codes) {\r\n            if (!layout.codes.hasOwnProperty(i))\r\n                continue;\r\n            codes.push(i);\r\n        }\r\n        return codes.heapSort();\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    var _keyClicker_ = function (key, evt) {\r\n        var chr = \"\"\r\n            , ret = false;\r\n        key = key.replace(idPrefix, \"\");\r\n        switch (key) {\r\n            case KEY.CAPS:\r\n            case KEY.SHIFT:\r\n            case \"shift_left\":\r\n            case \"shift_right\":\r\n            case KEY.ALT:\r\n            case \"alt_left\":\r\n            case \"alt_right\":\r\n                return true;\r\n            case 'backspace':\r\n                \r\n                if (isFunction(lang.charProcessor) && DocumentSelection.getSelection(nodes.attachedInput).length) {\r\n                    chr = \"\\x08\";\r\n                } else if (evt) {\r\n                    self.IME.hide(true);\r\n                    return true;\r\n                } else {\r\n                    DocumentSelection.deleteAtCursor(nodes.attachedInput, false);\r\n                    self.IME.hide(true);\r\n                }\r\n                break;\r\n            case 'del':\r\n                self.IME.hide(true);\r\n                if (evt)\r\n                    return true;\r\n                DocumentSelection.deleteAtCursor(nodes.attachedInput, true);\r\n                break;\r\n            case 'space':\r\n                chr = \" \";\r\n                break;\r\n            case 'tab':\r\n                chr = \"\\t\";\r\n                break;\r\n            case 'enter':\r\n                chr = \"\\n\";\r\n                break;\r\n            default:\r\n                var el = document.getElementById(idPrefix + key);\r\n                chr = lang[key][mode];\r\n                break;\r\n        }\r\n        if (chr) {\r\n            \r\n            if (!(chr = __charProcessor(chr, DocumentSelection.getSelection(nodes.attachedInput)))) return ret;\r\n            \r\n            try {\r\n                \r\n                if (chr[1] || chr[0].length > 1 || chr.charCodeAt(0) > 0x7fff || nodes.attachedInput.contentDocument || '\\t' == chr[0]) {\r\n                    throw new Error;\r\n                }\r\n                var ck = chr[0].charCodeAt(0);\r\n                \r\n                if (isFunction(document.createEvent)) {\r\n                    var evt = null;\r\n                    try {\r\n                        evt = document.createEvent(\"KeyEvents\");\r\n                        evt.initKeyEvent('keypress', false, true, nodes.attachedInput.contentWindow, false, false, false, false, 0, ck);\r\n                    } catch (ex) {\r\n                        \r\n                        evt = document.createEvent(\"KeyboardEvents\");\r\n                        evt.initKeyEvent('keypress', false, true, nodes.attachedInput.contentWindow, false, false, false, false, ck, 0);\r\n                    }\r\n                    evt.VK_bypass = true;\r\n                    nodes.attachedInput.dispatchEvent(evt);\r\n                } else {\r\n                    evt.keyCode = 10 == ck ? 13 : ck;\r\n                    ret = true;\r\n                }\r\n            } catch (e) {\r\n                DocumentSelection.insertAtCursor(nodes.attachedInput, chr[0]);\r\n                \r\n                if (chr[1]) {\r\n                    DocumentSelection.setRange(nodes.attachedInput, -chr[1], 0, true);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    \r\n    var _keydownHandler_ = function (e) {\r\n        \r\n        if (!self.isOpen()) return;\r\n        \r\n        var newMode = mode;\r\n        \r\n        var keyCode = e.getKeyCode();\r\n        switch (e.type) {\r\n            case 'keydown':\r\n                switch (keyCode) {\r\n                    case 37:\r\n                        if (self.IME.isOpen()) {\r\n                            self.IME.prevPage(e);\r\n                            return;\r\n                        }\r\n                        break;\r\n                    case 39:\r\n                        if (self.IME.isOpen()) {\r\n                            self.IME.nextPage(e);\r\n                            return;\r\n                        }\r\n                        break;\r\n                    case 8:\r\n                    case 9:\r\n                    case 46:\r\n                        var el = nodes.desk.childNodes[keymap[keyCode]];\r\n                        \r\n                        if (animate && !e.getRepeat()) DOM.CSS(el).addClass(cssClasses.buttonDown);\r\n                        if (!_keyClicker_(el.id, e)) e.preventDefault();\r\n\r\n                        break;\r\n                    case 20:\r\n                        if (!e.getRepeat()) {\r\n                            newMode = newMode ^ VK_CAPS;\r\n                        }\r\n                        break;\r\n                    case 27:\r\n                        if (self.IME.isOpen()) {\r\n                            self.IME.hide();\r\n                        } else {\r\n                            var start = DocumentSelection.getStart(nodes.attachedInput);\r\n                            DocumentSelection.setRange(nodes.attachedInput, start, start);\r\n                        }\r\n                        return false;\r\n                    default:\r\n                        if (!e.getRepeat()) {\r\n                            newMode = newMode | e.shiftKey | e.ctrlKey << 2 | e.altKey << 1;\r\n                        }\r\n                        if (keymap.hasOwnProperty(keyCode)) {\r\n                            if (!(e.altKey ^ e.ctrlKey)) {\r\n                                var el = nodes.desk.childNodes[keymap[keyCode]];\r\n                                if (animate) DOM.CSS(el).addClass(cssClasses.buttonDown);\r\n                                \r\n                                newKeyCode = el.id;\r\n                            }\r\n                            if (e.altKey && e.ctrlKey) {\r\n                                e.preventDefault();\r\n                                \r\n                                if (e.srcElement) {\r\n                                    _keyClicker_(nodes.desk.childNodes[keymap[keyCode]].id, e)\r\n                                    newKeyCode = \"\";\r\n                                }\r\n                            }\r\n                        } else {\r\n                            self.IME.hide();\r\n                        }\r\n                        break;\r\n                }\r\n                break;\r\n            case 'keyup':\r\n                switch (keyCode) {\r\n                    case 20:\r\n                        break;\r\n                    default:\r\n                        if (!e.getRepeat()) {\r\n                            newMode = mode & (VK_ALL ^ (!e.shiftKey | (!e.ctrlKey << 2) | (!e.altKey << 1)));\r\n                        }\r\n                        if (animate && keymap.hasOwnProperty(keyCode)) {\r\n                            DOM.CSS(nodes.desk.childNodes[keymap[keyCode]]).removeClass(cssClasses.buttonDown);\r\n                        }\r\n                }\r\n                break;\r\n            case 'keypress':\r\n                \r\n                if (newKeyCode && !e.VK_bypass) {\r\n                    if (!_keyClicker_(newKeyCode, e)) {\r\n                        e.stopPropagation();\r\n                        \r\n                        e.preventDefault();\r\n                    }\r\n                    \r\n                    newKeyCode = null;\r\n                }\r\n                if (!mode ^ VK_ALT_CTRL && (e.altKey || e.ctrlKey)) {\r\n                    self.IME.hide();\r\n                }\r\n                if (0 == keyCode && !newKeyCode && !e.VK_bypass \r\n                    && (!e.ctrlKey && !e.altKey && !e.shiftKey) \r\n                ) {\r\n                    e.preventDefault();\r\n                }\r\n        }\r\n        \r\n        if (newMode != mode) {\r\n            __updateControlKeys(newMode);\r\n            __updateLayout();\r\n        }\r\n    }\r\n    \r\n    var _btnClick_ = function (e) {\r\n        \r\n        var el = DOM.getParent(e.srcElement || e.target, 'a');\r\n        \r\n        if (!el || el.parentNode.id.indexOf(idPrefix) < 0) return;\r\n        el = el.parentNode;\r\n\r\n        switch (el.id.substring(idPrefix.length)) {\r\n            case \"caps\":\r\n            case \"shift_left\":\r\n            case \"shift_right\":\r\n            case \"alt_left\":\r\n            case \"alt_right\":\r\n            case \"ctrl_left\":\r\n            case \"ctrl_right\":\r\n                return;\r\n        }\r\n\r\n        if (DOM.CSS(el).hasClass(cssClasses.buttonDown) || !animate) {\r\n            _keyClicker_(el.id);\r\n        }\r\n        if (animate) {\r\n            DOM.CSS(el).removeClass(cssClasses.buttonDown)\r\n        }\r\n\r\n        var newMode = mode & (VK_CAPS | e.shiftKey | e.altKey << 1 | e.ctrlKey << 2);\r\n        if (mode != newMode) {\r\n            __updateControlKeys(newMode);\r\n            __updateLayout();\r\n        }\r\n\r\n    }\r\n    \r\n    var _btnMousedown_ = function (e) {\r\n        \r\n        var el = DOM.getParent(e.srcElement || e.target, 'a');\r\n        \r\n        if (!el || el.parentNode.id.indexOf(idPrefix) < 0) return;\r\n        el = el.parentNode;\r\n\r\n        var newMode = mode;\r\n\r\n        var key = el.id.substring(idPrefix.length);\r\n        switch (key) {\r\n            case \"caps\":\r\n                newMode = newMode ^ VK_CAPS;\r\n                break;\r\n            case \"shift_left\":\r\n            case \"shift_right\":\r\n                \r\n                if (e.shiftKey) break;\r\n                newMode = newMode ^ VK_SHIFT;\r\n                break;\r\n            case \"alt_left\":\r\n            case \"alt_right\":\r\n            case \"ctrl_left\":\r\n            case \"ctrl_right\":\r\n                newMode = newMode ^ (e.altKey << 1 ^ VK_ALT) ^ (e.ctrlKey << 2 ^ VK_CTRL);\r\n                break;\r\n            \r\n            default:\r\n                if (animate) DOM.CSS(el).addClass(cssClasses.buttonDown)\r\n                break;\r\n        }\r\n\r\n        if (mode != newMode) {\r\n            __updateControlKeys(newMode);\r\n            __updateLayout();\r\n        }\r\n\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    }\r\n    \r\n    var _btnMouseInOut_ = function (e) {\r\n        \r\n        var el = DOM.getParent(e.srcElement || e.target, 'a')\r\n            , mtd = { 'mouseover': 2, 'mouseout': 3 }\r\n        \r\n        if (!el || el.parentNode.id.indexOf(idPrefix) < 0) return;\r\n        el = el.parentNode;\r\n\r\n        \r\n        if (el.id.indexOf('shift') > -1) {\r\n            \r\n            __toggleControlKeysState(mtd[e.type], KEY.SHIFT);\r\n        } else if (el.id.indexOf('alt') > -1 || el.id.indexOf('ctrl') > -1) {\r\n            \r\n            __toggleControlKeysState(mtd[e.type], KEY.CTRL);\r\n            __toggleControlKeysState(mtd[e.type], KEY.ALT);\r\n        } else if (el.id.indexOf('caps') > -1) {\r\n            __toggleKeyState(mtd[e.type], null, el.id);\r\n        } else if (animate) {\r\n            __toggleKeyState(mtd[e.type], null, el.id);\r\n            if ('mouseout' == e.type.toLowerCase()) {\r\n                \r\n                __toggleKeyState(0, null, el.id);\r\n            }\r\n        }\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    }\r\n\r\n    \r\n    var switchMapping = function (e) {\r\n        DocumentCookie.set('vk_mapping', e.target.value);\r\n        keymap = keymaps[e.target.value];\r\n    }\r\n    \r\n    \r\n    self.attachInput = function (el) {\r\n        \r\n        if (!el) return nodes.attachedInput;\r\n        if (isString(el)) el = document.getElementById(el);\r\n\r\n        if (el == nodes.attachedInput) return nodes.attachedInput;\r\n\r\n        \r\n        if (!self.switchLayout(options.layout) && !self.switchLayout(nodes.langbox.value)) {\r\n            \r\n            throw new Error('No layouts available');\r\n        }\r\n\r\n        \r\n        self.detachInput();\r\n\r\n        if (!el || !el.tagName) {\r\n            nodes.attachedInput = null;\r\n        } else {\r\n\r\n            \r\n            animate = !DOM.CSS(el).hasClass(cssClasses.noanim);\r\n            \r\n            nodes.attachedInput = el;\r\n            \r\n            __toggleInputDir();\r\n            if (el.contentWindow) {\r\n                el = el.contentWindow.document.body.parentNode;\r\n            }\r\n            EM.addEventListener(el, 'keydown', _keydownHandler_);\r\n            EM.addEventListener(el, 'keyup', _keydownHandler_);\r\n            EM.addEventListener(el, 'keypress', _keydownHandler_);\r\n            EM.addEventListener(el, 'mousedown', self.IME.blurHandler);\r\n        }\r\n        return nodes.attachedInput;\r\n    }\r\n\r\n    \r\n    self.detachInput = function () {\r\n        if (!nodes.attachedInput) return false;\r\n        \r\n        __toggleInputDir(true);\r\n        \r\n        self.IME.hide();\r\n        \r\n        if (nodes.attachedInput) {\r\n            var oe = nodes.attachedInput\r\n            if (oe.contentWindow) {\r\n                oe = oe.contentWindow.document.body.parentNode\r\n            }\r\n            EM.removeEventListener(oe, 'keydown', _keydownHandler_);\r\n            EM.removeEventListener(oe, 'keypress', _keydownHandler_);\r\n            EM.removeEventListener(oe, 'keyup', _keydownHandler_);\r\n            EM.removeEventListener(oe, 'mousedown', self.IME.blurHandler);\r\n        }\r\n        nodes.attachedInput = null;\r\n        return true;\r\n    }\r\n\r\n    \r\n    self.getAttachedInput = function (el) {\r\n        return nodes.attachedInput;\r\n    }\r\n    \r\n    self.open =\r\n        self.show = function (input, holder, kpTarget) {\r\n            if (!(input = self.attachInput(nodes.attachedInput || input)) || !nodes.keyboard || !document.body) return false;\r\n\r\n            \r\n            if (!nodes.keyboard.parentNode || nodes.keyboard.parentNode.nodeType == 11) {\r\n                if (isString(holder)) holder = document.getElementById(holder);\r\n                if (!holder.appendChild) return false;\r\n                holder.appendChild(nodes.keyboard);\r\n                \r\n                if (!isUndefined(kpTarget) && input != kpTarget && kpTarget.appendChild) {\r\n                    EM.addEventListener(kpTarget, 'keydown', _keydownHandler_);\r\n                    EM.addEventListener(kpTarget, 'keyup', _keydownHandler_);\r\n                    EM.addEventListener(kpTarget, 'keypress', _keydownHandler_);\r\n                }\r\n            }\r\n\r\n            return true;\r\n        }\r\n    \r\n    self.close =\r\n        self.hide = function () {\r\n            if (!nodes.keyboard || !self.isOpen()) return false;\r\n            self.detachInput();\r\n            nodes.keyboard.parentNode.removeChild(nodes.keyboard);\r\n            return true;\r\n        }\r\n    \r\n    self.toggle = function (input, holder, kpTarget) {\r\n        self.isOpen() ? self.close() : self.show(input, holder, kpTarget);\r\n    }\r\n    \r\n    self.isOpen = function ()  {\r\n        return (!!nodes.keyboard.parentNode) && nodes.keyboard.parentNode.nodeType == 1;\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    var __toggleInputDir = function (reset) {\r\n        if (nodes.attachedInput) {\r\n            var mode = reset ? \"\"\r\n                : (lang.rtl ? 'rtl'\r\n                    : 'ltr');\r\n            if (nodes.attachedInput.contentWindow)\r\n                nodes.attachedInput.contentWindow.document.body.dir = mode;\r\n            else\r\n                nodes.attachedInput.dir = mode;\r\n        }\r\n    }\r\n\r\n    \r\n    var __buildOptionsList = function () {\r\n        if (null != layout.options)\r\n            return;\r\n\r\n        var s = layout.heapSort()\r\n            , l, o, n\r\n            , cc = {};\r\n        layout.options = {};\r\n\r\n        nodes.langbox.innerHTML = \"\";\r\n        for (var i = 0, sL = s.length, z = 0; i < sL; i++) {\r\n            l = layout[i];\r\n            n = l.code + \" \" + l.name;\r\n            layout.hash[n] = i;\r\n\r\n            if (layout.codeFilter && !layout.codeFilter.hasOwnProperty(l.code))\r\n                continue;\r\n\r\n            if (cc.label != l.code) {\r\n                cc = document.createElement('optgroup');\r\n                cc.label = l.code;\r\n                nodes.langbox.appendChild(cc);\r\n            }\r\n            o = document.createElement('option');\r\n            o.value = n;\r\n            o.appendChild(document.createTextNode(l.name));\r\n            o.label = l.name;\r\n            cc.appendChild(o);\r\n            \r\n            layout.options[n] = z++;\r\n        }\r\n    }\r\n    \r\n    var __doParse = function (s) {\r\n        if (isString(s))\r\n            return s.match(/\\x01.+?\\x01|[\\ud800-\\udbff][\\udc00-\\udfff]|./g).map(function (a) { return a.replace(/[\\x01\\x02]/g, \"\") });\r\n        else\r\n            return s.map(function (a) { return isArray(a) ? a.map(function (s) { String.fromCharCodeExt(s) }).join(\"\") : String.fromCharCodeExt(a).replace(/[\\x01\\x02]/g, \"\") });\r\n    }\r\n    \r\n    var __prepareLayout = function (l) {\r\n        \r\n        var alpha = l.normal\r\n            , shift = l.shift || {}\r\n            , alt = l.alt || {}\r\n            , shift_alt = l.shift_alt || {}\r\n            , caps = l.caps || {}\r\n            , shift_caps = l.shift_caps || {}\r\n            , dk = l.dk\r\n            , cbk = l.cbk\r\n            , cs, ca, csa, cc, csc = null\r\n            , ics, ica, icsa, icc, icsc = -1\r\n            , lt = []\r\n\r\n        lt.name = l.name;\r\n        lt.code = l.code;\r\n        lt.toString = l.toString;\r\n\r\n        for (var i = 0, aL = alpha.length; i < aL; i++) {\r\n            var char_normal = alpha[i]\r\n                , char_alt = null\r\n                , char_caps = null\r\n                , char_shift = null\r\n                , char = [char_normal]\r\n\r\n            if (shift.hasOwnProperty(i)) {\r\n                cs = __doParse(shift[i]);\r\n                ics = i;\r\n            }\r\n            if (ics > -1 && cs[i - ics]) {\r\n                char_shift = cs[i - ics];\r\n                char[VK_SHIFT] = char_shift;\r\n            } else if (char_normal && char_normal != (char_normal = char_normal.toUpperCase())) {\r\n                char[VK_SHIFT] = char_normal;\r\n                char_shift = char_normal;\r\n            }\r\n\r\n            if (alt.hasOwnProperty(i)) {\r\n                ca = __doParse(alt[i]);\r\n                ica = i;\r\n            }\r\n            if (ica > -1 && ca[i - ica]) {\r\n                char_alt = ca[i - ica];\r\n                char[VK_ALT_CTRL] = char_alt;\r\n            }\r\n\r\n            if (shift_alt.hasOwnProperty(i)) {\r\n                csa = __doParse(shift_alt[i]);\r\n                icsa = i;\r\n            }\r\n            if (icsa > -1 && csa[i - icsa]) {\r\n                char[VK_SHIFT_ALT_CTRL] = csa[i - icsa];\r\n            } else if (char_alt && char_alt != (char_alt = char_alt.toUpperCase())) {\r\n                char[VK_SHIFT_ALT_CTRL] = char_alt;\r\n            }\r\n\r\n            if (caps.hasOwnProperty(i)) {\r\n                cc = __doParse(caps[i]);\r\n                icc = i;\r\n            }\r\n            if (icc > -1 && cc[i - icc]) {\r\n                char_caps = cc[i - icc];\r\n            }\r\n            if (char_caps) {\r\n                char[VK_CAPS] = char_caps;\r\n            } else if (char_shift && char_shift.toUpperCase() != char_shift.toLowerCase()) {\r\n                char[VK_CAPS] = char_shift;\r\n            } else if (char_normal) {\r\n                char[VK_CAPS] = char_normal.toUpperCase();\r\n            }\r\n\r\n            if (shift_caps.hasOwnProperty(i)) {\r\n                csc = __doParse(shift_caps[i]);\r\n                icsc = i;\r\n            }\r\n            if (icsc > -1 && csc[i - icsc]) {\r\n                char[VK_SHIFT_CAPS] = csc[i - icsc];\r\n            } else if (char_shift) {\r\n                char[VK_SHIFT_CAPS] = char_shift.toLowerCase();\r\n            } else if (char_normal) {\r\n                char[VK_SHIFT_CAPS] = char_normal;\r\n            }\r\n\r\n            lt[i] = char;\r\n        }\r\n\r\n        if (dk) {\r\n            lt.dk = {};\r\n            for (var i in dk) {\r\n                if (dk.hasOwnProperty(i)) {\r\n                    var key = i;\r\n                    if (parseInt(i) && i > 9) {\r\n                        key = String.fromCharCode(i);\r\n                    }\r\n                    \r\n                    lt.dk[key] = __doParse(dk[i]).join(\"\").replace(key, key + key);\r\n                }\r\n            }\r\n        }\r\n\r\n        \r\n        lt.rtl = !!lt.join(\"\").match(/[\\u05b0-\\u06ff]/)\r\n\r\n        \r\n        lt.domain = l.domain\r\n\r\n        \r\n        if (isFunction(cbk)) {\r\n            lt.charProcessor = cbk\r\n        } else if (cbk) {\r\n            lt.activate = cbk.activate;\r\n            lt.charProcessor = cbk.charProcessor;\r\n        }\r\n        return lt;\r\n    }\r\n    \r\n    var __updateLayout = function () {\r\n        var ca = [];\r\n        ca[VK_NORMAL] = cssClasses.modeNormal;\r\n        ca[VK_SHIFT] = cssClasses.modeShift;\r\n        ca[VK_ALT_CTRL] = cssClasses.modeAlt;\r\n        ca[VK_SHIFT_ALT_CTRL] = cssClasses.modeShiftAlt;\r\n        ca[VK_CAPS] = cssClasses.modeCaps;\r\n        ca[VK_SHIFT_CAPS] = cssClasses.modeShiftCaps;\r\n       \r\n        ca[VK_ALT] = cssClasses.modeNormal;\r\n        ca[VK_CTRL] = cssClasses.modeNormal;\r\n        ca[VK_ALT_SHIFT] = cssClasses.modeShift;\r\n        ca[VK_CTRL_SHIFT] = cssClasses.modeShift;\r\n        ca[VK_ALT_CAPS] = cssClasses.modeCaps;\r\n        ca[VK_CTRL_CAPS] = cssClasses.modeCaps;\r\n       \r\n        ca[VK_ALT_CTRL_CAPS] = cssClasses.modeShiftAltCaps;\r\n        ca[VK_ALL] = cssClasses.modeShiftAltCaps;\r\n\r\n        DOM.CSS(nodes.desk).removeClass(ca).addClass(ca[mode]);\r\n    }\r\n    \r\n    var __updateControlKeys = function (newMode) {\r\n        \r\n        var changes = mode ^ newMode;\r\n        if (changes & VK_SHIFT) {\r\n            __toggleControlKeysState(!!(newMode & VK_SHIFT), KEY.SHIFT);\r\n        }\r\n        if (changes & VK_ALT) {\r\n            __toggleControlKeysState(!!(newMode & VK_ALT), KEY.ALT);\r\n        }\r\n        if (changes & VK_CTRL) {\r\n            __toggleControlKeysState(!!(newMode & VK_CTRL), KEY.CTRL);\r\n        }\r\n        if (changes & VK_CAPS) {\r\n            __toggleKeyState(!!(newMode & VK_CAPS), KEY.CAPS);\r\n        }\r\n        mode = newMode;\r\n    }\r\n    \r\n    var __toggleControlKeysState = function (state, prefix) {\r\n        var s1 = document.getElementById(idPrefix + prefix + '_left')\r\n            , s2 = document.getElementById(idPrefix + prefix + '_right');\r\n        switch (0 + state) {\r\n            case 0:\r\n                s1.className = DOM.CSS(s2).removeClass(cssClasses.buttonDown).getClass();\r\n                break;\r\n            case 1:\r\n                DOM.CSS(nodes.desk).removeClass([cssClasses.hoverShift, cssClasses.hoverAlt]);\r\n                s1.className = DOM.CSS(s2).addClass(cssClasses.buttonDown).getClass();\r\n                break;\r\n            case 2:\r\n                if (KEY.SHIFT == prefix && mode & VK_SHIFT ^ VK_SHIFT) {\r\n                    DOM.CSS(nodes.desk).addClass(cssClasses.hoverShift);\r\n                } else if (KEY.ALT == prefix && mode ^ VK_ALT_CTRL) {\r\n                    DOM.CSS(nodes.desk).addClass(cssClasses.hoverAlt);\r\n                }\r\n                s1.className = DOM.CSS(s2).addClass(cssClasses.buttonHover).getClass();\r\n                break;\r\n            case 3:\r\n                if (KEY.SHIFT == prefix) {\r\n                    DOM.CSS(nodes.desk).removeClass(cssClasses.hoverShift);\r\n                } else if (KEY.ALT == prefix) {\r\n                    DOM.CSS(nodes.desk).removeClass(cssClasses.hoverAlt);\r\n                }\r\n                s1.className = DOM.CSS(s2).removeClass(cssClasses.buttonHover).getClass();\r\n                break;\r\n        }\r\n    }\r\n    \r\n    var __toggleKeyState = function (state, suffix, name) {\r\n        var s = document.getElementById(suffix ? idPrefix + suffix\r\n            : name);\r\n        if (s) {\r\n            switch (0 + state) {\r\n                case 0:\r\n                    DOM.CSS(s).removeClass(cssClasses.buttonDown);\r\n                    break;\r\n                case 1:\r\n                    DOM.CSS(s).addClass(cssClasses.buttonDown);\r\n                    break;\r\n                case 2:\r\n                    DOM.CSS(s).addClass(cssClasses.buttonHover);\r\n                    break;\r\n                case 3:\r\n                    DOM.CSS(s).removeClass(cssClasses.buttonHover);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    \r\n    var __charProcessor = function (tchr, buf) {\r\n        var res = [tchr, 0];\r\n        if (isFunction(lang.charProcessor)) {\r\n            \r\n            res = lang.charProcessor(tchr, buf);\r\n        } else if (tchr == \"\\x08\") {\r\n            res = ['', 0];\r\n        } else if (lang.dk && buf.length <= 1) {\r\n            \r\n            if (lang.dk.hasOwnProperty(buf)) {\r\n                \r\n                res[1] = 0;\r\n                var dks = lang.dk[buf],\r\n                idx = dks.indexOf(tchr) + 1;\r\n                res[0] = idx ? dks.charAt(idx)\r\n                    : tchr;\r\n            } else if (lang.dk.hasOwnProperty(tchr)) {\r\n                \r\n                res[1] = 1;\r\n                res[0] = tchr;\r\n            }\r\n        }\r\n        return res;\r\n    }\r\n    \r\n    var __getKeyboardHtml = function (lang) {\r\n        var inp = document.createElement('span');\r\n        \r\n        document.body.appendChild(inp);\r\n        inp.style.position = 'absolute';\r\n        inp.style.left = '-1000px';\r\n\r\n        for (var i = 0, aL = lang.length, btns = [], chr, title; i < aL; i++) {\r\n            chr = lang[i];\r\n            btns.push([\"<div id='\", idPrefix, i\r\n                , \"' class='\", cssClasses.buttonUp\r\n                , \"'><a>\", __getCharHtmlForKey(lang, chr, VK_NORMAL, cssClasses.charNormal, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_SHIFT, cssClasses.charShift, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_ALT_CTRL, cssClasses.charAlt, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_SHIFT_ALT_CTRL, cssClasses.charShiftAlt, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_CAPS, cssClasses.charCaps, inp)\r\n                , __getCharHtmlForKey(lang, chr, VK_SHIFT_CAPS, cssClasses.charShiftCaps, inp)\r\n                , \"</a></div>\"].join(\"\"));\r\n\r\n        }\r\n        for (var i in controlKeys) {\r\n            if (controlKeys.hasOwnProperty(i)) {\r\n                chr = controlKeys[i];\r\n                title = chr.replace(/_.+/, '');\r\n                btns.splice(i, 0, [\"<div id='\", idPrefix, chr\r\n                    , \"' class='\", cssClasses.buttonUp\r\n                    , \"'><a title='\", title, \"'\"\r\n                    , \"><span class='title'>\", title, \"</span>\"\r\n                    , \"</a></div>\"].join(\"\"));\r\n            }\r\n        }\r\n        document.body.removeChild(inp);\r\n        return btns.join(\"\").replace(/(<\\w+)/g, \"$1 unselectable='on' \");\r\n    }\r\n    \r\n    var __getCharHtmlForKey = function (lyt, chr, mode, css, inp) {\r\n        var html = []\r\n            , dk = lyt.dk && lyt.dk.hasOwnProperty(chr[mode])\r\n            , char = chr[mode] || \"\"\r\n\r\n        \r\n        if (dk) css += \" \" + cssClasses.deadkey;\r\n\r\n        \r\n        if ((mode == VK_SHIFT_CAPS && chr[VK_CAPS] && char.toLowerCase() == chr[VK_CAPS].toLowerCase())\r\n            || (mode == VK_CAPS && chr[VK_SHIFT_CAPS] && char.toLowerCase() == chr[VK_SHIFT_CAPS].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenCaps;\r\n        }\r\n        if ((mode == VK_SHIFT && chr[VK_NORMAL] && char.toLowerCase() == chr[VK_NORMAL].toLowerCase())\r\n            || (mode == VK_NORMAL && chr[VK_SHIFT] && char.toLowerCase() == chr[VK_SHIFT].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenShift;\r\n        }\r\n        if ((mode == VK_SHIFT && chr[VK_SHIFT_CAPS] && char.toLowerCase() == chr[VK_SHIFT_CAPS].toLowerCase())\r\n            || (mode == VK_SHIFT_CAPS && chr[VK_SHIFT] && char.toLowerCase() == chr[VK_SHIFT].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenShiftCaps;\r\n        }\r\n        if ((mode == VK_CAPS && chr[VK_NORMAL] && char.toLowerCase() == chr[VK_NORMAL].toLowerCase())\r\n            || (mode == VK_NORMAL && chr[VK_CAPS] && char.toLowerCase() == chr[VK_CAPS].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenCaps;\r\n        }\r\n        if ((mode == VK_SHIFT_ALT_CTRL && chr[VK_ALT_CTRL] && char.toLowerCase() == chr[VK_ALT_CTRL].toLowerCase())\r\n            || (mode == VK_ALT_CTRL && chr[VK_SHIFT] && char.toLowerCase() == chr[VK_SHIFT].toLowerCase())) {\r\n            css += \" \" + cssClasses.hiddenAlt;\r\n        }\r\n\r\n        html.push(\"<span\");\r\n        if (css) {\r\n            html.push(\" class=\\\"\" + css + \"\\\"\");\r\n        }\r\n        html.push(\" >\\xa0\" + char + \"\\xa0</span>\");\r\n        return html.join(\"\");\r\n    }\r\n        \r\n        ; (function () {\r\n            \r\n            nodes.keyboard = document.createElement('div');\r\n            nodes.keyboard.unselectable = \"on\";\r\n            nodes.keyboard.id = 'virtualKeyboard';\r\n            nodes.keyboard.innerHTML = (\"<div id=\\\"kbDesk\\\"><!-- --></div>\"\r\n                + \"<select id=\\\"kb_langselector\\\"></select>\"\r\n                + \"<select id=\\\"kb_mappingselector\\\"></select>\"\r\n                + '<div id=\"copyrights\" nofocus=\"true\"><a href=\"http://debugger.ru/projects/virtualkeyboard\" target=\"_blank\" title=\"&copy;2006-2009 Debugger.ru\">VirtualKeyboard ' + self.$VERSION$ + '</a></div>'\r\n            ).replace(/(<\\w+)/g, \"$1 unselectable='on' \");\r\n\r\n            nodes.desk = nodes.keyboard.firstChild;\r\n\r\n            var el = nodes.keyboard.childNodes.item(1);\r\n            EM.addEventListener(el, 'change', function (e) { self.switchLayout(this.value) });\r\n            nodes.langbox = el;\r\n\r\n            var el = el.nextSibling\r\n                , mapGroup = \"\";\r\n\r\n            keymap = DocumentCookie.get('vk_mapping');\r\n\r\n            if (!keymaps.hasOwnProperty(keymap))\r\n                keymap = 'QWERTY Standard';\r\n\r\n            for (var i in keymaps) {\r\n                var map = keymaps[i].split(\"\").map(function (c) { return c.charCodeAt(0) });\r\n                \r\n                map.splice(14, 0, 8, 9);\r\n                map.splice(28, 0, 13, 20);\r\n                map.splice(41, 0, 16);\r\n                map.splice(52, 0, 16, 46, 17, 18, 32, 18, 17);\r\n                \r\n                var tk = map;\r\n                map = [];\r\n                for (var z = 0, kL = tk.length; z < kL; z++) {\r\n                    map[tk[z]] = z;\r\n                }\r\n                keymaps[i] = map;\r\n\r\n                \r\n                tk = i.split(\" \", 2);\r\n                if (mapGroup.indexOf(mapGroup = tk[0]) != 0) {\r\n                    el.appendChild(document.createElement('optgroup'))\r\n                    el.lastChild.label = mapGroup;\r\n                }\r\n                map = document.createElement('option');\r\n                el.lastChild.appendChild(map);\r\n                map.value = i;\r\n                map.innerHTML = tk[1];\r\n                map.selected = (i == keymap);\r\n            }\r\n            keymap = keymaps[keymap];\r\n            EM.addEventListener(el, 'change', switchMapping);\r\n\r\n            \r\n            EM.addEventListener(nodes.desk, 'mousedown', _btnMousedown_);\r\n            EM.addEventListener(nodes.desk, 'mouseup', _btnClick_);\r\n            EM.addEventListener(nodes.desk, 'mouseover', _btnMouseInOut_);\r\n            EM.addEventListener(nodes.desk, 'mouseout', _btnMouseInOut_);\r\n            EM.addEventListener(nodes.desk, 'click', EM.preventDefaultAction);\r\n\r\n            \r\n            nodes.keyboard.onmousedown = function (e) { if (!e || !e.target.tagName || 'select' != e.target.tagName.toLowerCase()) return false }\r\n\r\n            \r\n            var opts = getScriptQuery('virtualkeyboard.js');\r\n            options.layout = DocumentCookie.get('vk_layout') || opts.vk_layout || null;\r\n        })();\r\n}\r\n\r\nVirtualKeyboard.Langs = {};\r\n\r\nVirtualKeyboard.IME = IME;\r\n\r\n\r\n(function ($) {\r\n    $.fn.virtkeys = function () {\r\n        this.VirtualKeyboard = VirtualKeyboard;\r\n\r\n        this.open = _open;\r\n        this.close = _close;\r\n        this.toggle = _toggle;\r\n\r\n        this.getLayoutCodes = _getLayoutCodes;\r\n        this.switchLayout = _switchLayout;\r\n        this.addLayouts = _addLayouts;\r\n        this.getLoadedLayouts = _getLoadedLayouts;\r\n\r\n        this.enableIME = _enableIME;\r\n        this.addIMELanguages = _addIMELanguages;\r\n\r\n\r\n        function _open (input) {\r\n            VirtualKeyboard.open(input instanceof $ ? input.get(0) : input, this.get(0));\r\n        }\r\n\r\n        function _close () {\r\n            VirtualKeyboard.close();\r\n        }\r\n\r\n        function _toggle (input) {\r\n            VirtualKeyboard.toggle(input instanceof $ ? input.get(0) : input, this.get(0));\r\n        }\r\n\r\n       \r\n        function _getLayoutCodes() {\r\n            return VirtualKeyboard.getLayoutCodes();\r\n        }\r\n\r\n        function _switchLayout(code) {\r\n            return VirtualKeyboard.switchLayout(code);\r\n        }\r\n\r\n        function _addLayouts(layouts) {\r\n            for (var i = 0, aL = layouts.length; i < aL; i++) {\r\n                VirtualKeyboard.addLayout(layouts[i]);\r\n            }\r\n        }\r\n\r\n        function _getLoadedLayouts() {\r\n            return $.fn.virtkeys._layouts;\r\n        }\r\n\r\n        function _enableIME(ime) {\r\n            if (ime === undefined && (ime = $.fn.virtkeys._ime) === undefined)\r\n                throw 'Object containing IME cannot be found.';\r\n\r\n            VirtualKeyboard.IME = ime;\r\n        }\r\n\r\n        function _addIMELanguages(langs) {\r\n            if (langs === undefined && (langs = $.fn.virtkeys._langs) === undefined)\r\n                throw 'Object containing IME languages cannot be found.';\r\n\r\n            VirtualKeyboard.Langs = langs;\r\n        }\r\n\r\n        return this;\r\n    };\r\n\r\n    $.fn.virtkeys._layouts = {};\r\n} (jQuery));\n\n\n// WEBPACK FOOTER //\n// ./src/virtualkeyboard.js","\r\n\r\n\r\n\r\n\r\nfunction isUndefined(prop )  {\r\n    return (typeof prop == 'undefined');\r\n}\r\n\r\nfunction isFunction(prop )  {\r\n    return (typeof prop == 'function');\r\n}\r\n\r\nfunction isString(prop )  {\r\n    return (typeof prop == 'string');\r\n}\r\n\r\nfunction isNumber(prop )  {\r\n    return (typeof prop == 'number');\r\n}\r\n\r\nfunction isNumeric(prop )  {\r\n    return (isNumber(prop) || isString(prop)) && !isNaN(parseInt(prop)) && isFinite(parseInt(prop));\r\n}\r\n\r\nfunction isArray(prop )  {\r\n    return (prop instanceof Array);\r\n}\r\n\r\nfunction isRegExp(prop )  {\r\n    return (prop instanceof RegExp);\r\n}\r\n\r\nfunction isBoolean(prop )  {\r\n    return ('boolean' == typeof prop);\r\n}\r\n\r\nfunction isScalar(prop )  {\r\n    return isNumeric(prop) || isString(prop) || isBoolean(prop);\r\n}\r\n\r\nfunction isEmpty(prop )  {\r\n    if (isBoolean(prop)) return false;\r\n    if (isRegExp(prop) && new RegExp(\"\").toString() == prop.toString()) return true;\r\n    if (isString(prop) || isNumber(prop)) return !prop;\r\n    if (Boolean(prop) && false != prop) {\r\n        for (var i in prop) if (prop.hasOwnProperty(i)) return false\r\n    }\r\n    return true;\r\n}\r\n\r\n\r\n\r\n\r\nfunction gluePath()  {\r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n   \r\n    throw 'Commented out because of UglifyJsPlugin and RemoveCommentsLoader';\r\n}\r\n\r\n\r\nfunction findPath(sname )  {\r\n    var h = document.getElementsByTagName('html')[0].innerHTML\r\n        , sr = new RegExp('<scr' + 'ipt[^>]+?src\\s*=\\s*[\"\\']?([^>]+?/)' + sname + '[^>]*>.?</scr' + 'ipt>', 'i')\r\n        , m = h.match(sr);\r\n    if (m) {\r\n        \r\n        if (m[1].match(/^((https?|file)\\:\\/{2,}|\\w:[\\\\])/)) return m[1];\r\n        \r\n        if (m[1].indexOf(\"/\") == 0) return m[1];\r\n        b = document.getElementsByTagName('base');\r\n        if (b[0] && b[0].href) return b[0].href + m[1];\r\n        \r\n        return (document.location.href.match(/(.*[\\/\\\\])/)[0] + m[1]).replace(/^\\/+/, \"\");\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction getScriptQuery(sname) {\r\n    var h = document.getElementsByTagName('html')[0].innerHTML\r\n        , sr = new RegExp('<scr' + 'ipt[^>]+?src\\s*[^>]+?/' + sname + '([^#\"\\']*).+?</scr' + 'ipt>', 'i')\r\n        , m = h.match(sr);\r\n    if (m) return parseQuery(m[1].replace(/^[^?]*\\?([^#]+)/, \"$1\"));\r\n    return {};\r\n}\r\n\r\nfunction parseQuery(q) {\r\n    if ('string' != typeof q || q.length < 2) return {};\r\n    q = q.split(/&amp;|&/g);\r\n    for (var z = 0, qL = q.length, rs = {}, kv, rkv; z < qL; z++) {\r\n        kv = q[z].split(\"=\");\r\n        \r\n        kv[0] = kv[0].replace(/[{}\\[\\]]*$/, \"\");\r\n        rkv = rs[kv[0]];\r\n        \r\n        kv[1] = unescape(kv[1] ? kv[1].replace(\"+\", \" \") : \"\");\r\n        if (rkv)\r\n            if ('array' == typeof (rkv)) rs[kv[0]][rs[kv[0]].length] = kv[1];\r\n            else rs[kv[0]] = [rs[kv[0]], kv[1]];\r\n        else rs[kv[0]] = kv[1];\r\n    }\r\n    return rs\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction table2array(id, ci, section, subsection) {\r\n    if (isString(id)) id = document.getElementById(id);\r\n    if (!id || !DOM.hasTagName(id, ['table', 'tbody,', 'thead', 'tfoot'])) return null;\r\n    if (!isEmpty(section) && (!isString(section) || !(id = id.getElementsByTagName(section)))) return null;\r\n    if (!isEmpty(subsection) && (!isNumber(subsection) || subsection < 0 || !(id = id[subsection]))) return null;\r\n\r\n    if (isUndefined(id.rows)) return null;\r\n    var res = []\r\n        , span = document.createElement('span')\r\n        , ts = null\r\n        , ce = null\r\n    for (var i = 0, rL = id.rows.length; i < rL; i++) {\r\n        var tr = [];\r\n        if (isArray(ci)) {\r\n            for (var z = 0, cL = ci.length; z < cL; z++) {\r\n                ce = id.rows[i].cells[ci[z]];\r\n                if (ce) {\r\n                    span.innerHTML = ce.innerText ? ce.innerText : ce.innerHTML.replace(/<script\\s+(.|\\r?\\n)*?<\\/script>|<[^>]*>/g, \"\");\r\n                    span.normalize();\r\n                    tr[tr.length] = span.firstChild ? span.firstChild.nodeValue.trim(\" \\xA0\") : \"\";\r\n                } else {\r\n                    tr[tr.length] = \"\";\r\n                }\r\n            }\r\n        } else {\r\n            for (var z = 0, tL = id.rows[i].cells.length; z < tL; z++) {\r\n                cd = id.rows[i].cells[z];\r\n                span.innerHTML = ce.innerText ? ce.innerText : ce.innerHTML.replace(/<script\\s+(.|\\r?\\n)*?<\\/script>|<[^>]*>/g, \"\");\r\n                span.normalize();\r\n                tr[tr.length] = span.firstChild ? span.firstChild.nodeValue.trim(\" \\xA0\") : \"\";\r\n            }\r\n        }\r\n        if (!isEmpty(tr)) res[res.length] = tr;\r\n    }\r\n    return res;\r\n}\r\n\r\n\r\ndocument.createElementExt = function (tag , p )  {\r\n    var L, i, k, el = document.createElement(tag);\r\n    if (!el) return null;\r\n    for (i in p) {\r\n        if (!p.hasOwnProperty(i)) continue;\r\n        switch (i) {\r\n            case \"class\": el.setAttribute('className', p[i]); el.setAttribute('class', p[i]); break;\r\n            case \"style\": for (k in p[i]) { if (!p[i].hasOwnProperty(k)) continue; el.style[k] = p[i][k]; } break;\r\n            case \"event\": for (k in p[i]) { if (!p[i].hasOwnProperty(k)) continue; el.attachEvent(k, p[i][k]); } break;\r\n            case \"child\": L = p[i].length; for (k = 0; k < L; k++) el.appendChild(p[i][k]); break;\r\n            case \"param\": for (k in p[i]) { if (!p[i].hasOwnProperty(k)) continue; try { el[k] = p[i][k] } catch (e) { } } break;\r\n        }\r\n    }\r\n    return el;\r\n}\r\n\r\n\r\nfunction playInterval(f , i , o )  { return setInterval(function () { (o instanceof Array) ? f.apply(this, o) : f.call(this, o) }, i) }\r\nfunction playTimeout(f , i , o )  { return setTimeout(function () { (o instanceof Array) ? f.apply(this, o) : f.call(this, o) }, i) }\r\n\r\n\r\nfunction cloneObject(obj) {\r\n    if (isScalar(obj) || isFunction(obj) || null == obj) return obj;\r\n    try { var newObject = new obj.constructor(); } catch (e) { return null; }\r\n    if (isArray(newObject)) {\r\n        for (var i = 0, oL = obj.length; i < oL; i++) {\r\n            newObject[i] = cloneObject(obj[i]);\r\n        }\r\n    } else {\r\n        for (var i in obj) {\r\n            if (!obj.hasOwnProperty(i)) continue;\r\n            newObject[i] = cloneObject(obj[i]);\r\n        }\r\n    }\r\n    return newObject;\r\n}\r\n\r\n\r\nfunction mergeObject() {\r\n    var res = {}\r\n        , oi\r\n        , obj\r\n    for (var z = 0, aL = arguments.length; z < aL; z++) {\r\n        obj = arguments[z];\r\n        for (var i in obj) {\r\n            if (!obj.hasOwnProperty(i)) continue;\r\n            oi = obj[i];\r\n            if (null == oi) {\r\n                if (!res.hasOwnProperty(i)) res[i] = oi;\r\n            } else if (isArray(oi)) {\r\n                if (isArray(res[i]))\r\n                    res[i] = res[i].concat(oi).unique();\r\n                else\r\n                    res[i] = oi.slice(0);\r\n            } else if (isScalar(oi) || isFunction(oi)) {\r\n                res[i] = oi;\r\n            } else {\r\n                if (res.hasOwnProperty(i))\r\n                    res[i] = mergeObject(res[i], oi)\r\n                else\r\n                    res[i] = cloneObject(oi);\r\n            }\r\n        }\r\n    }\r\n    return res;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction loadStyleSheet(sn) {\r\n    if (!hasStyleSheet(sn)) {\r\n        var head = document.getElementsByTagName('head')[0]\r\n            , link = document.createElement('link');\r\n        link.rel = 'stylesheet';\r\n        link.type = 'text/css';\r\n        link.href = sn;\r\n        head.appendChild(link);\r\n    }\r\n}\r\n\r\n\r\nfunction hasStyleSheet(path) {\r\n    var h = document.getElementsByTagName('html')[0].innerHTML\r\n        , sr = new RegExp('<link[^>]+?src\\s*=\\s*[\"\\']?([^>]+?/)' + sn + '[^>]*>', 'i');\r\n    return sr.test(h);\r\n}\r\n\r\nexport {\r\n    isUndefined, isFunction, isString, isNumber, isNumeric, isArray, isRegExp, isBoolean, isScalar, isEmpty,\r\n    gluePath, findPath, getScriptQuery, parseQuery,\r\n    table2array, playInterval, playTimeout, cloneObject, mergeObject, loadStyleSheet, hasStyleSheet\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/helpers.js","import { isUndefined } from './../helpers';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nif (isUndefined(Array.prototype.copy)) {\r\n    Array.prototype.copy = function () {\r\n        var copy = new Array();\r\n        for (var i = 0, tL = this.length; i < tL; i++) {\r\n            copy[i] = this[i];\r\n        }\r\n        return copy;\r\n    };\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nif (isUndefined(Array.prototype.unique)) {\r\n    \r\n    Array.prototype.unique = function ()  {\r\n        var tmp = [];\r\n        for (var i = 0, tL = this.length; i < tL; i++) {\r\n            if (tmp.indexOf(this[i]) < 0) tmp[tmp.length] = this[i];\r\n        }\r\n        return tmp;\r\n    };\r\n}\r\n\r\nif (isUndefined(Array.prototype.flatten)) {\r\n    \r\n    Array.prototype.flatten = function (cols , cd)  {\r\n        if (this.length < 1) return [];\r\n        if (isNumeric(cols)) cols = [cols];\r\n        var idx = false;\r\n        if (isArray(cols)) {\r\n            idx = {};\r\n            for (var i = 0, cL = cols.length; i < cL; i++) idx[cols[i]] = true;\r\n        }\r\n        var tmp = [];\r\n        for (var i = 0, tL = this.length; i < tL; i++) {\r\n            if (isUndefined(this[i])) continue;\r\n            if (!isArray(this[i])) {\r\n                if (false === idx) tmp[tmp.length] = this[i];\r\n            } else {\r\n                for (var k = 0, cL = this[i].length; k < cL; k++) {\r\n                    if (false === idx || idx.hasOwnProperty(k)) tmp[tmp.length] = this[i][k];\r\n                }\r\n            }\r\n        }\r\n        return tmp;\r\n    };\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nif (isUndefined(Array.prototype.binSearch)) {\r\n    \r\n    Array.prototype.binSearch = function (el, key) {\r\n        var l = 0\r\n            , r = this.length\r\n            , len = Math.max(r - 1, 0)\r\n            , c = Math.ceil(r / 2)\r\n            , cnt = 0\r\n        if (null != key)\r\n            while ((!this[c] || el != this[c][key]) && r >= l) {\r\n                if (this[c] && el > this[c][key])\r\n                    l = c + 1\r\n                else\r\n                    r = c - 1\r\n                c = Math.max(0, Math.ceil((r + l) / 2))\r\n            }\r\n        else\r\n            while (el != this[c] && r >= l) {\r\n                if (el > this[c])\r\n                    l = c + 1\r\n                else\r\n                    r = c - 1\r\n                c = Math.max(0, Math.ceil((r + l) / 2));\r\n            }\r\n        return c\r\n    }\r\n}\r\n\r\nArray.prototype.heapSort = function () {\r\n\r\n   \r\n    \r\n    var sift = function (arr, low, up) {\r\n        var c, tmp = arr[low];\r\n\r\n        while (true) {\r\n            c = (low << 1) + 1;\r\n            if (c > up) break;\r\n            if (c < up && arr[c + 1] > arr[c]) c++;\r\n            if (tmp >= arr[c]) break;\r\n            arr[low] = arr[c];\r\n            low = c;\r\n        }\r\n        arr[low] = tmp;\r\n    },\r\n        tmp,\r\n        maximal = this.length - 1,\r\n        i = maximal >> 1;\r\n\r\n    while (i >= 0)\r\n        sift(this, i--, maximal);\r\n\r\n    i = maximal;\r\n    while (i > 0) {\r\n       \r\n        tmp = this[0];\r\n        this[0] = this[i];\r\n        this[i] = tmp;\r\n        sift(this, 0, --i);\r\n    }\r\n    return this;\r\n}\r\n\r\n\r\n\r\nif (isUndefined(Array.range)) {\r\n    \r\n    Array.range = function (end , start , inc )  {\r\n        if (!isNumber(end)) return null;\r\n        if (!isNumber(inc)) inc = 1;\r\n        if (!isNumber(start)) start = 0;\r\n        var tmp = []\r\n            , mn = Math.min(start, end)\r\n            , mx = Math.max(start, end)\r\n            , i = Math.abs(inc)\r\n            , cnt = -1;\r\n        do {\r\n            cnt++;\r\n            tmp[cnt] = mn;\r\n            mn += i;\r\n        } while (mn <= mx);\r\n        return inc > 0 ? tmp : tmp.reverse();\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/ext/array.js","\r\nif ('undefined' == typeof Object.hasOwnProperty) {\r\n  Object.prototype.hasOwnProperty = function (prop) {\r\n    return !('undefined' == typeof this[prop] || this.constructor && this.constructor.prototype[prop] && this[prop] === this.constructor.prototype[prop]);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/ext/object.js","\r\n\r\nRegExp.escape = function escape (text )  {\r\n  if (!escape.sRE) {\r\n    var specials = [\r\n      '/', '.', '*', '+', '?', '|',\r\n      '(', ')', '[', ']', '{', '}', '$', '^', '\\\\'\r\n    ];\r\n    escape.sRE = new RegExp(\r\n      '(\\\\' + specials.join('|\\\\') + ')', 'g'\r\n    );\r\n  }\r\n  return isString(text)?text.replace(escape.sRE, '\\\\$1')\r\n                       :(isArray(text)?text.map(RegExp.escape).join(\"|\")\r\n                                      :\"\");\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/ext/regexp.js","\r\n\r\nString.fromCharCodeExt = function(code) {\r\n    if (code<0x10000) {\r\n        return String.fromCharCode(code);\r\n    }\r\n    code -= 0x10000;\r\n    return String.fromCharCode(code >>10 | 0xD800)+String.fromCharCode(code & 0x3FF | 0xDC00)\r\n}\r\n\r\nString.prototype.entityDecode = function entityDecode() {\r\n    if (!entityDecode.span) entityDecode.span = document.createElement('span');\r\n    var s = entityDecode.span;\r\n    s.innerHTML = this;\r\n    return s.firstChild?s.firstChild.nodeValue:\"\";\r\n}\r\n\r\n\r\nString.prototype.ltrim = function(c) {\r\n    if (isString(c)) c=c.split(\"\");\r\n    if (isArray(c) || isUndefined(c)) {\r\n        c = isEmpty(c)?\"\\\\s\":RegExp.escape(c); \r\n        c = new RegExp(\"^(?:\"+c+\")+\", \"g\");\r\n        return this.replace(c, \"\");\r\n    }\r\n    return this; \r\n}\r\n\r\nString.prototype.rtrim = function(c) {\r\n    if (isString(c)) c=c.split(\"\");\r\n    if (isArray(c) || isUndefined(c)) {\r\n        c = isEmpty(c)?\"\\\\s\":RegExp.escape(c); \r\n        c = new RegExp(\"(?:\"+c+\")+$\", \"g\");\r\n        return this.replace(c, \"\");\r\n    }\r\n    return this; \r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nString.prototype.dup = function() {\r\n    var val = this.valueOf();\r\n    return [val,val].join(\"\");\r\n}\r\n\r\nString.prototype.repeat = function(n )  {\r\n    if (isNaN(n=parseInt(n)) || n<0) return \"\";\r\n    return Array(n+1).join(this.valueOf());\r\n}\r\n\r\nString.prototype.padding = function(n, c) {\r\n    var val = this.valueOf();\r\n    n = parseInt(n);\r\n    if (!n) return val;\r\n    if (isUndefined(c)) c = \" \";\r\n    var pad = String(c).charAt(0).repeat(Math.abs(n) - this.length);\r\n    return (n < 0) ? pad + val : val + pad;\r\n}\r\n\r\nString.prototype.padLeft = function(n, c) {\r\n    return this.padding(-Math.abs(n), c);\r\n}\r\n\r\nString.prototype.padRight = function(n, c) {\r\n    return this.padding(Math.abs(n), c);\r\n}\r\n\r\n\r\nString.prototype.sprintf = function() {\r\n    var args = isArray(arguments[0])?arguments[0]:arguments\r\n       ,index = 0\r\n       ,frmt = this.replace(/%%/g, \"\\0\\0\")\r\n       ,re = /%((?:\\d+\\$)?)((?:[-0+# ])?)((?:\\d+|\\*(?:\\d+\\$)?)?)((?:.(?:\\d+|\\*(?:\\d+\\$)?))?)([bcdeEfosuxX])/g;\r\n    \r\n    frmt = frmt.replace(re, function() {\r\n        var x = arguments\r\n           ,sign = false\r\n           ,ins;\r\n\r\n        \r\n        if (!isUndefined(x[3]) && x[3].indexOf(\"*\")==0) {\r\n            x[3] = parseInt(x[3].replace(/\\D/g,\"\"))\r\n            if (isNaN(x[3])) {\r\n              x[3] = args[index];\r\n              \r\n              index++;\r\n            } else {\r\n              x[3] = args[x[3]]  \r\n            }\r\n        }\r\n        \r\n        if (\"\" != x[4]) {\r\n            if (x[4].indexOf(\"*\")==1) {\r\n                x[4] = parseInt(x[4].replace(/\\D/g,\"\"))\r\n                if (isNaN(x[4])) {\r\n                  x[4] = args[index];\r\n                  \r\n                  index++;\r\n                } else {\r\n                  x[4] = args[x[4]]  \r\n                }\r\n            } else {\r\n                x[4] = x[4].replace(/\\D/,\"\")\r\n            }\r\n            x[4] = Math.abs(x[4]);\r\n        }\r\n           \r\n        x[1] = parseInt(x[1]);\r\n        var ins;\r\n        if (isNumeric(x[1])) {\r\n            ins = args[x[1]];\r\n        } else {\r\n            ins = args[index];\r\n            \r\n            index++;\r\n        }\r\n        switch (x[5]) {\r\n        case \"b\":\r\n            if (ins<0) ins = 0x10000000000000000+parseInt(ins);\r\n            ins = Number(ins).bin(x[4]);\r\n            if (x[4]) ins = ins.substr(0,x[4]);\r\n            if (x[2]=='#') ins = '0b'+ins;\r\n            break;\r\n        case \"c\":\r\n            ins = String.fromCharCode(ins);\r\n            break;\r\n        case \"u\":\r\n            ins = Math.abs(ins);  \r\n        case \"d\":\r\n            ins = Math.round(ins);       \r\n            if (ins<0) {\r\n                ins = \"-\"+Math.abs(ins).dec(x[4]);\r\n            } else {\r\n                ins = Number(ins).dec(x[4]);\r\n                sign = (x[2] == ' ' || x[2] == '+');\r\n            }\r\n            break;\r\n        case \"e\":\r\n        case \"E\":\r\n            if (ins>0) {\r\n                sign = (x[2] == ' ' || x[2] == '+');\r\n            }\r\n            ins = Number(ins).toExponential(x[4]?x[4]:6);\r\n            if (x[5]=='E') ins=ins.toUpperCase();\r\n            break;\r\n        case \"f\":\r\n            if (ins>0) {\r\n                sign = (x[2] == ' ' || x[2] == '+');\r\n            }\r\n            ins = Number(ins).toFixed(isNumeric(x[4])?x[4]:6);\r\n            break;\r\n        case \"o\":\r\n            if (ins<0) ins = 0x10000000000000000+parseInt(ins);\r\n            ins = Number(ins).toString(8);\r\n            if (x[4]) ins = ins.substr(0,x[4]);\r\n            if (x[2]=='#' && ins != 0) ins = '0'+ins;\r\n            break;\r\n        case \"s\":\r\n            ins = String(ins);\r\n            if (x[4]) ins = ins.substr(0,x[4]);\r\n            break;\r\n        case \"x\":\r\n        case \"X\":\r\n            if (ins<0) ins = 0x10000000000000000+parseInt(ins);\r\n            ins = Number(ins).hex(-x[4]);\r\n            if (x[4]) ins = ins.substr(0,x[4]);\r\n            if (x[2]=='#') ins = '0x'+ins;\r\n            if (x[5]=='X') ins = ins.toUpperCase();\r\n            break;\r\n        }\r\n        if (sign) ins = x[2]+ins;\r\n        if (x[3]) ins = (x[2]=='-' || x[3]<0)?ins.padRight(x[3]):ins.padLeft(x[3],x[2]=='0'?0:\" \");\r\n        return ins;\r\n    })\r\n    return frmt.replace(/\\0\\0/g, \"%\");\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/ext/string.js","\r\nconst DocumentCookie = new function () {\r\n    var self = this;\r\n    \r\n    var cookie = {};\r\n\r\n    \r\n    self.get = function (name) {\r\n        return cookie[name];\r\n    }\r\n\r\n    \r\n    self.set = function (name, value, expire, path, domain, secure) {\r\n        if (name) {\r\n            value = escape(value);\r\n            document.cookie = name + \"=\" + value\r\n                + (path ? \";path=\" + path\r\n                    : \"\")\r\n                + (expire ? \";NoExp=\" + ((expire instanceof Date) ? expire.toGMTString()\r\n                    : new Date(new Date().getTime() + expire * 1000).toGMTString())\r\n                    : \"\")\r\n                + (domain ? \";domain=\" + domain || document.location.domain\r\n                    : \"\")\r\n                + (secure ? \";secure\"\r\n                    : \"\");\r\n            cookie[name] = value;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    \r\n    self.isSet = function (name) {\r\n        return !!cookie[name];\r\n    }\r\n\r\n    \r\n    self.del = function (name, path, domain) {\r\n        if (Cookie.isSet(name)) {\r\n            document.cookie = name + \"=\"\r\n                + (path ? \"; path=\" + path : \"\")\r\n                + (domain ? \"; domain=\" + domain : \"\")\r\n                + (secure ? \"; secure\" : \"\")\r\n                + \"; NoExp=Thu, 01-Jan-70 00:00:01 GMT\";\r\n            delete cookie[name];\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    \r\n    self.delAll = function () {\r\n        for (var i in cookie) {\r\n            if (cookie.hasOwnProperty(i))\r\n                self.del(i);\r\n        }\r\n    }\r\n\r\n        ; (function () {\r\n            var p = document.cookie.split(/\\s*;\\s*/);\r\n            for (let i = 0, pL = p.length; i < pL; i++) {\r\n                var parts = p[i].split(/\\s*=\\s*/);\r\n                cookie[parts[0]] = unescape(parts[1]);\r\n            }\r\n        })()\r\n};\r\n\r\nexport { DocumentCookie };\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/documentcookie.js","import { DOM } from './dom';\r\n\r\n\r\n\r\nvar DocumentSelection = new function () {\r\n    var self = this;\r\n    \r\n    var keys = {\r\n        'prevCalcNode': '__prevCalcNode'\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    var callMethod = function (m, arg) {\r\n        var el = arg[0]\r\n            , id\r\n            , module = \"\"\r\n        if (!el || !el.tagName) return false;\r\n        switch (arg[0].tagName.toLowerCase()) {\r\n            case 'input':\r\n                if (el.type && el.type != 'text' && el.type != 'password') return false;\r\n            case 'textarea':\r\n                module = \"input\";\r\n                break;\r\n            case 'iframe':\r\n                module = \"frame\";\r\n                arg[0] = el.contentWindow;\r\n                break;\r\n            default:\r\n                return false;\r\n        }\r\n        \r\n        if ('function' == typeof self.module[module])\r\n            self.module[module] = new self.module[module](keys);\r\n        \r\n        if (!self.module[module] || !self.module[module][m])\r\n            throw new Error('Method \\'' + m + '\\' is not implemented for DocumentSelection \\'' + module + '\\' module.');\r\n\r\n        return self.module[module][m].apply(self, arg);\r\n    }\r\n    \r\n    var keepScroll = function (el, ot, ol) {\r\n        if (window.getSelection && 'iframe' != el.tagName.toLowerCase()) {\r\n            var q = self.getSelectionOffset(el)\r\n            if (el.contentWindow) el = el.contentWindow.document.body;\r\n\r\n            if (ot > q.y) el.scrollTop = q.y;\r\n            else if (ot + el.clientHeight > q.y) el.scrollTop = ot;\r\n            else el.scrollTop = q.y - el.clientHeight / 2;\r\n\r\n            if (ol > q.x) el.scrollLeft = q.x;\r\n            else if (ol + el.clientWidth > q.x) el.scrollLeft = ol;\r\n            else el.scrollLeft = q.x - el.clientWidth / 2;\r\n        }\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    self.setRange = function (el, start, end, related) {\r\n        var ot = el.scrollTop\r\n            , ol = el.scrollLeft\r\n        \r\n        if (related) {\r\n            var st = self.getStart(el);\r\n            end = st + end;\r\n            start = st + start;\r\n        }\r\n        if (start < 0) start = 0;\r\n        if (end < start) end = start;\r\n\r\n        callMethod('setRange', [el, start, end]);\r\n\r\n        keepScroll(el, ot, ol);\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    self.getSelection = function (el) {\r\n        return callMethod('getSelection', [el]);\r\n    }\r\n    \r\n    self.getStart = function (el) {\r\n        return callMethod('getPos', [el])[0];\r\n    }\r\n    \r\n    self.getEnd = function (el) {\r\n        return callMethod('getPos', [el])[0];\r\n    }\r\n    \r\n    self.getCursorPosition = function (el) {\r\n        return self.getStart(el);\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    self.insertAtCursor = function (el, val, keep) {\r\n        var ot = el.scrollTop\r\n            , ol = el.scrollLeft\r\n        if (!keep) {\r\n            callMethod('del', [el]);\r\n        }\r\n        var pos = callMethod('ins', [el, val]);\r\n        keepScroll(el, ot, ol);\r\n        return pos;\r\n    }\r\n    \r\n    self.wrapSelection = function (el, start, end) {\r\n        var s = self.getCursorPosition(el)\r\n            , e = self.getEnd(el)\r\n        if (s == e) {\r\n            self.insertAtCursor(el, start + end);\r\n        } else {\r\n            self.insertAtCursor(el, start, true);\r\n            self.setRange(el, e + start.length, e + start.length);\r\n            self.insertAtCursor(el, end, true);\r\n        }\r\n    }\r\n\r\n    \r\n    self.deleteAtCursor = function (el, after) {\r\n        if (!self.getSelection(el)) {\r\n            if (after)\r\n                self.setRange(el, 0, 1, true);\r\n            else\r\n                self.setRange(el, -1, 0, true);\r\n        }\r\n        return self.deleteSelection(el);\r\n    }\r\n    \r\n    self.deleteSelection = function (el) {\r\n        var ol = el.scrollLeft\r\n            , ot = el.scrollTop\r\n            , ret = callMethod('del', [el]);\r\n        keepScroll(el, ot, ol);\r\n        return ret;\r\n    }\r\n    \r\n    self.getSelectionOffset = function (el) {\r\n        return callMethod('getSelectionOffset', [el], true);\r\n    }\r\n    \r\n    self.getContext = function (el) {\r\n        return callMethod('getContext', [el]);\r\n    }\r\n};\r\nDocumentSelection.module = {\r\n    \r\n    'input': function (keys) {\r\n        var self = this;\r\n        \r\n        var offsetCalculator = null;\r\n        \r\n        self.getContext = function (el) {\r\n            var pos = self.getPos(el)\r\n                , val = el.value\r\n                , r1 = val.match(new RegExp(\"(?:.|[\\\\r\\\\n]){0,\" + (pos[0] - 1) + \"}(?:^|\\\\s)\", \"m\")) || \"\"\r\n                , r2 = val.match(new RegExp(\"(?:.|[\\\\r\\\\n]){\" + pos[0] + \"}\", \"m\"))[0]\r\n                , r3 = val.replace(r2, \"\")\r\n                , r4 = r3.substring(0, pos[1] - pos[0])\r\n                , r5 = (r3.replace(r4, \"\")).match(/(?:\\S|$)*/)\r\n            return [r2.replace(r1, \"\"), r4, r5];\r\n        }\r\n        \r\n        self.getPos = function (el) {\r\n            var pos = [0, 0];\r\n            if ('function' == typeof window.getSelection) {\r\n                try {\r\n                    pos = [el.selectionStart, el.selectionEnd];\r\n                } catch (e) {\r\n                }\r\n            } else {\r\n                el.setActive();\r\n                pos = [Math.abs(el.document.selection.createRange().moveStart(\"character\", -100000000))\r\n                    , Math.abs(el.document.selection.createRange().moveEnd(\"character\", -100000000))];\r\n                \r\n                if (el.tagName.toLowerCase() != 'input') {\r\n                    \r\n                    var r = el.document.body.createTextRange();\r\n                    r.moveToElementText(el);\r\n                    var sTest = Math.abs(r.moveStart(\"character\", -100000000));\r\n                    pos[0] -= sTest;\r\n                    pos[1] -= sTest;\r\n                }\r\n            }\r\n            return pos;\r\n        }\r\n        \r\n        self.del = function (el) {\r\n            var ret = \"\"\r\n                , p = self.getPos(el)\r\n                , s = p[0]\r\n                , e = p[1];\r\n            if (s != e) {\r\n                \r\n                var tmp = document.selection && !window.opera ? el.value.replace(/\\r/g, \"\") : el.value;\r\n                ret = tmp.substring(s, e);\r\n                el.value = tmp.substring(0, s) + tmp.substring(e, tmp.length);\r\n                self.setRange(el, s, s);\r\n            }\r\n            return ret;\r\n        }\r\n        \r\n        self.ins = function (el, val) {\r\n            var ret = \"\"\r\n                , s = self.getPos(el)[0]\r\n            \r\n            var tmp = document.selection && !window.opera ? el.value.replace(/\\r/g, \"\") : el.value;\r\n            el.value = tmp.substring(0, s) + val + tmp.substring(s, tmp.length);\r\n            s += val.length;\r\n            self.setRange(el, s, s);\r\n            return s;\r\n        }\r\n        \r\n        self.getSelection = function (el) {\r\n            var p = self.getPos(el)\r\n                , s = p[0]\r\n                , e = p[1];\r\n            \r\n            if (e < s) e = s;\r\n            \r\n            var tmp = document.selection && !window.opera ? el.value.replace(/\\r/g, \"\") : el.value;\r\n            return tmp.substring(s, e);\r\n        }\r\n        \r\n        self.setRange = function (el, start, end) {\r\n            if ('function' == typeof el.setSelectionRange) {\r\n                \r\n                try { el.setSelectionRange(start, end) } catch (e) { }\r\n            } else {\r\n                \r\n                var range;\r\n                \r\n                try {\r\n                    range = el.createTextRange();\r\n                } catch (e) {\r\n                    try {\r\n                        range = el.document.body.createTextRange();\r\n                        range.moveToElementText(el);\r\n                    } catch (e) {\r\n                        return false;\r\n                    }\r\n                }\r\n                el.setActive();\r\n                range.collapse(true);\r\n                range.moveStart(\"character\", start);\r\n                range.moveEnd(\"character\", end - start);\r\n                range.select();\r\n            }\r\n        }\r\n        \r\n        self.getSelectionOffset = function (el) {\r\n            var range\r\n                , doc = DOM.getWindow(el).document;\r\n            if ('function' == typeof el.setSelectionRange) {\r\n                \r\n                if (!offsetCalculator) {\r\n                    \r\n                    offsetCalculator = doc.createElement('td');\r\n\r\n                    doc.body.appendChild(offsetCalculator);\r\n                }\r\n                \r\n                if (offsetCalculator[keys.prevCalcNode] != el) {\r\n                    offsetCalculator[keys.prevCalcNode] = el;\r\n                    var cs = doc.defaultView.getComputedStyle(el, null);\r\n                    for (var i in cs) {\r\n                        try { if (cs[i]) offsetCalculator.style[i] = cs[i]; } catch (e) { }\r\n                    }\r\n                    offsetCalculator.style.overflow = 'auto';\r\n                    offsetCalculator.style.position = 'absolute';\r\n                    offsetCalculator.style.visibility = 'hidden';\r\n                    offsetCalculator.style.zIndex = '-10';\r\n                    offsetCalculator.style.left = \"-10000px\";\r\n                    offsetCalculator.style.top = \"-10000px\";\r\n                    offsetCalculator.style.backgroundColor = 'yellow';\r\n                }\r\n                \r\n                var range = doc.createRange()\r\n                    , val = el.value || \" \";\r\n\r\n                if ('input' == el.tagName.toLowerCase()) {\r\n                    offsetCalculator.style.width = 'auto'\r\n                    offsetCalculator.style.whiteSpace = 'nowrap';\r\n                } else {\r\n                    offsetCalculator.style.whiteSpace = 'off' == el.getAttribute('wrap') ? \"pre\" : \"\";\r\n                }\r\n\r\n                val = val.replace(/\\x20\\x20/g, \"\\x20\\xa0\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt\");\r\n                offsetCalculator.innerHTML = (val.substring(0, el.selectionStart - 1) + \"<span>\" + val.substring(el.selectionStart - 1, el.selectionStart) + \"</span>\"\r\n                    + val.substring(el.selectionStart)).replace(/\\n/g, \"<br />\")\r\n                    .replace(/\\t/g, \"<em style=\\\"white-space:pre\\\">\\t</em>\")\r\n                \r\n                var span = offsetCalculator.getElementsByTagName('span')[0];\r\n                span.style.border = '1px solid red';\r\n                range.offsetLeft = span.offsetLeft// - el.scrollLeft + span.clientWidth;\r\n                range.offsetTop = span.offsetTop// - el.scrollTop;\r\n                range.offsetHeight = span.offsetHeight;\r\n                if (\"\\n\" == val.charAt(el.selectionStart - 1)) range.offsetTop += range.offsetHeight * 2;\r\n                span = null;\r\n            } else if (doc.selection && doc.selection.createRange) {\r\n                \r\n                range = doc.selection.createRange();\r\n                \r\n                range.offsetHeight = Math.round(range.boundingHeight / (range.text.replace(/[^\\n]/g, \"\").length + 1));\r\n                if (el.tagName && 'textarea' == el.tagName.toLowerCase()) {\r\n                    var xy = DOM.getOffset(el)\r\n                    range = {\r\n                        'offsetTop': range.offsetTop - xy.y + DOM.getBodyScrollTop(el)\r\n                        , 'offsetLeft': range.offsetLeft - xy.x + DOM.getBodyScrollLeft(el)\r\n                        , 'offsetHeight': range.offsetHeight\r\n                    }\r\n                }\r\n            }\r\n            if (range) {\r\n                return { 'x': range.offsetLeft, 'y': range.offsetTop, 'h': range.offsetHeight };\r\n            }\r\n            return { 'x': 0, 'y': 0, 'h': 0 };\r\n        }\r\n    }\r\n    , 'frame': function () {\r\n        var self = this;\r\n        \r\n        self.getContext = function (el) {\r\n            if ('function' == typeof el.getSelection) {\r\n                var pos = self.getPos(el)\r\n                    , val = el.document.body.innerText || el.document.body.innerHTML.replace(/<\\/?[a-z:]+[^>]*>/ig, \"\").replace(\"&nbsp;\", \" \")\r\n                    , r1 = val.match(new RegExp(\"(?:.|[\\\\r\\\\n]){0,\" + (pos[0] - 1) + \"}(?:^|\\\\s)\", \"m\")) || \"\"\r\n                    , r2 = val.match(new RegExp(\"(?:.|[\\\\r\\\\n]){\" + pos[0] + \"}\", \"m\")) || \"\"\r\n                    , r3 = val.replace(r2, \"\")\r\n                    , r4 = r3.substring(0, pos[1] - pos[0])\r\n                    , r5 = (r3.replace(r4, \"\")).match(/(?:\\S|$)*/)\r\n                return [r2.toString().replace(r1, \"\"), r4, r5];\r\n            } else {\r\n                var s1 = el.document.selection.createRange()\r\n                    , s2 = el.document.selection.createRange()\r\n                    , s3 = el.document.selection.createRange()\r\n                s1.moveStart(\"word\", -1)\r\n                s3.moveEnd(\"word\", 1)\r\n\r\n                return [s1.text.replace(new RegExp(RegExp.escape(s2.text) + \"$\"), \"\")\r\n                    , s2.text\r\n                    , s3.text.replace(new RegExp(\"^\" + RegExp.escape(s2.text)), \"\")];\r\n            }\r\n        }\r\n        \r\n        self.getPos = function (el) {\r\n            var pos = [0, 0];\r\n            if ('function' == typeof el.getSelection) {\r\n                \r\n                var sel = el.getSelection()\r\n                    , sn = sel.anchorNode\r\n                    , so = sel.anchorOffset\r\n                    , en = sel.focusNode\r\n                    , eo = sel.focusOffset\r\n                    , ss = false\r\n                    , es = false\r\n                    , sc = 0\r\n                    , ec = 0\r\n                    , cn\r\n                    , tw = el.document.createTreeWalker(el.document.body, NodeFilter.SHOW_TEXT, null, false)\r\n                while (sn && sn.nodeType != 3) {\r\n                    sn = sn.childNodes[so]\r\n                    so = 0;\r\n                }\r\n                while (en && en.nodeType != 3) {\r\n                    en = en.childNodes[eo]\r\n                    eo = 0;\r\n                }\r\n                while (cn = tw.nextNode()) {\r\n                    if (cn == en) {\r\n                        ec += eo\r\n                        es = true\r\n                    }\r\n                    if (cn == sn) {\r\n                        sc += so\r\n                        ss = true\r\n                    }\r\n                    if (!es) ec += cn.nodeValue.length\r\n                    if (!ss) sc += cn.nodeValue.length\r\n                    if (es && ss) break;\r\n                }\r\n                pos = [Math.min(ec, sc), Math.max(ec, sc)]\r\n            } else {\r\n                el.document.body.setActive();\r\n                pos = [Math.abs(el.document.selection.createRange().moveStart(\"character\", -100000000))\r\n                    , Math.abs(el.document.selection.createRange().moveEnd(\"character\", -100000000))];\r\n            }\r\n            return pos;\r\n        }\r\n        \r\n        self.del = function (el) {\r\n            if ('function' == typeof el.getSelection) {\r\n                var s = el.getSelection()\r\n                    , i = s.rangeCount\r\n                while (--i > -1) s.getRangeAt(i).deleteContents();\r\n\r\n                \r\n                var r = s.getRangeAt(s.rangeCount - 1)\r\n                r.insertNode(el.document.createTextNode(\"\"))\r\n                s.addRange(r);\r\n            } else if (el.document && el.document.selection) {\r\n                el.document.selection.createRange().text = \"\";\r\n                el.document.selection.createRange().select();\r\n            }\r\n        }\r\n        \r\n        self.ins = function (el, val) {\r\n            if ('function' == typeof el.getSelection) {\r\n                val = val.replace(/&/, \"&amp;\").replace(/</, \"&lt;\").replace(/>/, \"&gt;\").replace(/\\x20/, \"&nbsp;\").replace(/[\\r\\n]/, \"<br />\");\r\n                var n = el.document.createElement('span')\r\n                    , s = el.getSelection()\r\n                    , r = s.getRangeAt(0)\r\n                    , ln;\r\n                n.innerHTML = val;\r\n                r.insertNode(n);\r\n                r.selectNodeContents(n);\r\n\r\n                var pn = n.parentNode\r\n                    , ln = n.nextSibling\r\n\r\n                \r\n                n.parentNode.replaceChild(r.extractContents(), n);\r\n\r\n                \r\n                if (!ln)\r\n                    ln = pn.lastChild;\r\n\r\n                var r1 = el.document.createRange();\r\n                \r\n                if (ln.nodeValue) {\r\n                    \r\n                    r1.setStart(ln, 0);\r\n                } else {\r\n                    \r\n                    r1.setStartAfter(ln);\r\n                }\r\n\r\n                \r\n                s.removeAllRanges();\r\n                s.addRange(r1);\r\n\r\n            } else if (el.document && el.document.selection) {\r\n                el.document.body.setActive();\r\n                var r = el.document.selection.createRange();\r\n                r.text = val;\r\n                \r\n                if (r.moveStart(\"character\", 1)) {\r\n                    r.moveStart(\"character\", -1);\r\n                    r.moveEnd(\"character\", -1);\r\n                    r.select();\r\n                }\r\n            }\r\n            return self.getPos(el)[0];\r\n        }\r\n        \r\n        self.getSelection = function (el, s, e) {\r\n            if ('function' == typeof el.getSelection) {\r\n                var s = el.getSelection();\r\n                return s ? s.toString() : \"\";\r\n            } else if (el.document && el.document.selection) {\r\n                return el.document.selection.createRange().text;\r\n            }\r\n        }\r\n        \r\n        self.setRange = function (el, start, end) {\r\n            if ('function' == typeof el.getSelection) {\r\n                var sel = el.getSelection();\r\n                sel.removeAllRanges();\r\n                var r = el.document.createRange()\r\n                    , cnt = 0\r\n                    , cl = 0\r\n                    , cn\r\n                    , pn\r\n                    , tw = el.document.createTreeWalker(el.document.body, NodeFilter.SHOW_TEXT, null, false);\r\n\r\n                \r\n                while ((cn = tw.nextNode()) && (!cn.nodeValue.length || (cnt + cn.nodeValue.length <= start))) {\r\n                    pn = cn;\r\n                    cnt += cn.nodeValue.length;\r\n                }\r\n                \r\n                if (cn || (cn = pn)) {\r\n                    r.setStart(cn, start - cnt);\r\n                    r.setEnd(cn, start - cnt);\r\n                }\r\n                if (cn) {\r\n                    do {\r\n                        if (cn.nodeType != 3) continue;\r\n                        if (cnt + cn.nodeValue.length < end) {\r\n                            cnt += cn.nodeValue.length;\r\n                        } else {\r\n                            r.setEnd(cn, end - cnt);\r\n                            break;\r\n                        }\r\n                    } while (cn = tw.nextNode())\r\n                }\r\n                sel.addRange(r);\r\n            } else if (el.document && el.document.selection) {\r\n                el.document.body.setActive();\r\n                var r = el.document.selection.createRange()\r\n                r.moveToElementText(el.document.body);\r\n                r.move(\"character\", start);\r\n                r.moveEnd(\"character\", end - start);\r\n                r.select();\r\n            }\r\n        }\r\n        \r\n        self.getSelectionOffset = function (el) {\r\n            var off = { 'x': 0, 'y': 0, 'h': 0 };\r\n            if ('function' == typeof el.getSelection) {\r\n                var r = el.getSelection().getRangeAt(0)\r\n                    , s = el.document.createElement('span')\r\n                    , contents = r.cloneContents()\r\n                    , e = r.endOffset\r\n                    , n = s;\r\n\r\n                s.style.borderLeft = '1px solid red';\r\n                r.surroundContents(s);\r\n                off.h = n.offsetHeight;\r\n                while (n.offsetParent) {\r\n                    off.x += n.offsetLeft;\r\n                    off.y += n.offsetTop;\r\n                    n = n.offsetParent\r\n                }\r\n                s.parentNode.removeChild(s);\r\n\r\n                var r1 = el.document.createRange()\r\n                if (contents.childNodes.length > 0) {\r\n                    for (var i = 0; i < contents.childNodes.length; i++) {\r\n                        var n = contents.childNodes[i];\r\n                        r.insertNode(n);\r\n                        r1.selectNode(n);\r\n                    }\r\n                    el.getSelection().addRange(r1);\r\n                }\r\n            } else if (el.document && el.document.selection) {\r\n                var r = el.document.selection.createRange()\r\n                off.h = r.boundingHeight\r\n                off.x = r.offsetLeft;\r\n                off.y = r.offsetTop;\r\n            }\r\n            return off;\r\n        }\r\n    }\r\n};\r\n\r\nexport { DocumentSelection };\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/documentselection.js","import { isUndefined, isFunction, isString, isNumber, isNumeric, isArray, isRegExp, isBoolean, isScalar, isEmpty,\r\n    getScriptQuery } from './helpers';\r\n\r\n\r\n\r\nconst DOM = {};\r\n\r\nDOM.getParent = function getParent(el , cp , vl )  {\r\n  if (el == null) return null;\r\n  else if (el.nodeType == 1 &&\r\n      ((!isUndefined(vl) && el[cp] == vl) ||\r\n       ('string' == typeof cp && DOM.hasTagName(el, cp)) ||\r\n       el == cp)) return el;\r\n  else return getParent(el.parentNode, cp, vl); \r\n};\r\n\r\nDOM.getOffset = function (el )  {\r\n    var fixBrowserQuirks = true\r\n       ,o = el\r\n       ,left = 0\r\n       ,top = 0\r\n       ,width = 0\r\n       ,height = 0\r\n       ,parentNode = null\r\n       ,offsetParent = null;\r\n\r\n    if (o==null) return null;\r\n    \r\n    offsetParent = o.offsetParent;\r\n    var originalObject = o\r\n       ,el = o;\r\n    while (el.parentNode!=null) {\r\n      el = el.parentNode;\r\n      if (el.offsetParent!==null) {\r\n        var considerScroll = true;\r\n        \r\n        if (fixBrowserQuirks && window.opera) {\r\n          if (el==originalObject.parentNode || el.nodeName==\"TR\") {\r\n            considerScroll = false;\r\n          }\r\n        }\r\n        if (considerScroll) {\r\n          if (el.scrollTop && el.scrollTop>0) {\r\n            top -= el.scrollTop;\r\n          }\r\n          if (el.scrollLeft && el.scrollLeft>0) {\r\n            left -= el.scrollLeft;\r\n          }\r\n        }\r\n      }\r\n     \r\n      if (el == offsetParent) {\r\n        left += o.offsetLeft;\r\n        if (el.clientLeft && el.nodeName!=\"TABLE\") { \r\n          left += el.clientLeft;\r\n        }\r\n        top += o.offsetTop;\r\n        if (el.clientTop && el.nodeName!=\"TABLE\") {\r\n          top += el.clientTop;\r\n        }\r\n        o = el;\r\n        if (o.offsetParent==null) {\r\n          if (o.offsetLeft) {\r\n            left += o.offsetLeft;\r\n          }\r\n          if (o.offsetTop) {\r\n            top += o.offsetTop;\r\n          }\r\n        }\r\n        offsetParent = o.offsetParent;\r\n      }\r\n    }\r\n    \r\n  \r\n    if (originalObject.offsetWidth) {\r\n      width = originalObject.offsetWidth;\r\n    }\r\n    if (originalObject.offsetHeight) {\r\n      height = originalObject.offsetHeight;\r\n    }\r\n    \r\n    return {'x':left, 'y':top, 'width':width, 'height':height};\r\n};\r\n  \r\n\r\n\r\n\r\nDOM.getClientWidth = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document\r\n       ,w=0;\r\n    if (win.innerWidth) w = win.innerWidth;\r\n    else if (doc.documentElement && doc.documentElement.clientWidth) w = doc.documentElement.clientWidth;\r\n    else if (doc.body) w = doc.body.clientWidth;\r\n    return w;\r\n};\r\n\r\nDOM.getOffsetWidth = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document\r\n       ,w=0;\r\n    if (win.outerWidth) w = win.outerWidth;\r\n    else if (doc.documentElement && doc.documentElement.clientWidth) w = doc.documentElement.clientWidth;\r\n    else if (doc.body) w = doc.body.clientWidth;\r\n    return w;\r\n};\r\n\r\nDOM.getClientHeight = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document\r\n       ,h=0;\r\n    if (win.innerHeight) h = win.innerHeight;\r\n    else if (doc.documentElement && doc.documentElement.clientHeight) h = doc.documentElement.clientHeight;\r\n    else if (doc.body) h = doc.body.clientHeight;\r\n    return h;\r\n};\r\n\r\nDOM.getOffsetHeight = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document\r\n       ,h=0;\r\n    if (win.outerHeight) h = win.outerHeight;\r\n    else if (doc.documentElement && doc.documentElement.clientHeight) h = doc.documentElement.clientHeight;\r\n    else if (doc.body) h = doc.body.clientHeight;\r\n    return h;\r\n};\r\n\r\nDOM.getBodyScrollTop = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document;\r\n    return win.pageYOffset || (doc.documentElement && doc.documentElement.scrollTop) || (doc.body && doc.body.scrollTop);\r\n};\r\n\r\nDOM.getBodyScrollLeft = function (el) {\r\n    var win = this.getWindow(el)\r\n       ,doc = win.document;\r\n    return win.pageXOffset || (doc.documentElement && doc.documentElement.scrollLeft) || (doc.body && doc.body.scrollLeft);\r\n};\r\n\r\nDOM.getWindow = function (el) {\r\n    var win = window;\r\n    if (el) {\r\n        var doc = el.ownerDocument;\r\n        win = doc.defaultView || doc.parentWindow || doc.window || window;\r\n    }\r\n    return win;\r\n}\r\n\r\n\r\nDOM.getCursorPosition = function (e) {\r\n    if (e.pageX || e.pageY) return {'x': e.pageX, 'y': e.pageY};\r\n    \r\n    var de = document.documentElement || document.body;\r\n    return {'x': e.clientX + de.scrollLeft - (de.clientLeft || 0)\r\n           ,'y': e.clientY + de.scrollTop - (de.clientTop || 0)};\r\n};\r\n\r\nDOM.hasTagName = function (prop , tags ) {\r\n    if (isString(tags)) tags = [tags];\r\n    if (!isArray(tags) || isEmpty(tags) || isUndefined(prop) || isEmpty(prop.tagName)) return false;\r\n    var t = prop.tagName.toLowerCase();\r\n    for (var i=0, tL=tags.length; i<tL; i++) {\r\n        if (tags[i].toLowerCase() == t) return true;\r\n    }\r\n    return false;\r\n};\r\n\r\nDOM.color2rgb = function (prop) {\r\n    var e;\r\n    \r\n    if (/^([a-z]+)($|\\s[a-z]+)/i.test(prop)) {\r\n        var d = document.body, ov = d.vLink;\r\n        d.vLink = prop.split(\" \")[0];\r\n        prop = d.vLink;\r\n        d.vLink = ov;\r\n    }\r\n    try {\r\n        if (e = prop.match(/^#([\\da-f]{6})$/i)) {\r\n            return e=parseInt(e[1],16),[(e&0xff0000)>>16,(e&0xff00)>>8,(e&0xff)]\r\n        } else if (e = prop.match(/^#([\\da-f]{3})$/i)) {\r\n            return e=parseInt(e[1],16),[((e&0xf00)>>8)*0x11,((e&0xf0)>>4)*0x11,(e&0xf)*0x11];\r\n        } else\r\n            return (prop.match(/([\\d%]+)/g).splice(0,3).map(function(a){ return /%/.test(a)?(parseInt(a)*2.55).toFixed(0):parseInt(a)}))\r\n    } catch(err){\r\n        return;\r\n    }\r\n}\r\nDOM.setOpacity = function (el, opacity) {\r\n    if (el.style.opacity != opacity) {\r\n        el.style.opacity = \r\n        el.style.KhtmOpacity =\r\n        el.style.MozOpacity = opacity;\r\n        el.style.filter = \"alpha(opacity=\"+(opacity*100)+\")\";\r\n    }\r\n}\r\n\r\nDOM.CSS = function (el) {\r\n    var self = this\r\n    \r\n    self.addClass = function() {\r\n        var arg = isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);\r\n        self.removeClass(arg);\r\n        el.className = el.className+\" \"+Array.prototype.join.call(arg,\" \");\r\n        return self;\r\n    };\r\n    \r\n    self.removeClass = function removeClass() {\r\n        var arg = isArray(arguments[0])?arguments[0]:arguments;\r\n        if (!removeClass.cache) removeClass.cache = {}\r\n        var c = removeClass.cache\r\n        for (var i=0, aL=arg.length; i<aL; i++) {\r\n            if (!c.hasOwnProperty(arg[i])) c[arg[i]] = new RegExp(\"(^|\\\\s+)\"+arg[i]+\"(\\\\s+|$)\");\r\n            el.className = el.className.replace(c[arg[i]],\" \");\r\n        }\r\n        el.className=el.className.replace(/\\s{2,}/,\" \")\r\n        return self;\r\n    };\r\n    \r\n    self.hasClass = function(c) {\r\n        let re = new RegExp(\"(^|\\\\s+)\"+c+\"(\\\\s+|$)\");\r\n        return el.className.match(re,\" \"+c+\" \");\r\n    };\r\n    \r\n    self.getClass = function() {\r\n        return el.className;\r\n    }\r\n    \r\n    self.getClassValue = function(c) {\r\n        var vals = el.className.match(new RegExp(\"(^|\\\\s)\"+c+\":([^\\\\s]+)\"));\r\n    \r\n        return vals?((vals[2].indexOf(\":\")+1)?vals[2].split(\":\")\r\n                                             :vals[2])\r\n                   :null;\r\n    };\r\n    \r\n    self.getComputedStyle = function(prop) {\r\n        var y;\r\n        if (el.currentStyle)\r\n            y = prop?el.currentStyle[prop]:el.currentStyle;\r\n        else if (window.getComputedStyle) {\r\n            y = document.defaultView.getComputedStyle(el,null);\r\n            if (prop) y=y[prop];\r\n        } else {\r\n            y = null;\r\n        }\r\n        return y;\r\n    }\r\n    return this;\r\n};\r\n\r\nexport { DOM };\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/dom.js","import { isUndefined, isFunction, isString, isNumber, isNumeric, isArray, isRegExp, isBoolean, isScalar, isEmpty,\r\n    getScriptQuery } from './helpers';\r\nimport { DOM } from './dom';\r\n\r\n\r\nvar EM = new function () {\r\n    var self = this;\r\n    \r\n    var pool = [];\r\n    \r\n    var UID = 0;\r\n    \r\n    var keys = {\r\n        'UEID': '__eventManagerUniqueElementId'\r\n       \r\n    };\r\n    \r\n    \r\n    var rootEventHandler = function (e) {\r\n        unifyEvent(e);\r\n        var id = null\r\n            , hid = null\r\n            , el = e.target\r\n            , fe = true\r\n            , res = true;\r\n\r\n        if (!e.currentTarget || !(id = e.currentTarget[keys.UEID]) || !(hid = pool[id].handler[e.type])) return;\r\n\r\n        try {\r\n            for (var i = 0, hL = hid.length; i < hL; i++) if (isFunction(hid[i])) res = res && !(false === hid[i].call(e.currentTarget, e));\r\n        } catch (err) { setTimeout(function () { throw new Error(\"Event handler for [\" + e.type + \"] has failed with exception: \\\"\" + err.message + \"\\\"\"); }, 10) }\r\n\r\n        return res;\r\n    };\r\n    \r\n    var unloadEventHandler = function unloadEventHandler (e) {\r\n        for (var i = pool.length - 1, pid = null, el = null; i >= 0; i--) {\r\n            if (pool[i] && (el = (pid = pool[i]).node)) {\r\n                for (var z in pid.handler) {\r\n                    if (!pid.handler.hasOwnProperty(z)) continue;\r\n                    try {\r\n                        if (el.removeEventListener) {\r\n                            el.removeEventListener(z, pid.rootEHCaller ? pid.rootEHCaller : rootEventHandler, false);\r\n                        } else if (el.detachEvent) {\r\n                            el.detachEvent('on' + z, pid.rootEHCaller ? pid.rootEHCaller : rootEventHandler);\r\n                        }\r\n                    } catch (e) { }\r\n                    pid.handler[z].length = 0;\r\n                }\r\n            }\r\n            el = pid.node = null;\r\n        }\r\n        if (window.removeEventListener) {\r\n            window.removeEventListener(z, unloadEventHandler, false);\r\n        } else {\r\n            window.detachEvent('on' + z, unloadEventHandler);\r\n        }\r\n    };\r\n    \r\n    \r\n    var unifyEvent = function (e) {\r\n        var i = self.EU.length\r\n            , cur, cur1, k, init\r\n        while (i--) {\r\n            cur = self.EU[i];\r\n            if (cur[0].test(e.type)) {\r\n                k = cur[1].length;\r\n                init = null;\r\n                while (k--) {\r\n                    cur1 = cur[1][k];\r\n                    if ('init' == cur1[0]) init = cur1[1]\r\n                    else if (!e[cur1[0]]) e[cur1[0]] = cur1[1];\r\n                }\r\n                if (init) init.call(e);\r\n            }\r\n        }\r\n        if (!e.target && e.type != 'unload') e.target = e.srcElement;\r\n        return e;\r\n    };\r\n    \r\n    var getUEID = function (el, f) {\r\n        return el[keys.UEID] || (f && (el[keys.UEID] = ++UID));\r\n    };\r\n    \r\n    \r\n    self.addEventListener = function (el, et, h) {\r\n        if (!el || !isFunction(h)) return false;\r\n       \r\n        \r\n        var id = getUEID(el, true)\r\n            , pid = null\r\n            , hid = null;\r\n\r\n        \r\n        if (!pool[id]) {\r\n            pool[id] = {\r\n                'node': el\r\n                , 'handler': {}\r\n            }\r\n        };\r\n        pid = pool[id];\r\n        \r\n        if (!pid.handler.hasOwnProperty(et)) {\r\n            pid.handler[et] = [];\r\n            \r\n            if (el.addEventListener) {\r\n                el.addEventListener(et, rootEventHandler, false);\r\n            } else if (el.attachEvent) {\r\n                \r\n                pid.rootEHCaller = function (e) {\r\n                    e.currentTarget = pid.node;//pool[id].node;\r\n                    var res = rootEventHandler(e);\r\n                    e.currentTarget = null;\r\n                    return res;\r\n                };\r\n                el.attachEvent('on' + et, pid.rootEHCaller);\r\n            }\r\n        };\r\n        hid = pid.handler[et];\r\n        \r\n        if (hid.indexOf(h) == -1) {\r\n            hid[hid.length] = h;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    \r\n    self.removeEventListener = function (el, et, h) {\r\n        if (!el || !isFunction(h)) return false;\r\n        var id = getUEID(el)\r\n            , pid = pool[id]\r\n            , eid = null;\r\n        if (pid && (eid = pid.handler[et])) {\r\n            \r\n            eid.splice(eid.indexOf(h), 1);\r\n            if (0 == eid.length) {\r\n                delete pid.handler[et];\r\n                \r\n                if (el.removeEventListener) {\r\n                    el.removeEventListener(et, pid.rootEHCaller ? pid.rootEHCaller : rootEventHandler, false);\r\n                } else if (el.detachEvent) {\r\n                    el.detachEvent('on' + et, pid.rootEHCaller ? pid.rootEHCaller : rootEventHandler);\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    \r\n    self.dispatchEvent = function (e) {\r\n        var res = rootEventHandler(e);\r\n        return res;\r\n    };\r\n    \r\n    self.registerEvent = function (o, n, b, d) {\r\n        var id = getUEID(o, true);\r\n        if (!pool[id]) {\r\n            pool[id] = {\r\n                'node': o,\r\n                'handler': []\r\n            };\r\n        } else {\r\n            pool[id].node = o;\r\n        }\r\n        return new EM.EventTarget(o, n, b, d);\r\n    };\r\n    \r\n    var __construct = function () {\r\n        \r\n        if (window.attachEvent && !window.addEventListener) {\r\n            window.attachEvent('onunload', unloadEventHandler);\r\n        }\r\n    };\r\n    __construct();\r\n};\r\n\r\nEM.preventDefaultAction = function (e) {\r\n    e.preventDefault();\r\n}\r\nEM.stopPropagationAction = function (e) {\r\n    e.stopPropagation();\r\n}\r\n\r\n\r\n\r\nEM.EventTarget = function (obj, name, bubble, def) {\r\n    var self = this;\r\n\r\n    \r\n    var canBubble = !!bubble;\r\n    \r\n    var defaultAction = isFunction(def) ? def : null;\r\n    \r\n    \r\n    \r\n    self.trigger = function (el, data) {\r\n        if (!(arguments.length - 1) && el != obj) {\r\n            data = el;\r\n            el = null;\r\n        }\r\n        if (!el) el = obj;\r\n        var e = {}\r\n            , res = true\r\n            , undef = true\r\n            , tmp = null\r\n        for (var i in data) {\r\n            if (data.hasOwnProperty(i)) e[i] = data[i];\r\n        }\r\n\r\n        \r\n        canBubble = !!bubble;\r\n        defaultAction = def;\r\n\r\n        \r\n        do {\r\n            e.preventDefault = preventDefault;\r\n            e.stopPropagation = stopPropagation;\r\n            e.target = el;\r\n            e.currentTarget = el;\r\n            e.type = name;\r\n            tmp = EM.dispatchEvent(e);\r\n            undef &= (isUndefined(tmp))\r\n            res &= !(false === tmp);\r\n        } while ((el = el.parentNode) && canBubble);\r\n        \r\n        if (isFunction(defaultAction) && res && !undef) {\r\n            defaultAction(e);\r\n        }\r\n        return (defaultAction && res && !undef);\r\n    };\r\n    \r\n    var preventDefault = function () {\r\n        defaultAction = null;\r\n    };\r\n    \r\n    var stopPropagation = function () {\r\n        canBubble = false;\r\n    };\r\n};\r\n\r\nEM.EU = [\r\n    [/./, [\r\n        \r\n        ['preventDefault', function () {\r\n            this.returnValue = false;\r\n        }\r\n        ]\r\n        \r\n        , ['stopPropagation', function () {\r\n            this.cancelBubble = true;\r\n        }\r\n        ]\r\n    ]]\r\n    , [/^mouse(over|out|down|up)/, [\r\n        \r\n        ['getButton', function () {\r\n            return this.button == 2 ? 2 : 1\r\n        }\r\n        ]\r\n        , ['EM_MB_LEFT', '1']\r\n        , ['EM_MB_RIGHT', '2']\r\n    ]]\r\n    , [/^key(down|up|press)/, [\r\n        \r\n        ['getKeyCode', function () {\r\n            switch (this.keyCode) {\r\n                case 189: return 109;\r\n                case 187: return 61; \r\n                case 107: return 61; \r\n                case 186: return 59;\r\n                default: return this.keyCode;\r\n            }\r\n        }\r\n        ]\r\n        \r\n        , ['getRepeat', function getRepeat() {\r\n            return getRepeat.repeat\r\n        }\r\n        ]\r\n        , ['init', function () {\r\n            var ac = this.getRepeat\r\n            if ('keyup' == this.type) {\r\n                ac.repeat = 0;\r\n                ac.keyCode = 0;\r\n            } else if ('keydown' == this.type) {\r\n                ac.repeat = ac.keyCode == this.keyCode;\r\n                ac.keyCode = this.keyCode;\r\n            }\r\n        }\r\n        ]\r\n    ]]\r\n\r\n];\r\n\r\n\r\n(function () {\r\n\r\n    var evt = EM.registerEvent(window, 'domload')\r\n        , executed = false\r\n        , clearEvents = function () {\r\n           \r\n            EM.removeEventListener(document, 'propertychange', handlers.ie);\r\n           \r\n            EM.removeEventListener(document, 'DOMContentLoaded', handlers.mz);\r\n           \r\n            EM.removeEventListener(window, 'load', handlers.mz);\r\n        }\r\n        , handlers = {\r\n            'ie': function (e) {\r\n                if (window.event.propertyName == 'activeElement' && !executed) {\r\n                    evt.trigger(window);\r\n                    clearEvents();\r\n                    executed = true;\r\n                }\r\n            }\r\n            , 'mz': function (e) { if (!executed) evt.trigger(window); executed = true; }\r\n        };\r\n\r\n   \r\n    EM.addEventListener(document, 'propertychange', handlers.ie);\r\n   \r\n    EM.addEventListener(document, 'DOMContentLoaded', handlers.mz);\r\n   \r\n    if (/WebKit|Khtml/i.test(navigator.userAgent) || (window.opera && parseInt(window.opera.version()) < 9))\r\n        (function argumentsCalleeFixFn() { if (!executed) /loaded|complete/.test(document.readyState) ? (evt.trigger(window), executed = true) : setTimeout(argumentsCalleeFixFn, 100) })();\r\n   \r\n    EM.addEventListener(window, 'load', handlers.mz);\r\n})();\r\n\r\nexport { EM };\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/eventmanager.js","\r\nvar ScriptQueue = function (cbk) {\r\n    var self = this\r\n        , staticFn = arguments.callee;\r\n    \r\n    if ('function' != typeof cbk) cbk = function () { }\r\n    \r\n    var queue = [];\r\n   \r\n   \r\n   \r\n    \r\n    self.load = function (path) {\r\n        load(path, cbk);\r\n    }\r\n    \r\n    self.queue = function (path) {\r\n        var f = queue.length;\r\n        queue[f] = path;\r\n        if (!f) load(path, queuemonitor);\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    var load = function (path, cbk) {\r\n        var sid\r\n            , scr = staticFn.scripts;\r\n        if (sid = scr.hash[path]) {\r\n            scr = staticFn.scripts[sid]\r\n            if (scr[2]) {\r\n                cbk(path, scr[2]);\r\n            } else {\r\n                scr[1].push(cbk);\r\n            }\r\n        } else {\r\n            sid = scr.length;\r\n            scr[sid] = [path, [cbk], false];\r\n            scr.hash[path] = sid;\r\n            ls(path);\r\n        }\r\n    }\r\n    \r\n    var ls = function (src) {\r\n        if (document.body) {\r\n            var s = document.createElement('script')\r\n                , h = document.getElementsByTagName(\"head\")[0];\r\n            s.type = \"text/javascript\";\r\n            s.charset = \"UTF-8\";\r\n            s.src = src;\r\n            \r\n            s.rSrc = src;\r\n            s.onerror = s.onload = s.onreadystatechange = loadmonitor;\r\n            h.appendChild(s);\r\n        } else {\r\n            document.write(\"<scr\" + \"ipt onload=\\\"\\\" src=\\\"\" + src + \"\\\" charset=\\\"UTF-8\\\"></scr\" + \"ipt>\");\r\n            \r\n           \r\n            loadmonitor.call({ 'rSrc': src }, { 'type': 'load' });\r\n        }\r\n    }\r\n   \r\n   \r\n   \r\n    \r\n    var queuemonitor = function queuemonitor (path, s) {\r\n        \r\n        cbk(path, s);\r\n        queue.splice(0, 1);\r\n        \r\n        if (queue.length && s)\r\n            load(queue[0], queuemonitor);\r\n        else\r\n            cbk(null, s)\r\n    }\r\n    \r\n    var loadmonitor = function (e) {\r\n        var scr = staticFn.scripts\r\n            , sid = scr.hash[this.rSrc]\r\n            , e = e || window.event\r\n            , res;\r\n\r\n        scr = scr[sid];\r\n        if (scr && !scr[2]) {\r\n            if ('load' == e.type || 'complete' == this.readyState || 'loaded' == this.readyState) {\r\n                scr[2] = res = true;\r\n            } else if ('error' == e.type) {\r\n                res = false;\r\n            }\r\n            if (null != res) {\r\n                for (var i = 0, cbk = scr[1], cL = cbk.length; i < cL; i++) {\r\n                    cbk[i](scr[0], scr[2]);\r\n                }\r\n                if (!res) {\r\n                    delete staticFn.scripts.hash[this.rSrc];\r\n                    delete staticFn.scripts[sid];\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nScriptQueue.scripts = [false];\r\nScriptQueue.scripts.hash = {};\r\n\r\nScriptQueue.queue = function (arr, cbk) {\r\n    if (!arr.length) return;\r\n    var q = new ScriptQueue(cbk);\r\n    for (var i = 0, aL = arr.length; i < aL; i++) {\r\n        q.queue(arr[i]);\r\n    }\r\n}\r\n\r\nScriptQueue.load = function (src, cbk) {\r\n    if (src) {\r\n        (new ScriptQueue(cbk)).load(src);\r\n    }\r\n}\r\n\r\nif (window.ScriptQueueIncludes instanceof Array) {\r\n    ScriptQueue.queue(window.ScriptQueueIncludes);\r\n}\r\n\r\nexport { ScriptQueue };\n\n\n// WEBPACK FOOTER //\n// ./src/extensions/scriptqueue.js","var IME = new function () {\n    var self = this;\n    var html = \"<div id=\\\"VirtualKeyboardIME\\\"><table><tr><td class=\\\"IMEControl\\\"><div class=\\\"left\\\"><!-- --></div></td>\"\n        + \"<td class=\\\"IMEControl IMEContent\\\"></td>\"\n        + \"<td class=\\\"IMEControl\\\"><div class=\\\"right\\\"><!-- --></div></td></tr>\"\n        + \"<tr><td class=\\\"IMEControl IMEInfo\\\" colspan=\\\"3\\\"><div class=\\\"showAll\\\"><div class=\\\"IMEPageCounter\\\"></div><div class=\\\"arrow\\\"></div></div></td></tr></div>\";\n    var ime = null;\n    var chars = \"\";\n    var page = 0;\n    var showAll = false;\n    var sg = [];\n    var target = null;\n    var targetWindow = null;\n\n        self.show = function (s) {\n        target = VirtualKeyboard.getAttachedInput();\n        var win = DOM.getWindow(target);\n                if (targetWindow != win) {\n            if (ime && ime.parentNode) {\n                ime.parentNode.removeChild(ime);\n            }\n            targetWindow = win;\n            __createImeToolbar();\n            targetWindow.document.body.appendChild(ime);\n        }\n                ime.className = self.css\n\n        if (s) self.setSuggestions(s);\n        if (target && ime && sg.length > 0) {\n            EM.addEventListener(target, 'blur', self.blurHandler);\n            ime.style.display = \"block\";\n            self.updatePosition(target);\n        } else if ('none' != ime.style.display) {\n            self.hide();\n        }\n    }\n\n        self.hide = function (keep) {\n        if (ime && 'none' != ime.style.display) {\n            ime.style.display = \"none\";\n            EM.removeEventListener(target, 'blur', self.blurHandler);\n            if (target && DocumentSelection.getSelection(target) && !keep)\n                DocumentSelection.deleteSelection(target);\n            target = null;\n            sg = [];\n        }\n    }\n        self.updatePosition = function () {\n        var xy = DOM.getOffset(target);\n        ime.style.left = xy.x + 'px';\n        var co = DocumentSelection.getSelectionOffset(target);\n        ime.style.top = xy.y + co.y + co.h + 'px';\n    }\n        self.setSuggestions = function (arr) {\n        if (!isArray(arr)) return false;\n        sg = arr;\n        page = 0;\n        showPage();\n        self.updatePosition(target);\n    }\n        self.getSuggestions = function (idx) {\n        return isNumber(idx) ? sg[idx] : sg;\n    }\n        self.nextPage = function (e) {\n        page = Math.max(Math.min(page + 1, (Math.ceil(sg.length / 10)) - 1), 0);\n        showPage();\n    }\n        self.prevPage = function (e) {\n        page = Math.max(page - 1, 0);\n        showPage();\n    }\n        self.getPage = function () {\n        return page;\n    }\n        self.getChar = function (n) {\n        n = --n < 0 ? 9 : n;\n        return sg[self.getPage() * 10 + n]\n    }\n    self.isOpen = function () {\n        return ime && 'block' == ime.style.display;\n    }\n        self.blurHandler = function (e) {\n        self.hide();\n    }\n        self.toggleShowAll = function (e) {\n        var sa = ime.firstChild.rows[1].cells[0].lastChild;\n        if (showAll = !showAll) {\n            page = 0;\n            sa.className = 'showPage';\n        } else {\n            sa.className = 'showAll';\n        }\n        showPage();\n    }\n        var showPage = function () {\n        var s = ['<table>'];\n        for (var z = 0, pL = Math.ceil(sg.length / 10); z < pL; z++) {\n            if (showAll || z == page) {\n                s.push('<tr>');\n                for (var i = 0, p = z * 10; i < 10 && !isUndefined(sg[p + i]); i++) {\n                    s.push(\"<td><a href=''>\")\n                    if (z == page) {\n                        s.push(\"<b>&nbsp;\" + ((i + 1) % 10) + \": </b>\");\n                    } else {\n                        s.push(\"<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>\");\n                    }\n                    s.push(sg[p + i] + \"</a></td>\");\n                }\n                s.push('</tr>');\n            }\n        }\n        s.push('</table>');\n        ime.firstChild.rows[0].cells[1].innerHTML = s.join(\"\");\n       \n        ime.firstChild.rows[1].cells[0].firstChild.firstChild.innerHTML = (page + 1) + \"/\" + (0 + showAll || Math.ceil(sg.length / 10));\n       \n        var els = ime.getElementsByTagName(\"*\");\n        for (var i = 0, eL = els.length; i < eL; i++) {\n            els[i].unselectable = \"on\";\n        }\n    }\n        var pasteSuggestion = function (e) {\n        var el = DOM.getParent(e.target, 'a');\n        if (el) {\n            DocumentSelection.insertAtCursor(target, el.lastChild.nodeValue);\n            self.hide();\n        }\n        e.preventDefault();\n    }\n\n        var __createImeToolbar = function () {\n        var el = targetWindow.document.createElement('div');\n        el.innerHTML = html;\n        ime = el.firstChild;\n        ime.style.display = 'none';\n        var arrl = ime.firstChild.rows[0].cells[0]\n            , arrr = ime.firstChild.rows[0].cells[2]\n            , arrd = ime.firstChild.rows[1].cells[0].lastChild\n        EM.addEventListener(arrl, 'mousedown', self.prevPage);\n        EM.addEventListener(arrl, 'mousedown', EM.preventDefaultAction);\n        EM.addEventListener(arrl, 'mousedown', EM.stopPropagationAction);\n        EM.addEventListener(arrr, 'mousedown', self.nextPage);\n        EM.addEventListener(arrr, 'mousedown', EM.preventDefaultAction);\n        EM.addEventListener(arrr, 'mousedown', EM.stopPropagationAction);\n        EM.addEventListener(arrd, 'mousedown', self.toggleShowAll);\n        EM.addEventListener(arrd, 'mousedown', EM.preventDefaultAction);\n        EM.addEventListener(arrd, 'mousedown', EM.stopPropagationAction);\n                ime.unselectable = \"on\";\n        var els = ime.getElementsByTagName(\"*\");\n        for (var i = 0, eL = els.length; i < eL; i++) {\n            els[i].unselectable = \"on\";\n        }\n\n        EM.addEventListener(ime, 'mousedown', pasteSuggestion);\n    }\n};\n\nexport { IME };\n\n\n// WEBPACK FOOTER //\n// ./src/ime.js"],"sourceRoot":""}